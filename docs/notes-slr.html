<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.517">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Regression - 1&nbsp; Simple linear regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./notes-inference.html" rel="next">
<link href="./part1-slr.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part1-slr.html">Simple linear regression</a></li><li class="breadcrumb-item"><a href="./notes-slr.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Simple linear regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part1-slr.html">Simple linear regression</a></li><li class="breadcrumb-item"><a href="./notes-slr.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Simple linear regression</span></a></li></ol></nav><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title"><span id="sec-slr" class="quarto-section-identifier"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Regression</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part1-slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notes-slr.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notes-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inference</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part2-mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./placeholder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Placeholder</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#regression-overview" id="toc-regression-overview" class="nav-link active" data-scroll-target="#regression-overview"><span class="header-section-number">1.1</span> Regression overview</a>
  <ul class="collapse">
<li><a href="#simple-linear-regression-model-slr" id="toc-simple-linear-regression-model-slr" class="nav-link" data-scroll-target="#simple-linear-regression-model-slr"><span class="header-section-number">1.1.1</span> Simple linear regression model (SLR)</a></li>
  <li><a href="#estimation-of-the-regression-function" id="toc-estimation-of-the-regression-function" class="nav-link" data-scroll-target="#estimation-of-the-regression-function"><span class="header-section-number">1.1.2</span> Estimation of the regression function</a></li>
  <li><a href="#method-of-least-squares" id="toc-method-of-least-squares" class="nav-link" data-scroll-target="#method-of-least-squares"><span class="header-section-number">1.1.3</span> Method of least squares</a></li>
  <li><a href="#point-estimation-of-the-mean-response" id="toc-point-estimation-of-the-mean-response" class="nav-link" data-scroll-target="#point-estimation-of-the-mean-response"><span class="header-section-number">1.1.4</span> Point estimation of the mean response</a></li>
  <li><a href="#residuals-and-model-errors" id="toc-residuals-and-model-errors" class="nav-link" data-scroll-target="#residuals-and-model-errors"><span class="header-section-number">1.1.5</span> Residuals and model errors</a></li>
  </ul>
</li>
  <li><a href="#estimation-of-error-terms-variance" id="toc-estimation-of-error-terms-variance" class="nav-link" data-scroll-target="#estimation-of-error-terms-variance"><span class="header-section-number">1.2</span> Estimation of error terms variance</a></li>
  <li>
<a href="#normal-error-regression-model" id="toc-normal-error-regression-model" class="nav-link" data-scroll-target="#normal-error-regression-model"><span class="header-section-number">1.3</span> Normal error regression model</a>
  <ul class="collapse">
<li><a href="#estimation-of-paramters-by-method-of-maximum-likelihood" id="toc-estimation-of-paramters-by-method-of-maximum-likelihood" class="nav-link" data-scroll-target="#estimation-of-paramters-by-method-of-maximum-likelihood"><span class="header-section-number">1.3.1</span> Estimation of paramters by method of maximum likelihood</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><!-- % define LaTeX macros (/shortcuts) --><!-- % define vector (without parentheses, so when writing out in like a definition) of the form X_1, ..., X_n, where X and n are variable. NOTE: to call use $\vecn{X}{n}$ --><!-- % shortcut for ~ 'Named dist ' in normal font with space before parameters would go --><!-- % (followsp is short for 'follow special') shortcut that can be used for iid or ind ~ 'Named dist ' in normal font with space before parameters would go --><!-- % define independence symbol (it basically makes two orthogonal symbols very close to each other. The number of \! controls the space between each of the orthogonal symbols) --><!-- % shortcut for Cov(X,Y) with formatting for Cov --><!-- % shortcut for Corr(X,Y) with formatting for Corr --><!-- % shortcut for non-italic e in math mode --><section id="regression-overview" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="regression-overview">
<span class="header-section-number">1.1</span> Regression overview</h2>
<p>Regression overview</p>
<ul>
<li><p>Goal is to determine <strong>if</strong> and <strong>how</strong> one variable is related to a set of other variables.</p></li>
<li>
<p>Variables</p>
<ul>
<li><p>Response variable, denoted <span class="math inline">\(Y\)</span>, represents an outcome whose variation is being studied.</p></li>
<li><p>Explanatory variable, denoted <span class="math inline">\(X\)</span>, represents the causes (i.e.&nbsp;potential reasons for variation).</p></li>
</ul>
</li>
<li>
<p>Two types of relationships</p>
<ul>
<li><p>Functional (deterministic) → There is an exact relation between two variables (have the form <span class="math inline">\(y = ax+ b\)</span>).</p></li>
<li><p>Statistical (probabilistic) → There is not an exact relation because there are other variables that affect the relationship (have the form <span class="math inline">\(y = ax + b + \epsilon\)</span>).</p></li>
</ul>
</li>
</ul>
<p>Regression models and their uses</p>
<ul>
<li><p>Statistical models quantify the relationship between a response variable (i.e.&nbsp;a random variable) and explanatory variables, which are usually assumed to be deterministic (i.e.&nbsp;known exactly).</p></li>
<li>
<p>Elements of a statistical regression model</p>
<ul>
<li>
<p>In general, observations do not fall directly on the curve of a relationship.</p>
<ul>
<li><p><span class="math inline">\(Y \mid X\)</span> has a probability distribution.</p></li>
<li><p><span class="math inline">\(E(Y \mid X)\)</span> varies deterministically with <span class="math inline">\(X\)</span>.</p></li>
</ul>
<p><img src="files/images/regression-curve.png" class="img-fluid" style="width:50.0%"></p>
</li>
<li>
<p>So the statistical model is:</p>
<p><span class="math display">\[
\begin{align*}
  Y &amp;= E(Y \mid X) + \epsilon \\
    &amp;= f(X) + \epsilon, \hspace{20pt} \text{where $\epsilon$ has some distribution}
\end{align*}
\]</span></p>
</li>
</ul>
</li>
<li>
<p>Two components of a statistical model:</p>
<ol type="1">
<li><p><span class="math inline">\(f(X) = E(Y \mid X)\)</span> → Defines relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>; explains the average behavior of the response.</p></li>
<li><p><span class="math inline">\(\epsilon\)</span> → An element of randomness (i.e.&nbsp;error). This contains the variation that <span class="math inline">\(f(X)\)</span> cannot explain and/or that is of no interest.</p></li>
</ol>
</li>
<li><p>This means <span class="math inline">\(f(X) = E(Y \mid X)\)</span> will be the same for all samples with the same <span class="math inline">\(X\)</span> values. The only thing that changes is the random error <span class="math inline">\(\epsilon\)</span> and as a result <span class="math inline">\(Y\)</span>. Example <span class="math inline">\(Y = 3 + 1X + \epsilon\)</span>:</p></li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create regression data frame to show different the deterministic and statistical relationships (assuming SLR normal error model for demonstration so can visualize)</span></span>
<span><span class="co"># generate</span></span>
<span><span class="co"># -&gt; X values (not from a random dist)</span></span>
<span><span class="co"># -&gt; f(X) = E(Y | X) = beta_0 + beta_1 X demonstration</span></span>
<span><span class="co"># -&gt; random error = epsilon ~ N(0,1)</span></span>
<span><span class="co"># -&gt; Y = f(X) + epsilon</span></span>
<span><span class="va">beta_0</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">beta_1</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">data_ships</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">10</span>, to <span class="op">=</span> <span class="fl">19</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>f_X <span class="op">=</span> <span class="va">beta_0</span> <span class="op">+</span> <span class="va">beta_1</span> <span class="op">*</span> <span class="va">X</span>,</span>
<span>         epsilon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>         Y <span class="op">=</span> <span class="va">f_X</span> <span class="op">+</span> <span class="va">epsilon</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># display data</span></span>
<span><span class="va">data_ships</span> <span class="op">%&gt;%</span> <span class="fu">display_nice</span><span class="op">(</span>col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"f(X) = E(Y | X)"</span>, <span class="st">"$epsilon ~ N(0,1)"</span>, <span class="st">"Y = f(X) + epsilon"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" class="table table-striped" style="width: auto !important; ">
<thead><tr>
<th style="text-align:right;"> X </th>
   <th style="text-align:right;"> f(X) = E(Y | X) </th>
   <th style="text-align:right;"> $epsilon ~ N(0,1) </th>
   <th style="text-align:right;"> Y = f(X) + epsilon </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> -1.050 </td>
   <td style="text-align:right;"> 11.950 </td>
  </tr>
<tr>
<td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 1.318 </td>
   <td style="text-align:right;"> 15.318 </td>
  </tr>
<tr>
<td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> -1.008 </td>
   <td style="text-align:right;"> 13.992 </td>
  </tr>
<tr>
<td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 16 </td>
   <td style="text-align:right;"> 0.034 </td>
   <td style="text-align:right;"> 16.034 </td>
  </tr>
<tr>
<td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 17 </td>
   <td style="text-align:right;"> 0.375 </td>
   <td style="text-align:right;"> 17.375 </td>
  </tr>
<tr>
<td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> -1.184 </td>
   <td style="text-align:right;"> 16.816 </td>
  </tr>
<tr>
<td style="text-align:right;"> 16 </td>
   <td style="text-align:right;"> 19 </td>
   <td style="text-align:right;"> -0.898 </td>
   <td style="text-align:right;"> 18.102 </td>
  </tr>
<tr>
<td style="text-align:right;"> 17 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 1.079 </td>
   <td style="text-align:right;"> 21.079 </td>
  </tr>
<tr>
<td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 21 </td>
   <td style="text-align:right;"> 1.000 </td>
   <td style="text-align:right;"> 22.000 </td>
  </tr>
<tr>
<td style="text-align:right;"> 19 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:right;"> -0.068 </td>
   <td style="text-align:right;"> 21.932 </td>
  </tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot (X, Y)</span></span>
<span><span class="co"># -&gt; and add points and line for E(Y | X)</span></span>
<span><span class="co"># --&gt; population E(Y | X)) because using known betas (not estimating from sample data)</span></span>
<span><span class="va">data_ships</span> <span class="op">%$%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span>, type <span class="op">=</span> <span class="st">"p"</span>, main <span class="op">=</span> <span class="st">"Deterministic vs statistical relationship"</span><span class="op">)</span></span>
<span><span class="va">data_ships</span> <span class="op">%$%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">f_X</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">data_ships</span> <span class="op">%$%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">f_X</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">18.5</span>, y <span class="op">=</span> <span class="fl">20</span>, labels <span class="op">=</span> <span class="st">"f(X) = E(Y|X)"</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-slr_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Construction of statistical regression models</p>
<ol type="1">
<li>
<p>Selection of predictor variables (how to decide which ones?).</p>
<ul>
<li><p>Use of outside information, historical knowledge, and/or experience.</p></li>
<li><p>Exploratory data analysis.</p></li>
<li><p>Variable selection techniques → Find a subset of important variables (i.e.&nbsp;practical and easy to find).</p></li>
</ul>
</li>
<li>
<p>Functional form of the regression relation (what is form of <span class="math inline">\(f(X)\)</span>?).</p>
<ul>
<li><p>&lt; based on same info as (1) &gt;</p></li>
<li><p>If there is an abundance of data, maybe start with more complex models and then simplify.</p></li>
</ul>
</li>
<li>
<p>Scope of model (when is the model useful?).</p>
<ul>
<li>When the model best predicts or describes the relationship between response and predictor variables.</li>
</ul>
</li>
</ol>
<p>Uses of statistical regression models</p>
<ol type="1">
<li><p>Determining whether an <span class="math inline">\(X\)</span> “affects” <span class="math inline">\(Y\)</span> or not.</p></li>
<li><p>Estimation of impact of a given <span class="math inline">\(X\)</span> on the <span class="math inline">\(Y\)</span>.</p></li>
<li><p>Estimation of the mean of <span class="math inline">\(Y\)</span> for a given <span class="math inline">\(X\)</span> value.</p></li>
<li><p>Prediction of a single value of <span class="math inline">\(Y\)</span> for a given <span class="math inline">\(X\)</span> value.</p></li>
</ol>
<p>Typical strategy for regression analysis</p>
<p><img src="files/images/regression-flow-chart.png" class="img-fluid" style="width:25.0%"></p>
<section id="simple-linear-regression-model-slr" class="level3" data-number="1.1.1"><h3 data-number="1.1.1" class="anchored" data-anchor-id="simple-linear-regression-model-slr">
<span class="header-section-number">1.1.1</span> Simple linear regression model (SLR)</h3>
<p>Goal of SLR</p>
<ul>
<li><p>Investigate the relationship between <span class="math inline">\(Y\)</span> and a single numeric independent variable <span class="math inline">\(X\)</span>, assuming that, in the population, the mean of <span class="math inline">\(Y\)</span> is linearly related to the value of <span class="math inline">\(X\)</span>.</p></li>
<li><p>Population relationship → <span class="math inline">\(Y = \beta_0 + \beta_1 X + \epsilon\)</span>.</p></li>
<li><p>Sample relationship → <span class="math inline">\(\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1 X\)</span>.</p></li>
</ul>
<p>Data structure</p>
<ul>
<li><p>Both <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> on a random sample of <span class="math inline">\(n\)</span> individuals are collected from the population of interest.</p></li>
<li><p>The resulting data has the form <span class="math inline">\((X_1, Y_1), \ldots, (X_n, Y_n)\)</span>.</p></li>
</ul>
<p>Model statement → <span class="math inline">\(Y_i = \beta_0 + \beta_1 X_i + \epsilon_i\)</span></p>
<ul>
<li><p>Holds for all <span class="math inline">\(n\)</span> values in the random sample of <span class="math inline">\(n\)</span> pairs of values, <span class="math inline">\((X_i, Y_i), \, i = 1, \ldots, n\)</span>.</p></li>
<li><p><span class="math inline">\(Y_i\)</span> → Dependent (or response) variable value. These are independent, but not identically distributed.</p></li>
<li><p><span class="math inline">\(X_i\)</span> → Independent (or predictor) variable value. These are <strong>not random variables</strong>, rather <strong>known constants</strong>.</p></li>
<li><p><span class="math inline">\(\epsilon_i\)</span> → Random error term, <strong>assumed</strong> to have mean zero and variance <span class="math inline">\(\sigma^2\)</span>. <span class="math inline">\(\mathrm{Cov}(\epsilon_i, \epsilon_j) = \mathrm{Corr}(\epsilon_i, \epsilon_j) = 0\)</span> for all <span class="math inline">\(i,j : i \ne j\)</span>. Often, the <span class="math inline">\(\epsilon_i\)</span> are assumed to be independent and identically distributed <span class="math inline">\((iid)\)</span>, i.e.&nbsp;all have the same distribution with the same mean and variance.</p></li>
<li><p><span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> → <strong>Fixed</strong> but <strong>unknown</strong> regression parameters that need to be estimated.</p></li>
<li><p><span class="math inline">\(\sigma^2\)</span> → Another parameter that needs estimated, but it is technically <strong>not</strong> a “regression” parameter since it does not determine the relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> (i.e.&nbsp;it only deals with randomness).</p></li>
<li><p>Note that <span class="math inline">\(Y_i\)</span> and <span class="math inline">\(\epsilon_i\)</span> are random variables and therefore have distributions. Thus, discussing their mean and variances are appropriate.</p></li>
<li><p>Alternate (equivalent) version of regression model</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Results</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Derivation</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Model statement</p>
<ul>
<li>Can use the deviation <span class="math inline">\(X_i - \bar{X}\)</span> as the predictor instead of <span class="math inline">\(X_i\)</span>. This leads to:</li>
</ul>
<p><span class="math display">\[
Y_i = \beta_0^* + \beta_1 (X_i - \bar{X}) + \epsilon_i, \hspace{20pt} \text{where} \hspace{10pt} \beta_0^* = \beta_0 + \beta_1 \bar{X}
\]</span></p>
<ul>
<li>This model can be useful in some derivations.</li>
</ul>
<p>Later results (jumping ahead)</p>
<ul>
<li>
<p>Estimated coefficients</p>
<ul>
<li><p>LSE for <span class="math inline">\(\beta_1\)</span> is the same as before.</p></li>
<li><p>Now the LSE for <span class="math inline">\(\beta_0^*\)</span> can be found using <span class="math inline">\(\hat{\beta}_0\)</span> :</p></li>
</ul>
</li>
</ul>
<p><span class="math display">\[
\hat{\beta}_0^* = \hat{\beta}_0 + \hat{\beta}_1 \bar{X} = (\bar{Y} - \hat{\beta}_1 \bar{X}) + \hat{\beta}_1 \bar{X} = \bar{Y}
\]</span></p>
<ul>
<li>Estimated regression function</li>
</ul>
<p><span class="math display">\[
\hat{Y} = \bar{Y} - \hat{\beta}_1 (X - \bar{X})
\]</span></p>
<ul>
<li>
<p>Property of all regression functions</p>
<ul>
<li>Using this alternative model, it is easy to see that all regression functions pass through the point <span class="math inline">\((\bar{X}, \bar{Y})\)</span>.</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><img src="files/images/alternate-regression-model.png" class="img-fluid" style="width:50.0%"></p>
</div>
</div>
</div>
<p>Some implications of above</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Results</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Derivation</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<ul>
<li><p>Mean of <span class="math inline">\(Y_i\)</span> for given <span class="math inline">\(X_i\)</span> → <span class="math inline">\(E(Y_i) = \beta_0 + \beta_1 X_i\)</span></p></li>
<li><p>Variance of <span class="math inline">\(Y_i\)</span> for given <span class="math inline">\(X_i\)</span> → <span class="math inline">\(V(Y_i) = \sigma^2\)</span></p></li>
</ul>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p><img src="files/images/mean-var-y.png" class="img-fluid" style="width:50.0%"></p>
</div>
</div>
</div>
<p>Interpretation of regression parameters <span class="math inline">\((\beta_0, \beta_1)\)</span></p>
<ul>
<li>
<p><span class="math inline">\(\beta_0\)</span></p>
<ul>
<li><p><span class="math inline">\(Y\)</span>-intercept of the regression line and gives <span class="math inline">\(Y\)</span>’s mean when <span class="math inline">\(X = 0\)</span> → <span class="math inline">\(E(Y \mid X = 0) = \beta_0 + \beta_1 \cdot 0 = \beta_0\)</span></p></li>
<li>
<p>Only makes sense to interpret when <span class="math inline">\(X=0\)</span> is within the scope of the model. So, ask two questions when deciding whether or not to interpret:</p>
<ol type="1">
<li><p>Does it make sense to interpret in context?</p></li>
<li><p>Do we have data in the proximity of zero?</p></li>
</ol>
</li>
<li><p>If answer “no” to either of these, then no need to interpret the intercept.</p></li>
</ul>
</li>
<li>
<p><span class="math inline">\(\beta_1\)</span></p>
<ul>
<li><p>Slope of the regression line and indicates the change in <span class="math inline">\(Y\)</span>’s <strong>mean</strong> when <span class="math inline">\(X\)</span> increases by one unit → <span class="math inline">\(E(Y \mid X = x^* + 1) - E(Y \mid X = x^*) = [\beta_0 + \beta_1 (x^* + 1)] - [\beta_0 + \beta_1 x^*] = \beta_1\)</span></p></li>
<li><p>Determines whether a relationship exists between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>.</p></li>
<li><p>Note that regression <strong>does not</strong> substantiate or prove a <strong>cause-effect</strong> relationship. Rather it gives evidence that <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> are related (but not that <span class="math inline">\(X\)</span> “causes” the value of <span class="math inline">\(Y\)</span>).</p></li>
</ul>
</li>
</ul>
<p>Model scope (and the dangers of extrapolation)</p>
<ul>
<li><p>The structural form of the relationship may not be the same as you move away from the observed predictor space. Therefore, using <span class="math inline">\(\hat{Y}\)</span> for estimation / prediction at <span class="math inline">\(X\)</span> values outside of model scope would be extrapolation and results are not reliable.</p></li>
<li><p>Should collect data from the entire region of predictor values of research interest.</p></li>
</ul>
<p><img src="files/images/extrapolation.png" class="img-fluid" style="width:30.0%"></p>
<p>Estimators</p>
<ul>
<li>
<p>Purpose</p>
<ul>
<li><p>Estimators help us make inferences about population parameters.</p></li>
<li><p>Each estimator corresponds to a population parameter (e.g.&nbsp;<span class="math inline">\(\hat{\beta}_1 \rightarrow \beta_1\)</span>).</p></li>
</ul>
</li>
<li>
<p>Estimator / estimate distinction</p>
<ul>
<li><p>Estimators are based on formulas (e.g.&nbsp;<span class="math inline">\(\bar{X} = \frac{1}{n} \sum X_i\)</span>).</p></li>
<li><p>Estimates are values computed from estimators.</p></li>
</ul>
</li>
<li>
<p>Good estimators</p>
<ul>
<li><p><strong>Bias</strong> of an estimator is the difference between the estimator’s expected value and the true value of the parameter being estimated:</p></li>
<li>
<p>If the <strong>bias equals zero</strong>, the estimator is said to be <strong>unbiased</strong>. <span class="math display">\[\text{Bias} = E(\hat{\theta}) - \theta\]</span></p>
<ul>
<li><p>e.g.&nbsp;<span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(\mu\)</span> → <span class="math inline">\(E(\bar{X}) \overset{\surd} = \mu\)</span>.</p></li>
<li><p>Another way to think about it → <span class="math inline">\(E(\bar{X})\)</span> will be the center of the sampling distribution of <span class="math inline">\(\bar{X}\)</span> (which will be approximately normal because of the central limit theorem), and we want this to equal <span class="math inline">\(\mu\)</span>.</p></li>
</ul>
</li>
<li>
<p>The standard deviation of an estimator is referred to as the <strong>standard error</strong> of said estimator.</p>
<ul>
<li>Ideally, estimators will have relatively small standard deviations, in which case they are said to be <strong>efficient</strong>.</li>
</ul>
</li>
</ul>
</li>
</ul></section><section id="estimation-of-the-regression-function" class="level3" data-number="1.1.2"><h3 data-number="1.1.2" class="anchored" data-anchor-id="estimation-of-the-regression-function">
<span class="header-section-number">1.1.2</span> Estimation of the regression function</h3>
<p>Setup</p>
<ul>
<li><p>For each point we have an observed value <span class="math inline">\(Y_i\)</span>, a fitted value <span class="math inline">\(\hat{Y}_i\)</span> and a residual <span class="math inline">\(\hat{\epsilon}_i\)</span>.</p></li>
<li><p>Fitted regression function → <span class="math inline">\(\hat{Y_i} = \hat{\beta}_0 + \hat{\beta}_1 X_i\)</span>, where <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_0\)</span> are estimators of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, respectively.</p></li>
</ul>
<p>Goal</p>
<ul>
<li><p>Goal is to estimate the two “regression” parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p></li>
<li><p>There are several methods to do this.</p></li>
</ul></section><section id="method-of-least-squares" class="level3" data-number="1.1.3"><h3 data-number="1.1.3" class="anchored" data-anchor-id="method-of-least-squares">
<span class="header-section-number">1.1.3</span> Method of least squares</h3>
<p>Overview</p>
<ul>
<li><p>The method of least squares is one way to find “good” estimators of the regression parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p></li>
<li><p>For each observation <span class="math inline">\((X_i, Y_i)\)</span>, this method considers the model error term, which is the deviation of <span class="math inline">\(Y_i\)</span> from its expected value:</p></li>
</ul>
<p><span class="math display">\[
\epsilon_i = Y_i - E(Y_i) = Y_i - (\beta_0 + \beta_1 X_i)
\]</span></p>
<ul>
<li>Then we minimize the sum of some function of these errors:</li>
</ul>
<p><span class="math display">\[
\begin{align*}
  Q &amp;= \sum_{i = 1}^n \text{function of } \epsilon_i \\
    &amp;= \sum_{i = 1}^n \text{function of } \big(Y_i - E(Y_i)\big) \\
    &amp;= \sum_{i = 1}^n \text{function of } \big(Y_i - (\beta_0 + \beta_1 X_i)\big) \quad\quad \text{&lt; for SLR &gt;}
\end{align*}
\]</span></p>
<ul>
<li>For least squares method specifically, we consider the sum of the <span class="math inline">\(n\)</span> squared errors (deviations). Thus we have:</li>
</ul>
<p><span class="math display">\[
\begin{align*}
  Q &amp;= \sum_{i = 1}^n \epsilon_i^2 \\
    &amp;= \sum_{i = 1}^n (Y_i - \beta_0 - \beta_1 X_i)^2
\end{align*}
\]</span></p>
<!-- discussion that this is a loss function, squared loss. there are others??? from theory -->
<ul>
<li><p>According to the method of least squares, the <strong>point estimators</strong> (functions of the random sample that estimate population quantities) of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are those values <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span>, respectively, that minimize the criterion <span class="math inline">\(Q\)</span> for the sample observations <span class="math inline">\((X_1, Y_1), \ldots, (X_n, Y_n)\)</span>.</p></li>
<li><p>Once data is collected, the <strong>estimates</strong> (realized values) for <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> are calculated based on the observed sample <span class="math inline">\((x_1, y_1), \ldots, (x_n, y_n)\)</span>. (Note: no good notation for this, maybe <span class="math inline">\(\hat{b}_0\)</span> and <span class="math inline">\(\hat{b}_1\)</span>; similar idea for means: <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(\bar{x}\)</span>)</p></li>
</ul>
<p>Least squares estimators</p>
<ul>
<li>
<p>These can be found in two ways.</p>
<ol type="1">
<li><p>Numerical methods (optimization) → Search procedures to systematically evaluate the least squares criterion <span class="math inline">\(Q\)</span> for different estimates <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> until the ones that minimize <span class="math inline">\(Q\)</span> are found.</p></li>
<li><p>Analytical methods → Using calculus. The analytical approach is feasible when the regression model is not mathematically complex.</p></li>
</ol>
</li>
<li>
<p>The general process for deriving the least squares estimators of any model is:</p>
<ol type="1">
<li><p>Write <span class="math inline">\(Q\)</span> as a function of the model error term <span class="math inline">\(\epsilon_i\)</span> as shown above.</p></li>
<li><p>Take derivative with respect to the desired parameter <span class="math inline">\(\beta_i\)</span>.</p></li>
<li><p>Set derivative equal to zero (notation: substituting population term <span class="math inline">\(\beta_i\)</span> for its estimator <span class="math inline">\(\hat{\beta}_i\)</span>) and solve for <span class="math inline">\(\hat{\beta}_i\)</span>.</p></li>
<li><p>Check second derivative test to ensure global minimum (take derivative from result of step 2)</p></li>
</ol>
</li>
<li><p>Using the analytical approach with the SLR model, we have the following results:</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Results</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Derivation</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<ul>
<li>The estimators <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> are found by solving the simultaneous equations (called the <strong>normal equations</strong>):</li>
</ul>
<p><span class="math display">\[
\begin{align*}
  \sum Y_i n &amp;= \hat{\beta}_0 + \hat{\beta}_1 \sum X_i \\
  \sum X_i Y_i &amp;= \hat{\beta}_0 \sum X_i + \hat{\beta}_1 \sum X_i^2
\end{align*}
\]</span></p>
<ul>
<li>This leads to</li>
</ul>
<p><span class="math display">\[
\begin{align*}
  \text{Intercept} \hspace{10pt} \hat{\beta}_0 \hspace{10pt} &amp;= \hspace{10pt} \frac{1}{n}\sum Y_i + \hat{\beta}_1 \frac{1}{n} \sum X_i \hspace{10pt} = \hspace{10pt} \bar{Y}- \hat{\beta}_1 \bar{X} \\
  \text{Slope} \hspace{10pt} \hat{\beta_1} \hspace{10pt} &amp;= \hspace{10pt} \frac{\sum X_i Y_i -\frac{1}{n} \sum X_i Y_i}{\sum X_i^2 - \frac{1}{n}(\sum X_i)^2} \hspace{10pt} = \hspace{10pt} \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2} \hspace{10pt} = \hspace{10pt} \frac{S_{XY}}{S_{XX}}
\end{align*}
\]</span></p>
<ul>
<li>Note: We did not have to assume any distribution of the error term. These are the LSE estimators for any SLR model.</li>
</ul>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p><img src="files/images/slr-lse-derivation.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</div>
<ul>
<li>
<p>Demo:</p>
<ul>
<li>First we can generate the sample data <span class="math inline">\((x_1, y_1), \ldots, (x_n, y_n)\)</span>.</li>
</ul>
</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># simulate sample regression dataset from population model</span></span>
<span><span class="co"># -&gt; E ~ Uniform(a, b)</span></span>
<span><span class="co"># -&gt; Y = B0 + B1X + E</span></span>
<span><span class="co"># -&gt; Y | X ~ Uniform(B0 + B1*X - a, B0 + B1*X + b)</span></span>
<span></span>
<span><span class="co"># initialize items</span></span>
<span><span class="co"># -&gt; sample size, population parameters and error distribution parameters</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">beta_0</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">beta_1</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">min</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span></span>
<span><span class="va">max</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># generate X values</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, min <span class="op">=</span> <span class="fl">5</span>, max <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate error terms</span></span>
<span><span class="co"># -&gt; assumption for LSE is E(epsilon) = 0, so symmetric uniform about zero works</span></span>
<span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, min <span class="op">=</span> <span class="va">min</span>, max <span class="op">=</span> <span class="va">max</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate y terms as function of x and error terms</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">beta_0</span> <span class="op">+</span> <span class="va">beta_1</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="va">epsilon</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># display observed sample data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">display_nice</span><span class="op">(</span>col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table data-quarto-disable-processing="true" class="table table-striped" style="width: auto !important; ">
<thead><tr>
<th style="text-align:right;"> x </th>
   <th style="text-align:right;"> y </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 7.917 </td>
   <td style="text-align:right;"> 18.127 </td>
  </tr>
<tr>
<td style="text-align:right;"> 9.795 </td>
   <td style="text-align:right;"> 21.438 </td>
  </tr>
<tr>
<td style="text-align:right;"> 11.515 </td>
   <td style="text-align:right;"> 24.736 </td>
  </tr>
<tr>
<td style="text-align:right;"> 6.321 </td>
   <td style="text-align:right;"> 12.550 </td>
  </tr>
<tr>
<td style="text-align:right;"> 8.426 </td>
   <td style="text-align:right;"> 18.699 </td>
  </tr>
<tr>
<td style="text-align:right;"> 13.068 </td>
   <td style="text-align:right;"> 26.100 </td>
  </tr>
<tr>
<td style="text-align:right;"> 7.389 </td>
   <td style="text-align:right;"> 13.980 </td>
  </tr>
<tr>
<td style="text-align:right;"> 5.484 </td>
   <td style="text-align:right;"> 13.794 </td>
  </tr>
<tr>
<td style="text-align:right;"> 9.983 </td>
   <td style="text-align:right;"> 20.721 </td>
  </tr>
<tr>
<td style="text-align:right;"> 9.129 </td>
   <td style="text-align:right;"> 20.242 </td>
  </tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot sample data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-slr_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Then we can fit the model and visualize it on the scatter plot.</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># add regression line to plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">14</span>, y <span class="op">=</span> <span class="fl">22</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hat</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">*</span> <span class="st">" = "</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hat</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hat</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="st">"X"</span><span class="op">)</span> , col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-slr_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Finally we can get the estimates of <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span>.</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R Functions</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Manual</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fit SLR model</span></span>
<span><span class="co"># -&gt; lm() calls lm.fit() behind the scenes --&gt; this performs a QR decomposition to fit the model, which is a more stable way to solve for LSE</span></span>
<span><span class="va">mod_slr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># display estimated coefficients</span></span>
<span><span class="va">mod_slr</span><span class="op">$</span><span class="va">coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)           x 
   2.248209    1.841830 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># or can do</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">mod_slr</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod_slr</span><span class="op">)</span> <span class="co"># alias for coefficients()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These are estimates of the population coefficients, so can compare above values to <span class="math inline">\(\beta_0\)</span> = 1 and <span class="math inline">\(\beta_1\)</span> = 2.</p>
<p><mark><strong>Programming note → Beautiful sites (<a href="https://genomicsclass.github.io/book/pages/qr_and_regression.html">(1)</a> and <a href="https://machinelearningmastery.com/solve-linear-regression-using-linear-algebra/#:~:text=The%20QR%20decomposition%20is%20an,down%20into%20its%20constituent%20elements.&amp;text=Where%20A%20is%20the%20matrix,the%20linear%20least%20squares%20equation.">(2)</a>) explaining QR decomposition and how it relates to LSE; must go through and recreate at some point.</strong></mark></p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate estimates for B0 and B1 using LSE formulas</span></span>
<span><span class="co"># -&gt; b_1 = S_XY / S_XX</span></span>
<span><span class="co"># -&gt; b_0 = Y-bar - b_1 X-bar</span></span>
<span><span class="va">s_xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">s_xx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">b_1</span> <span class="op">&lt;-</span> <span class="va">s_xy</span> <span class="op">/</span> <span class="va">s_xx</span></span>
<span><span class="va">b_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">-</span> <span class="va">b_1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compare to results from lm()</span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">b_0</span>, <span class="va">b_1</span><span class="op">)</span>, <span class="va">mod_slr</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$comparison
(Intercept)           x 
       TRUE        TRUE 

$`c(b_0, b_1)`
[1] 2.248209 1.841830

$`mod_slr$coefficients`
(Intercept)           x 
   2.248209    1.841830 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>LSE for other models</p>
<ul>
<li><p>Can also derive LSE estimators for other models using the same process.</p></li>
<li>
<p>Example 1</p>
<ul>
<li>Regression through the origin: <span class="math inline">\(Y = \beta X + \epsilon\)</span>.</li>
</ul>
</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Setup and Derivation</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">R Functions</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Manual</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># simulate sample regression through the origin dataset from population model</span></span>
<span><span class="co"># -&gt; E ~ Uniform(a, b)</span></span>
<span><span class="co"># -&gt; Y = BX + E</span></span>
<span><span class="co"># -&gt; Y | X ~ Uniform(B*X + a, B*X + b)</span></span>
<span></span>
<span><span class="co"># initialize items</span></span>
<span><span class="co"># -&gt; sample size, population parameters and error distribution parameters</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">min</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">3</span></span>
<span><span class="va">max</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span></span>
<span><span class="co"># generate X values</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, max <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Y | X ~ Uniform(min = BX + a, max = BX + b)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, min <span class="op">=</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="va">min</span>, max <span class="op">=</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="va">max</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot sample data</span></span>
<span><span class="co"># add regression line to plot and reference line for origin</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hat</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">*</span> <span class="st">" = "</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hat</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span> <span class="op">*</span> <span class="st">"X"</span><span class="op">)</span> , col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-slr_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Derivation of estimator:</li>
</ul>
<p><img src="files/images/slr-lse-derivation-origin.png" class="img-fluid" style="width:40.0%"></p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fit SLR model without intercept</span></span>
<span><span class="va">mod_noint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># display estimated coefficient</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">mod_noint</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      x 
2.17725 </code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate estimate B using LSE formula</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="va">y</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compare to results from lm()</span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="va">b</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">mod_noint</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$comparison
   x 
TRUE 

$b
[1] 2.17725

$`coefficients(mod_noint)`
      x 
2.17725 </code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>
<p>Example 2</p>
<ul>
<li><p>Regression through the origin with squared predictor variable: <span class="math inline">\(Y = \beta_1 X^2 + \epsilon\)</span>.</p></li>
<li><p>Sometimes a transformation can make deriving estimators easier. This way we can get the model in a familiar form and derive like usual (simpler). Then we just have to make the appropriate substitutions at the end in order to get the estimators for the original models.</p></li>
<li><p>This strategy lessens the number of models we have to know how to derive (note this is just for deriving; no need to do it when fitting models because it’s an extra middle step that doesn’t change anything, leads to equivalent results).</p></li>
</ul>
</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Setup and Derivation</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">R Functions</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Manual</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># simulate sample regression through the origin with squared predictor dataset from population model</span></span>
<span><span class="co"># -&gt; E ~ Uniform(a, b)</span></span>
<span><span class="co"># -&gt; Y = BX + E</span></span>
<span><span class="co"># -&gt; Y | X ~ Uniform(B*X^2 + a, B*X^2 + b)</span></span>
<span></span>
<span><span class="co"># initialize items</span></span>
<span><span class="co"># -&gt; sample size, population parameters and error distribution parameters</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">min</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">3</span></span>
<span><span class="va">max</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span></span>
<span><span class="co"># generate X values</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Y | X ~ Uniform(min = BX^2 + a, max = BX^2 + b)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, min <span class="op">=</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">min</span>, max <span class="op">=</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">max</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot sample data</span></span>
<span><span class="co"># add regression line to plot and reference line for origin</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">4</span>, y <span class="op">=</span> <span class="fl">15</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hat</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">*</span> <span class="st">" = "</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hat</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span> <span class="op">*</span> <span class="va">X</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> , col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-slr_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Derivation of estimator:</li>
</ul>
<p><img src="files/images/slr-lse-derivation-origin-squared.png" class="img-fluid" style="width:90.0%"></p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fit SLR model with no intercept and squared X</span></span>
<span><span class="co"># -&gt; use asis function I() to treat `^` as an arithmetic operator and not a formula operator</span></span>
<span><span class="co"># -&gt; save design matrix for later demo</span></span>
<span><span class="va">mod_noint_squared</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># display estimated coefficient</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod_noint_squared</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> I(x^2) 
1.99715 </code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate estimates B using LSE formula</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">y</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compare to results from lm()</span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="va">b</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod_noint_squared</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$comparison
I(x^2) 
  TRUE 

$b
[1] 1.99715

$`coef(mod_noint_squared)`
 I(x^2) 
1.99715 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># demonstrating that transformed model way is equivalent</span></span>
<span><span class="co"># -&gt; square predictor variable</span></span>
<span><span class="va">x_star</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">mod_transformed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span>  <span class="va">x_star</span>, x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compare design matrices of two models</span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mod_noint_squared</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mod_transformed</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
  I(x^2)
1   TRUE
2   TRUE
3   TRUE
4   TRUE
5   TRUE
6   TRUE

$`head(mod_noint_squared$x)`
      I(x^2)
1 17.5787765
2 16.4235865
3  1.9257954
4  0.6732229
5  1.3335716
6 18.0385428

$`head(mod_transformed$x)`
      x_star
1 17.5787765
2 16.4235865
3  1.9257954
4  0.6732229
5  1.3335716
6 18.0385428</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate estimates B using LSE formula</span></span>
<span><span class="va">b_star</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x_star</span> <span class="op">*</span> <span class="va">y</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x_star</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compare betas from usual method and transformed model way</span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="va">b</span>, <span class="va">b_star</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE

$b
[1] 1.99715

$b_star
[1] 1.99715</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Properties of least squares estimators</p>
<ul>
<li>
<p><strong>Gauss-Markov theorem</strong>: If the conditions of the SLR model hold (i.e.&nbsp;<span class="math inline">\(Y_i= \beta_0 + \beta_1 X_i + \epsilon_i\)</span>, where <span class="math inline">\(\epsilon_i\)</span> have mean zero, variance <span class="math inline">\(\sigma^2\)</span> and are uncorrelated), then the LSE <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> are the <strong>Best Linear Unbiased Estimators (BLUE)</strong> (note that <span class="math inline">\(\epsilon_i\)</span> do not have to be normal).</p>
<ol type="1">
<li><p>Linear estimators → Through lots of algebra (shown later), <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> can be written as be written as a linear combination of the <span class="math inline">\(Y_i\)</span>: <span class="math inline">\(\sum k_i Y_i\)</span>, where <span class="math inline">\(k_i\)</span> are constant. Thus they are linear estimators.</p></li>
<li><p>Unbiased estimators → Their expected values are <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, respectively. So neither estimator tends to overestimate or underestimate systematically.</p></li>
<li><p>Best → More precise than <em>all other linear unbiased estimators of</em> <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> (smaller variance of the sampling distributions).</p></li>
</ol>
</li>
</ul></section><section id="point-estimation-of-the-mean-response" class="level3" data-number="1.1.4"><h3 data-number="1.1.4" class="anchored" data-anchor-id="point-estimation-of-the-mean-response">
<span class="header-section-number">1.1.4</span> Point estimation of the mean response</h3>
<ul>
<li><p>For the population relationship <span class="math inline">\(Y = \beta_0 + \beta_1 X + \epsilon\)</span>, we have the regression function <span class="math inline">\(E(Y) = \beta_0 + \beta_1 X\)</span> (because <span class="math inline">\(E(\epsilon) = 0\)</span>). This is estimated with <span class="math inline">\(\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1 X\)</span>.</p></li>
<li>
<p>Terms and what they represent:</p>
<ul>
<li><p><span class="math inline">\(Y\)</span> is a value of the response variable; the observed value.</p></li>
<li><p><span class="math inline">\(E(Y)\)</span> the mean response. So it is the center of the probability distribution of <span class="math inline">\(Y\)</span> corresponding to the level <span class="math inline">\(X\)</span> of the predictor variable (so technically a conditional expected value <span class="math inline">\(E(Y \mid X)\)</span>.</p></li>
<li><p><span class="math inline">\(\hat{Y}\)</span> is a point estimator of the mean response when the level of the predictor variable is <span class="math inline">\(X\)</span>; the fitted value.</p></li>
</ul>
</li>
<li>
<p>Application of Gauss-Markov theorem</p>
<ul>
<li>
<span class="math inline">\(\hat{Y}\)</span> is the BLUE for <span class="math inline">\(E(Y)\)</span> with <span class="math inline">\(V(\hat{Y}) = V(\epsilon) = \sigma^2\)</span>.</li>
</ul>
</li>
</ul></section><section id="residuals-and-model-errors" class="level3" data-number="1.1.5"><h3 data-number="1.1.5" class="anchored" data-anchor-id="residuals-and-model-errors">
<span class="header-section-number">1.1.5</span> Residuals and model errors</h3>
<ul>
<li><p>Model error term <span class="math inline">\(\epsilon_i = Y_i - E(Y_i) = Y_i - (\beta_0 + \beta_1 X_i)\)</span> → Measures the difference between an observation and its expected value (unknown true regression line). It is unknown / unobservable.</p></li>
<li><p>Residual <span class="math inline">\(\hat{\epsilon}_i = e_i = Y_i - \hat{Y}_i\)</span> → This is a known, observable estimate of the unobservable model error. Measures the deviation of the observed value from the fitted regression function.</p></li>
</ul>
<p><img src="files/images/residual.png" class="img-fluid" style="width:40.0%"></p>
<ul>
<li>Residuals are very useful for studying whether the given regression model is appropriate for the data.</li>
</ul>
<!-- - <mark> Independence </mark> &rarr;  Because of how are models are constructed   the sum of the residuals is necessarily zero, and thus the residuals are necessarily not independent. However, the model errors are independent (by assumption), and their is almost surely not zero (???? but we expect them to balance out, expected value equal to zero). --><!-- Properties of fitted regression line: PAGE 23, gives 6 properties, could demonstrate if wanted, not sure why these are useful to know --></section></section><section id="estimation-of-error-terms-variance" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="estimation-of-error-terms-variance">
<span class="header-section-number">1.2</span> Estimation of error terms variance</h2>
<p>Need to estimate the variance <span class="math inline">\(\sigma^2\)</span> of the error terms <span class="math inline">\(\epsilon_i\)</span> in a regression model to get an indication of the variability of the probability distributions of <span class="math inline">\(Y\)</span>. Also several inferences for models require an estimate of <span class="math inline">\(\sigma^2\)</span>.</p>
<p>Motivation</p>
<ul>
<li>For a single population, the variance <span class="math inline">\(\sigma^2\)</span> is estimated by the sample variance <span class="math inline">\(S^2\)</span>, which is an unbiased estimator. We find <span class="math inline">\(S^2\)</span> by taking the sum of the squared deviations of the observed value and the estimated mean (sum of squares) and then dividing it by the degrees of freedom <span class="math inline">\(n - 1\)</span> (one df is lost when estimating <span class="math inline">\(\mu\)</span>; mean square) .</li>
</ul>
<p><span class="math display">\[
S^2 = \frac{\sum_{i = 1}^n (Y_i - \bar{Y})^2}{n - 1}
\]</span></p>
<p>Regression model</p>
<ul>
<li>Same logic as above, except we use the residuals as the deviations because each <span class="math inline">\(Y_i\)</span> comes from a different probability distribution with different <span class="math inline">\(X\)</span> (depends on the <span class="math inline">\(X_i\)</span> level).</li>
</ul>
<p><span class="math display">\[
\text{Error (residual) sum of squares} \hspace{10pt} SSE = \sum_{i = 1}^n (Y_i - \hat{Y_i})^2 = \sum_{i = 1}^n e_i^2
\]</span></p>
<ul>
<li>Then divide by the <span class="math inline">\(df = n - 2\)</span> to the mean square (two dfs are lost when because <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> need to be estimated when getting the estimated means <span class="math inline">\(\hat{Y_i}\)</span>).</li>
</ul>
<p><span class="math display">\[
\text{Error (residual) mean square} \hspace{10pt} S^2 = MSE = \frac{SSE}{n - 2} = \frac{\sum_{i = 1}^n (Y_i - \hat{Y_i})^2}{n - 2} = \frac{\sum_{i = 1}^n e_i^2}{n - 2}
\]</span></p>
<ul>
<li><p>It will be shown later that <span class="math inline">\(MSE\)</span> is an unbiased estimator for <span class="math inline">\(\sigma^2\)</span> → <span class="math inline">\(E(MSE) = \sigma^2\)</span>.</p></li>
<li><p>An estimator of the standard deviation is simply <span class="math inline">\(S = \sqrt{MSE}\)</span>.</p></li>
</ul>
<p>Demo</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R functions</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Manual</a></li>
</ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># simulate dataset (using uniform errors)</span></span>
<span><span class="co"># initialize items, generate X values, errors and y values</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span>; <span class="va">beta_0</span> <span class="op">&lt;-</span> <span class="fl">1</span>; <span class="va">beta_1</span> <span class="op">&lt;-</span> <span class="fl">2</span>; <span class="va">min</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span>; <span class="va">max</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, min <span class="op">=</span> <span class="fl">5</span>, max <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, min <span class="op">=</span> <span class="va">min</span>, max <span class="op">=</span> <span class="va">max</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">beta_0</span> <span class="op">+</span> <span class="va">beta_1</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="va">epsilon</span></span>
<span></span>
<span><span class="co"># fit model</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># display model summary -&gt; looking for residual standard error = S = sqrt(MSE)</span></span>
<span><span class="co"># -&gt; save to object to extract it</span></span>
<span><span class="op">(</span><span class="va">summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.6748 -1.1341  0.2154  1.0948  2.1662 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  2.82054    0.85005   3.318              0.00252 ** 
x            1.82294    0.08081  22.558 &lt; 0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.287 on 28 degrees of freedom
Multiple R-squared:  0.9478,    Adjusted R-squared:  0.946 
F-statistic: 508.9 on 1 and 28 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># display S and MSE = S^2</span></span>
<span><span class="va">summ</span><span class="op">$</span><span class="va">sigma</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.287457</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ</span><span class="op">$</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.657546</code></pre>
</div>
</div>
<p>These are estimates of population quantities for the error terms, and when simulating the data we assumed <span class="math inline">\(\epsilon_i \sim \text{Uniform}\,(a, b) \Longrightarrow \sigma^2 = V(\epsilon_i) = \frac{(b - a)^2}{12}\)</span>. For <span class="math inline">\(a\)</span> = -2 and <span class="math inline">\(b\)</span> = 2, <span class="math inline">\(V(\epsilon_i)\)</span> = 1.333.</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># SIDENOTE -&gt; showing multiple equivalent ways to do the same thing (just keep the last way)</span></span>
<span></span>
<span><span class="co"># get fitted values using functions</span></span>
<span><span class="va">y_hat</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">fitted.values</span></span>
<span><span class="va">y_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="va">y_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted.values</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="co"># alias for fitted()</span></span>
<span><span class="va">y_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="co"># discussed more later</span></span>
<span></span>
<span><span class="co"># extract residuals using functions (or some manual calculations)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="co"># alias for residuals()</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">-</span> <span class="va">y_hat</span></span>
<span></span>
<span><span class="co"># calculate SSE and df</span></span>
<span><span class="va">sse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">e</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">df.residual</span> <span class="co"># extract from model object</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/df.residual.html">df.residual</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">summ</span><span class="op">$</span><span class="va">df</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="co"># extract from model summary -&gt; error df is the second item (even if have MLR model)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">2</span> <span class="co"># for SLR (with intercept)</span></span>
<span></span>
<span><span class="co"># calculate MSE</span></span>
<span><span class="va">mse</span> <span class="op">&lt;-</span> <span class="va">sse</span> <span class="op">/</span> <span class="va">df</span></span>
<span></span>
<span><span class="co"># calculate residual standard deviation</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">mse</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compare to results from summary(lm())</span></span>
<span><span class="co"># -&gt; s</span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="va">summ</span><span class="op">$</span><span class="va">sigma</span>, <span class="va">s</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE

$`summ$sigma`
[1] 1.287457

$s
[1] 1.287457</code></pre>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># -&gt; MSE</span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="va">summ</span><span class="op">$</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span>, <span class="va">mse</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE

$`summ$sigma^2`
[1] 1.657546

$mse
[1] 1.657546</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># -&gt; SSE = MSE * df</span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="va">summ</span><span class="op">$</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">summ</span><span class="op">$</span><span class="va">df</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">sse</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE

$`summ$sigma^2 * summ$df[2]`
[1] 46.41128

$sse
[1] 46.41128</code></pre>
</div>
</div>
<!-- alternate formula for sse = syy - beta1-hat sxy: from notes; not sure if needed -->
</div>
</div>
</div>
</section><section id="normal-error-regression-model" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="normal-error-regression-model">
<span class="header-section-number">1.3</span> Normal error regression model</h2>
<p>Least squares results</p>
<ul>
<li>No matter what may be the form of the distribution of the error terms <span class="math inline">\(\epsilon_i\)</span> (and thus of the <span class="math inline">\(Y_i\)</span>), the LSE provides unbiased point estimators of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, that have minimum variance among all unbiased linear estimators (BLUEs).</li>
</ul>
<p>Assumptions on error term distribution</p>
<ul>
<li><p>These assumptions on <span class="math inline">\(\epsilon_i\)</span> are needed to set up interval estimates and make tests.</p></li>
<li><p>The standard assumption is that the error terms are normally distributed. This greatly simplifies the theory of regression analysis and is justifiable in many real-world situations where regression analysis is applied.</p></li>
</ul>
<p>New regression model</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i + \epsilon_i, \hspace{20pt} \text{where} \hspace{10pt} \epsilon_i \overset{iid}\sim \text{Normal}\,(0,\sigma^2)
\]</span></p>
<ul>
<li><p>This is the same regression model as before, just with specified error distribution now (<span class="math inline">\(iid\)</span> = independent and identically distributed).</p></li>
<li><p>Because this model assumes normal errors, the assumption of uncorrelatedness of the original (unspecified error) model now becomes an independence assumption (<span class="math inline">\(\perp \!\!\! \perp\Longrightarrow \mathrm{Corr}(\epsilon_i,\epsilon_j) = 0\)</span>. So the outcome in anyone trial has no effect on the error term for any other trial (in terms of positive or negative, small or large).</p></li>
<li><p>This model means <span class="math inline">\(Y_i \overset{\perp \!\!\! \perp}\sim \text{Normal}\,\)</span> with <span class="math inline">\(E(Y_i) = \beta_0 + \beta_1 X_i\)</span> and <span class="math inline">\(V(Y_i) = \sigma^2\)</span>.</p></li>
</ul>
<p><img src="files/images/normal-error-model.png" class="img-fluid" style="width:50.0%"></p>
<p>Justification of the normality assumption.</p>
<ul>
<li><p>Error terms frequently represent the effects of factors omitted from the model that affect the response to some extent and that vary at random without reference to the variable <span class="math inline">\(X\)</span>.</p></li>
<li><p>These random effects have a degree of mutual independence, the composite error term representing all these factors tends to normal as the number of factors becomes large (by the CLT).</p></li>
<li><p>Also, the estimation and testing procedures shown later are based on the <span class="math inline">\(t\)</span> distribution and are usually only sensitive to large departures from normality. So, unless the departures from normality are serious, particularly with respect to skewness, the actual confidence coefficients and risks of errors will be close to the levels for exact normality.</p></li>
</ul>
<section id="estimation-of-paramters-by-method-of-maximum-likelihood" class="level3" data-number="1.3.1"><h3 data-number="1.3.1" class="anchored" data-anchor-id="estimation-of-paramters-by-method-of-maximum-likelihood">
<span class="header-section-number">1.3.1</span> Estimation of paramters by method of maximum likelihood</h3>
<p>Overview</p>
<ul>
<li>
<p>The method of maximum likelihood chooses as estimates values of the parameters that are most consistent with the sample data. The measure of consistency is the product of densities and is called the <strong>likelihood value</strong> <span class="math inline">\(L(\mu)\)</span>.</p>
<ul>
<li>If the value of <span class="math inline">\(\mu\)</span> is consistent with the sample data <span class="math inline">\(\Longrightarrow\)</span> densities relatively large <span class="math inline">\(\Longrightarrow\)</span> large likelihood value. If not, both will be small.</li>
</ul>
</li>
</ul>
<p><img src="files/images/mle-example.png" class="img-fluid" style="width:70.0%"></p>
<ul>
<li><p>Just like the LSE, there are two ways to find MLEs: a systematic numerical search and by use of an analytical solution.</p></li>
<li>
<p>The product of the densities viewed as a function of the unknown parameters is called the <strong>likelihood function</strong>.</p>
<ul>
<li><p>If the likelihood function is relatively peaked in the neighborhood of the maximum, then the MLE estimate is precise because values of <span class="math inline">\(\mu\)</span> not near the MLE are much less consistent with the data.</p></li>
<li><p>When it is relatively flat in a fairly wide region around the MLE, many values of the parameter are almost as consistent with the sample data as the MLE and therefore the MLE is relatively imprecise.</p></li>
</ul>
</li>
</ul>
<!-- SHOW PLOTS and stuff from MLE DEMO??? --><!-- find example of flat mle maybe --><!-- and where have to numerical maximize to get coefficients? functions for how to do this in R?? Is this where gradient descent comes into play?? --><p>Steps to MLEs</p>
<ol type="1">
<li>
<p>For multivariate parameter vector <span class="math inline">\(\boldsymbol{\theta} = (\theta_1, \ldots, \theta_{k})\)</span>, write the likelihood function (i.e.&nbsp;joint density function) and the log-likelihood function</p>
<!-- !!! add more background about MLEs, like why optimize log... -->
</li>
</ol>
<p><span class="math display">\[
L(\boldsymbol{\theta} \mid \mathbf{y}) = \prod_{i = 1}^n f(\mathbf{y} \mid \boldsymbol{\theta}) \hspace{20pt} \rightarrow \hspace{20pt} \ell(\boldsymbol{\theta}) = \ln[L(\boldsymbol{\theta} \mid \mathbf{y})]
\]</span></p>
<ol start="2" type="1">
<li>Optimize the log-likelihood function by taking the partial derivatives with respect to each parameters of interest <span class="math inline">\(\theta_1, \ldots, \theta_{k}\)</span>.</li>
</ol>
<ul>
<li>Set to zero and solve for each parameter of interest.</li>
</ul>
<p><span class="math display">\[
\text{For } j = 1, \ldots, k \hspace{20pt} \ell'(\boldsymbol{\theta}) = \frac{\partial}{\partial \theta_j} \ell(\boldsymbol{\theta}) = 0 \hspace{20pt} \rightarrow \hspace{20pt} \hat{\boldsymbol{\theta}} = (\hat{\theta}_1, \ldots, \hat{\theta}_{k}) = \text{potential MLE}
\]</span></p>
<ul>
<li><p>Verify that the global maximum of the log-likelihood function occurs at <span class="math inline">\(\boldsymbol{\theta} = \hat{\boldsymbol{\theta}}\)</span>.</p></li>
<li><p>Find the second derivative of the log-likelihood function, then plug in <span class="math inline">\(\hat{\boldsymbol{\theta}}\)</span> and see if less than zero.</p></li>
</ul>
<!-- Hessian matrix stuff --><p>MLEs for normal error regression model</p>
<ul>
<li>Generally</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Results</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Derivation</a></li>
</ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 79%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">MLE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\beta_0\)</span></td>
<td style="text-align: left;">
<span class="math inline">\(\hat{\beta}_0 \hspace{10pt}\)</span> Same as LSE</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\beta_1\)</span></td>
<td style="text-align: left;">
<span class="math inline">\(\hat{\beta}_1 \hspace{10pt}\)</span> Same as LSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\sigma^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\displaystyle \hat{\sigma}^2 = \frac{\sum (Y_i - \hat{Y_i})^2}{n}\)</span></td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ul>
<li>
<p>Properties of estimators</p>
<ul>
<li><p>Since MLEs for <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> are the same as the LSE estimators, they have the same properties: BLUE (unbiased and minimum variance in class of unbiased linear estimators).</p></li>
<li><p>And because they are MLEs, we can also say they are: consistent (<span class="math inline">\(\hat{\beta}_i \overset{p}\rightarrow \beta_i\)</span>, converge in probability to their respective parameters); sufficient (captures all of the information about <span class="math inline">\(\beta_i\)</span> contained in the sample); minimum variance in class of unbiased estimators (linear or otherwise).</p></li>
</ul>
</li>
</ul>
<!-- better explanation of sufficiency; state theorem why best variance for all unbiased estimators --><ul>
<li>
<p>MLE <span class="math inline">\(\hat{\sigma}^2\)</span> and MSE</p>
<ul>
<li><p>Relationship <span class="math inline">\(S^2 = MSE = \frac{n}{n - 2} \hat{\sigma}^2 \hspace{20pt} \Longleftrightarrow \hspace{20pt} \hat{\sigma}^2 = \frac{n - 2}{n} MSE\)</span>. However, for large <span class="math inline">\(n\)</span>, the difference is small.</p></li>
<li><p>MLE <span class="math inline">\(\hat{\sigma}^2\)</span> is biased → <span class="math inline">\(E(\hat{\sigma}^2) = \frac{n - 2}{n} \sigma^2\)</span>, which is an underestimation of <span class="math inline">\(\sigma^2\)</span>. Because of this, MSE is generally used because it is unbiased. However, <span class="math inline">\(\hat{\sigma}^2\)</span> is asymptotically unbiased (as <span class="math inline">\(n \rightarrow \infty\)</span>) and has a smaller variance than MSE, which may be preferred in some scenarios (tradeoff between bias and precision).</p></li>
</ul>
</li>
<li><p>Generally MLE gives the same results as LSE.</p></li>
</ul>
<!-- investigate this, when, why? when is one better? !!!! what about when not normal??-->
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p><img src="files/images/placeholder.png" class="img-fluid" style="width:50.0%"></p>
<ul>
<li>
<p>Can also derive MLEs for transformed models using the same strategy as with LSE.</p>
<ul>
<li>Example: Suppose we have <span class="math inline">\(\ln(Y_i) = \beta_0 + \beta_1 X_i + \epsilon_i\)</span>. We can transform <span class="math inline">\(Y_i^* = \beta_0^* + \beta_1^* X_i + \epsilon_i\)</span>, derive like usual, then substitute at end to get untransformed estimators.</li>
</ul>
</li>
</ul>
<!-- demo calculating mle sigma2 in r based on residuals and compare to mse -->
</div>
</div>
</div>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./part1-slr.html" class="pagination-link  aria-label=" simple="" linear="" regression="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Simple linear regression</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./notes-inference.html" class="pagination-link" aria-label="<span class='chapter-number'>2</span>&nbsp; <span class='chapter-title'>Inference</span>">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inference</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb41" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Simple linear regression {#sec-slr}</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-prereqs</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr options</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"_common.R"</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % define LaTeX macros (/shortcuts) --&gt;</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % define vector (without parentheses, so when writing out in like a definition) of the form X_1, ..., X_n, where X and n are variable. </span><span class="al">NOTE</span><span class="co">: to call use $\vecn{X}{n}$ --&gt;</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>\newcommand{\vecn}<span class="co">[</span><span class="ot">2</span><span class="co">]</span>{#1_1, \ldots, #1_{#2}}</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % shortcut for ~ 'Named dist ' in normal font with space before parameters would go --&gt;</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>\newcommand{\follow}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\sim \text{#1}\,}</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % (followsp is short for 'follow special') shortcut that can be used for iid or ind ~ 'Named dist ' in normal font with space before parameters would go --&gt;</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>\newcommand{\followsp}<span class="co">[</span><span class="ot">2</span><span class="co">]</span>{\overset{#1}\sim \text{#2}\,}</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % define independence symbol (it basically makes two orthogonal symbols very close to each other. The number of \! controls the space between each of the orthogonal symbols) --&gt;</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>\newcommand{\ind}{\perp <span class="sc">\!\!\!</span> \perp}</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % shortcut for Cov(X,Y) with formatting for Cov --&gt;</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>\newcommand{\cov}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\mathrm{Cov}(#1)}</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % shortcut for Corr(X,Y) with formatting for Corr --&gt;</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>\newcommand{\corr}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\mathrm{Corr}(#1)}</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % shortcut for non-italic e in math mode --&gt;</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>\newcommand{\e}{\mathrm{e}}</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regression overview</span></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>Regression overview</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Goal is to determine **if** and **how** one variable is related to a set of other variables.</span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Variables</span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Response variable, denoted $Y$, represents an outcome whose variation is being studied.</span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Explanatory variable, denoted $X$, represents the causes (i.e. potential reasons for variation).</span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Two types of relationships</span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Functional (deterministic) → There is an exact relation between two variables (have the form $y = ax+ b$).</span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Statistical (probabilistic) → There is not an exact relation because there are other variables that affect the relationship (have the form $y = ax + b + \epsilon$).</span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a>Regression models and their uses</span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Statistical models quantify the relationship between a response variable (i.e. a random variable) and explanatory variables, which are usually assumed to be deterministic (i.e. known exactly).</span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Elements of a statistical regression model</span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>In general, observations do not fall directly on the curve of a relationship.</span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$Y \mid X$ has a probability distribution.</span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$E(Y \mid X)$ varies deterministically with $X$.</span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a>        <span class="al">![](files/images/regression-curve.png)</span>{width="50%"}</span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a><span class="in">    -   So the statistical model is:</span></span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a><span class="in">        $$</span></span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a><span class="in">        \begin{align*}</span></span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a><span class="in">          Y &amp;= E(Y \mid X) + \epsilon \\</span></span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a><span class="in">            &amp;= f(X) + \epsilon, \hspace{20pt} \text{where $\epsilon$ has some distribution}</span></span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a><span class="in">        \end{align*}</span></span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a><span class="in">        $$</span></span>
<span id="cb41-85"><a href="#cb41-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-86"><a href="#cb41-86" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Two components of a statistical model:</span>
<span id="cb41-87"><a href="#cb41-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-88"><a href="#cb41-88" aria-hidden="true" tabindex="-1"></a><span class="ss">    1.  </span>$f(X) = E(Y \mid X)$ → Defines relationship between $Y$ and $X$; explains the average behavior of the response.</span>
<span id="cb41-89"><a href="#cb41-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-90"><a href="#cb41-90" aria-hidden="true" tabindex="-1"></a><span class="ss">    2.  </span>$\epsilon$ → An element of randomness (i.e. error). This contains the variation that $f(X)$ cannot explain and/or that is of no interest.</span>
<span id="cb41-91"><a href="#cb41-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-92"><a href="#cb41-92" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This means $f(X) = E(Y \mid X)$ will be the same for all samples with the same $X$ values. The only thing that changes is the random error $\epsilon$ and as a result $Y$. Example $Y = 3 + 1X + \epsilon$:</span>
<span id="cb41-93"><a href="#cb41-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-96"><a href="#cb41-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-97"><a href="#cb41-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-98"><a href="#cb41-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-99"><a href="#cb41-99" aria-hidden="true" tabindex="-1"></a><span class="co"># create regression data frame to show different the deterministic and statistical relationships (assuming SLR normal error model for demonstration so can visualize)</span></span>
<span id="cb41-100"><a href="#cb41-100" aria-hidden="true" tabindex="-1"></a><span class="co"># generate</span></span>
<span id="cb41-101"><a href="#cb41-101" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; X values (not from a random dist)</span></span>
<span id="cb41-102"><a href="#cb41-102" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; f(X) = E(Y | X) = beta_0 + beta_1 X demonstration</span></span>
<span id="cb41-103"><a href="#cb41-103" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; random error = epsilon ~ N(0,1)</span></span>
<span id="cb41-104"><a href="#cb41-104" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; Y = f(X) + epsilon</span></span>
<span id="cb41-105"><a href="#cb41-105" aria-hidden="true" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb41-106"><a href="#cb41-106" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb41-107"><a href="#cb41-107" aria-hidden="true" tabindex="-1"></a>data_ships <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">19</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-108"><a href="#cb41-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_X =</span> beta_0 <span class="sc">+</span> beta_1 <span class="sc">*</span> X,</span>
<span id="cb41-109"><a href="#cb41-109" aria-hidden="true" tabindex="-1"></a>         <span class="at">epsilon =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">nrow</span>(.), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb41-110"><a href="#cb41-110" aria-hidden="true" tabindex="-1"></a>         <span class="at">Y =</span> f_X <span class="sc">+</span> epsilon)</span>
<span id="cb41-111"><a href="#cb41-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-112"><a href="#cb41-112" aria-hidden="true" tabindex="-1"></a><span class="co"># display data</span></span>
<span id="cb41-113"><a href="#cb41-113" aria-hidden="true" tabindex="-1"></a>data_ships <span class="sc">%&gt;%</span> <span class="fu">display_nice</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"f(X) = E(Y | X)"</span>, <span class="st">"$epsilon ~ N(0,1)"</span>, <span class="st">"Y = f(X) + epsilon"</span>))</span>
<span id="cb41-114"><a href="#cb41-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-115"><a href="#cb41-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-116"><a href="#cb41-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-117"><a href="#cb41-117" aria-hidden="true" tabindex="-1"></a><span class="co"># plot (X, Y)</span></span>
<span id="cb41-118"><a href="#cb41-118" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; and add points and line for E(Y | X)</span></span>
<span id="cb41-119"><a href="#cb41-119" aria-hidden="true" tabindex="-1"></a><span class="co"># --&gt; population E(Y | X)) because using known betas (not estimating from sample data)</span></span>
<span id="cb41-120"><a href="#cb41-120" aria-hidden="true" tabindex="-1"></a>data_ships <span class="sc">%$%</span> </span>
<span id="cb41-121"><a href="#cb41-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">main =</span> <span class="st">"Deterministic vs statistical relationship"</span>)</span>
<span id="cb41-122"><a href="#cb41-122" aria-hidden="true" tabindex="-1"></a>data_ships <span class="sc">%$%</span> </span>
<span id="cb41-123"><a href="#cb41-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x =</span> X, <span class="at">y =</span> f_X, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">5</span>)</span>
<span id="cb41-124"><a href="#cb41-124" aria-hidden="true" tabindex="-1"></a>data_ships <span class="sc">%$%</span> </span>
<span id="cb41-125"><a href="#cb41-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x =</span> X, <span class="at">y =</span> f_X, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb41-126"><a href="#cb41-126" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">18.5</span>, <span class="at">y =</span> <span class="dv">20</span>, <span class="at">labels =</span> <span class="st">"f(X) = E(Y|X)"</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb41-127"><a href="#cb41-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-128"><a href="#cb41-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-129"><a href="#cb41-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-130"><a href="#cb41-130" aria-hidden="true" tabindex="-1"></a>Construction of statistical regression models</span>
<span id="cb41-131"><a href="#cb41-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-132"><a href="#cb41-132" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Selection of predictor variables (how to decide which ones?).</span>
<span id="cb41-133"><a href="#cb41-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-134"><a href="#cb41-134" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Use of outside information, historical knowledge, and/or experience.</span>
<span id="cb41-135"><a href="#cb41-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-136"><a href="#cb41-136" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Exploratory data analysis.</span>
<span id="cb41-137"><a href="#cb41-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-138"><a href="#cb41-138" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Variable selection techniques → Find a subset of important variables (i.e. practical and easy to find).</span>
<span id="cb41-139"><a href="#cb41-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-140"><a href="#cb41-140" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Functional form of the regression relation (what is form of $f(X)$?).</span>
<span id="cb41-141"><a href="#cb41-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-142"><a href="#cb41-142" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="sc">\&lt;</span> based on same info as (1) <span class="sc">\&gt;</span></span>
<span id="cb41-143"><a href="#cb41-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-144"><a href="#cb41-144" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If there is an abundance of data, maybe start with more complex models and then simplify.</span>
<span id="cb41-145"><a href="#cb41-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-146"><a href="#cb41-146" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Scope of model (when is the model useful?).</span>
<span id="cb41-147"><a href="#cb41-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-148"><a href="#cb41-148" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>When the model best predicts or describes the relationship between response and predictor variables.</span>
<span id="cb41-149"><a href="#cb41-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-150"><a href="#cb41-150" aria-hidden="true" tabindex="-1"></a>Uses of statistical regression models</span>
<span id="cb41-151"><a href="#cb41-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-152"><a href="#cb41-152" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Determining whether an $X$ "affects" $Y$ or not.</span>
<span id="cb41-153"><a href="#cb41-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-154"><a href="#cb41-154" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Estimation of impact of a given $X$ on the $Y$.</span>
<span id="cb41-155"><a href="#cb41-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-156"><a href="#cb41-156" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Estimation of the mean of $Y$ for a given $X$ value.</span>
<span id="cb41-157"><a href="#cb41-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-158"><a href="#cb41-158" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Prediction of a single value of $Y$ for a given $X$ value.</span>
<span id="cb41-159"><a href="#cb41-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-160"><a href="#cb41-160" aria-hidden="true" tabindex="-1"></a>Typical strategy for regression analysis</span>
<span id="cb41-161"><a href="#cb41-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-162"><a href="#cb41-162" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/regression-flow-chart.png)</span>{width="25%"}</span>
<span id="cb41-163"><a href="#cb41-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-164"><a href="#cb41-164" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simple linear regression model (SLR)</span></span>
<span id="cb41-165"><a href="#cb41-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-166"><a href="#cb41-166" aria-hidden="true" tabindex="-1"></a>Goal of SLR</span>
<span id="cb41-167"><a href="#cb41-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-168"><a href="#cb41-168" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Investigate the relationship between $Y$ and a single numeric independent variable $X$, assuming that, in the population, the mean of $Y$ is linearly related to the value of $X$.</span>
<span id="cb41-169"><a href="#cb41-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-170"><a href="#cb41-170" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Population relationship → $Y = \beta_0 + \beta_1 X + \epsilon$.</span>
<span id="cb41-171"><a href="#cb41-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-172"><a href="#cb41-172" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sample relationship → $\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1 X$.</span>
<span id="cb41-173"><a href="#cb41-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-174"><a href="#cb41-174" aria-hidden="true" tabindex="-1"></a>Data structure</span>
<span id="cb41-175"><a href="#cb41-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-176"><a href="#cb41-176" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Both $X$ and $Y$ on a random sample of $n$ individuals are collected from the population of interest.</span>
<span id="cb41-177"><a href="#cb41-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-178"><a href="#cb41-178" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The resulting data has the form $(X_1, Y_1), \ldots, (X_n, Y_n)$.</span>
<span id="cb41-179"><a href="#cb41-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-180"><a href="#cb41-180" aria-hidden="true" tabindex="-1"></a>Model statement → $Y_i = \beta_0 + \beta_1 X_i + \epsilon_i$</span>
<span id="cb41-181"><a href="#cb41-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-182"><a href="#cb41-182" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Holds for all $n$ values in the random sample of $n$ pairs of values, $(X_i, Y_i), \, i = 1, \ldots, n$.</span>
<span id="cb41-183"><a href="#cb41-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-184"><a href="#cb41-184" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$Y_i$ → Dependent (or response) variable value. These are independent, but not identically distributed.</span>
<span id="cb41-185"><a href="#cb41-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-186"><a href="#cb41-186" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$X_i$ → Independent (or predictor) variable value. These are **not random variables**, rather **known constants**.</span>
<span id="cb41-187"><a href="#cb41-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-188"><a href="#cb41-188" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\epsilon_i$ → Random error term, **assumed** to have mean zero and variance $\sigma^2$. $\mathrm{Cov}(\epsilon_i, \epsilon_j) = \mathrm{Corr}(\epsilon_i, \epsilon_j) = 0$ for all $i,j : i \ne j$. Often, the $\epsilon_i$ are assumed to be independent and identically distributed $(iid)$, i.e. all have the same distribution with the same mean and variance.</span>
<span id="cb41-189"><a href="#cb41-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-190"><a href="#cb41-190" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\beta_0$ and $\beta_1$ → **Fixed** but **unknown** regression parameters that need to be estimated.</span>
<span id="cb41-191"><a href="#cb41-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-192"><a href="#cb41-192" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\sigma^2$ → Another parameter that needs estimated, but it is technically **not** a "regression" parameter since it does not determine the relationship between $Y$ and $X$ (i.e. it only deals with randomness).</span>
<span id="cb41-193"><a href="#cb41-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-194"><a href="#cb41-194" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Note that $Y_i$ and $\epsilon_i$ are random variables and therefore have distributions. Thus, discussing their mean and variances are appropriate.</span>
<span id="cb41-195"><a href="#cb41-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-196"><a href="#cb41-196" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Alternate (equivalent) version of regression model</span>
<span id="cb41-197"><a href="#cb41-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-198"><a href="#cb41-198" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb41-199"><a href="#cb41-199" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results</span></span>
<span id="cb41-200"><a href="#cb41-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-201"><a href="#cb41-201" aria-hidden="true" tabindex="-1"></a>Model statement</span>
<span id="cb41-202"><a href="#cb41-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-203"><a href="#cb41-203" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Can use the deviation $X_i - \bar{X}$ as the predictor instead of $X_i$. This leads to:</span>
<span id="cb41-204"><a href="#cb41-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-205"><a href="#cb41-205" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-206"><a href="#cb41-206" aria-hidden="true" tabindex="-1"></a>Y_i = \beta_0^* + \beta_1 (X_i - \bar{X}) + \epsilon_i, \hspace{20pt} \text{where} \hspace{10pt} \beta_0^* = \beta_0 + \beta_1 \bar{X}</span>
<span id="cb41-207"><a href="#cb41-207" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-208"><a href="#cb41-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-209"><a href="#cb41-209" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This model can be useful in some derivations.</span>
<span id="cb41-210"><a href="#cb41-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-211"><a href="#cb41-211" aria-hidden="true" tabindex="-1"></a>Later results (jumping ahead)</span>
<span id="cb41-212"><a href="#cb41-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-213"><a href="#cb41-213" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Estimated coefficients</span>
<span id="cb41-214"><a href="#cb41-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-215"><a href="#cb41-215" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>LSE for $\beta_1$ is the same as before.</span>
<span id="cb41-216"><a href="#cb41-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-217"><a href="#cb41-217" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Now the LSE for $\beta_0^*$ can be found using $\hat{\beta}_0$ :</span>
<span id="cb41-218"><a href="#cb41-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-219"><a href="#cb41-219" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-220"><a href="#cb41-220" aria-hidden="true" tabindex="-1"></a>\hat{\beta}_0^* = \hat{\beta}_0 + \hat{\beta}_1 \bar{X} = (\bar{Y} - \hat{\beta}_1 \bar{X}) + \hat{\beta}_1 \bar{X} = \bar{Y}</span>
<span id="cb41-221"><a href="#cb41-221" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-222"><a href="#cb41-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-223"><a href="#cb41-223" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Estimated regression function</span>
<span id="cb41-224"><a href="#cb41-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-225"><a href="#cb41-225" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-226"><a href="#cb41-226" aria-hidden="true" tabindex="-1"></a>\hat{Y} = \bar{Y} - \hat{\beta}_1 (X - \bar{X})</span>
<span id="cb41-227"><a href="#cb41-227" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-228"><a href="#cb41-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-229"><a href="#cb41-229" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Property of all regression functions</span>
<span id="cb41-230"><a href="#cb41-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-231"><a href="#cb41-231" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Using this alternative model, it is easy to see that all regression functions pass through the point $(\bar{X}, \bar{Y})$.</span>
<span id="cb41-232"><a href="#cb41-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-233"><a href="#cb41-233" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Derivation</span></span>
<span id="cb41-234"><a href="#cb41-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-235"><a href="#cb41-235" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/alternate-regression-model.png)</span>{width="50%"}</span>
<span id="cb41-236"><a href="#cb41-236" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb41-237"><a href="#cb41-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-238"><a href="#cb41-238" aria-hidden="true" tabindex="-1"></a>Some implications of above</span>
<span id="cb41-239"><a href="#cb41-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-240"><a href="#cb41-240" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb41-241"><a href="#cb41-241" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results</span></span>
<span id="cb41-242"><a href="#cb41-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-243"><a href="#cb41-243" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mean of $Y_i$ for given $X_i$ → $E(Y_i) = \beta_0 + \beta_1 X_i$</span>
<span id="cb41-244"><a href="#cb41-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-245"><a href="#cb41-245" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Variance of $Y_i$ for given $X_i$ → $V(Y_i) = \sigma^2$</span>
<span id="cb41-246"><a href="#cb41-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-247"><a href="#cb41-247" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Derivation</span></span>
<span id="cb41-248"><a href="#cb41-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-249"><a href="#cb41-249" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mean-var-y.png)</span>{width="50%"}</span>
<span id="cb41-250"><a href="#cb41-250" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb41-251"><a href="#cb41-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-252"><a href="#cb41-252" aria-hidden="true" tabindex="-1"></a>Interpretation of regression parameters $(\beta_0, \beta_1)$</span>
<span id="cb41-253"><a href="#cb41-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-254"><a href="#cb41-254" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\beta_0$</span>
<span id="cb41-255"><a href="#cb41-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-256"><a href="#cb41-256" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$Y$-intercept of the regression line and gives $Y$'s mean when $X = 0$ → $E(Y \mid X = 0) = \beta_0 + \beta_1 \cdot 0 = \beta_0$</span>
<span id="cb41-257"><a href="#cb41-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-258"><a href="#cb41-258" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Only makes sense to interpret when $X=0$ is within the scope of the model. So, ask two questions when deciding whether or not to interpret:</span>
<span id="cb41-259"><a href="#cb41-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-260"><a href="#cb41-260" aria-hidden="true" tabindex="-1"></a><span class="ss">        1.  </span>Does it make sense to interpret in context?</span>
<span id="cb41-261"><a href="#cb41-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-262"><a href="#cb41-262" aria-hidden="true" tabindex="-1"></a><span class="ss">        2.  </span>Do we have data in the proximity of zero?</span>
<span id="cb41-263"><a href="#cb41-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-264"><a href="#cb41-264" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If answer "no" to either of these, then no need to interpret the intercept.</span>
<span id="cb41-265"><a href="#cb41-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-266"><a href="#cb41-266" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\beta_1$</span>
<span id="cb41-267"><a href="#cb41-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-268"><a href="#cb41-268" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Slope of the regression line and indicates the change in $Y$'s **mean** when $X$ increases by one unit → $E(Y \mid X = x^* + 1) - E(Y \mid X = x^*) = [\beta_0 + \beta_1 (x^* + 1)] - [\beta_0 + \beta_1 x^*] = \beta_1$</span>
<span id="cb41-269"><a href="#cb41-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-270"><a href="#cb41-270" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Determines whether a relationship exists between $Y$ and $X$.</span>
<span id="cb41-271"><a href="#cb41-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-272"><a href="#cb41-272" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Note that regression **does not** substantiate or prove a **cause-effect** relationship. Rather it gives evidence that $Y$ and $X$ are related (but not that $X$ "causes" the value of $Y$).</span>
<span id="cb41-273"><a href="#cb41-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-274"><a href="#cb41-274" aria-hidden="true" tabindex="-1"></a>Model scope (and the dangers of extrapolation)</span>
<span id="cb41-275"><a href="#cb41-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-276"><a href="#cb41-276" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The structural form of the relationship may not be the same as you move away from the observed predictor space. Therefore, using $\hat{Y}$ for estimation / prediction at $X$ values outside of model scope would be extrapolation and results are not reliable.</span>
<span id="cb41-277"><a href="#cb41-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-278"><a href="#cb41-278" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Should collect data from the entire region of predictor values of research interest.</span>
<span id="cb41-279"><a href="#cb41-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-280"><a href="#cb41-280" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/extrapolation.png)</span>{width="30%"}</span>
<span id="cb41-281"><a href="#cb41-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-282"><a href="#cb41-282" aria-hidden="true" tabindex="-1"></a>Estimators</span>
<span id="cb41-283"><a href="#cb41-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-284"><a href="#cb41-284" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Purpose</span>
<span id="cb41-285"><a href="#cb41-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-286"><a href="#cb41-286" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Estimators help us make inferences about population parameters.</span>
<span id="cb41-287"><a href="#cb41-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-288"><a href="#cb41-288" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Each estimator corresponds to a population parameter (e.g. $\hat{\beta}_1 \rightarrow \beta_1$).</span>
<span id="cb41-289"><a href="#cb41-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-290"><a href="#cb41-290" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Estimator / estimate distinction</span>
<span id="cb41-291"><a href="#cb41-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-292"><a href="#cb41-292" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Estimators are based on formulas (e.g. $\bar{X} = \frac{1}{n} \sum X_i$).</span>
<span id="cb41-293"><a href="#cb41-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-294"><a href="#cb41-294" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Estimates are values computed from estimators.</span>
<span id="cb41-295"><a href="#cb41-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-296"><a href="#cb41-296" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Good estimators</span>
<span id="cb41-297"><a href="#cb41-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-298"><a href="#cb41-298" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Bias** of an estimator is the difference between the estimator's expected value and the true value of the parameter being estimated:</span>
<span id="cb41-299"><a href="#cb41-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-300"><a href="#cb41-300" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If the **bias equals zero**, the estimator is said to be **unbiased**. $$\text{Bias} = E(\hat{\theta}) - \theta$$</span>
<span id="cb41-301"><a href="#cb41-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-302"><a href="#cb41-302" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>e.g. $\bar{X}$ and $\mu$ → $E(\bar{X}) \overset{\surd} = \mu$.</span>
<span id="cb41-303"><a href="#cb41-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-304"><a href="#cb41-304" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Another way to think about it → $E(\bar{X})$ will be the center of the sampling distribution of $\bar{X}$ (which will be approximately normal because of the central limit theorem), and we want this to equal $\mu$.</span>
<span id="cb41-305"><a href="#cb41-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-306"><a href="#cb41-306" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The standard deviation of an estimator is referred to as the **standard error** of said estimator.</span>
<span id="cb41-307"><a href="#cb41-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-308"><a href="#cb41-308" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Ideally, estimators will have relatively small standard deviations, in which case they are said to be **efficient**.</span>
<span id="cb41-309"><a href="#cb41-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-310"><a href="#cb41-310" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimation of the regression function</span></span>
<span id="cb41-311"><a href="#cb41-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-312"><a href="#cb41-312" aria-hidden="true" tabindex="-1"></a>Setup</span>
<span id="cb41-313"><a href="#cb41-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-314"><a href="#cb41-314" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For each point we have an observed value $Y_i$, a fitted value $\hat{Y}_i$ and a residual $\hat{\epsilon}_i$.</span>
<span id="cb41-315"><a href="#cb41-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-316"><a href="#cb41-316" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Fitted regression function → $\hat{Y_i} = \hat{\beta}_0 + \hat{\beta}_1 X_i$, where $\hat{\beta}_0$ and $\hat{\beta}_0$ are estimators of $\beta_0$ and $\beta_1$, respectively.</span>
<span id="cb41-317"><a href="#cb41-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-318"><a href="#cb41-318" aria-hidden="true" tabindex="-1"></a>Goal</span>
<span id="cb41-319"><a href="#cb41-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-320"><a href="#cb41-320" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Goal is to estimate the two "regression" parameters $\beta_0$ and $\beta_1$.</span>
<span id="cb41-321"><a href="#cb41-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-322"><a href="#cb41-322" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There are several methods to do this.</span>
<span id="cb41-323"><a href="#cb41-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-324"><a href="#cb41-324" aria-hidden="true" tabindex="-1"></a><span class="fu">### Method of least squares</span></span>
<span id="cb41-325"><a href="#cb41-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-326"><a href="#cb41-326" aria-hidden="true" tabindex="-1"></a>Overview</span>
<span id="cb41-327"><a href="#cb41-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-328"><a href="#cb41-328" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The method of least squares is one way to find "good" estimators of the regression parameters $\beta_0$ and $\beta_1$.</span>
<span id="cb41-329"><a href="#cb41-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-330"><a href="#cb41-330" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For each observation $(X_i, Y_i)$, this method considers the model error term, which is the deviation of $Y_i$ from its expected value:</span>
<span id="cb41-331"><a href="#cb41-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-332"><a href="#cb41-332" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-333"><a href="#cb41-333" aria-hidden="true" tabindex="-1"></a>\epsilon_i = Y_i - E(Y_i) = Y_i - (\beta_0 + \beta_1 X_i)</span>
<span id="cb41-334"><a href="#cb41-334" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-335"><a href="#cb41-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-336"><a href="#cb41-336" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Then we minimize the sum of some function of these errors:</span>
<span id="cb41-337"><a href="#cb41-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-338"><a href="#cb41-338" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-339"><a href="#cb41-339" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb41-340"><a href="#cb41-340" aria-hidden="true" tabindex="-1"></a>  Q &amp;= \sum_{i = 1}^n \text{function of } \epsilon_i <span class="sc">\\</span></span>
<span id="cb41-341"><a href="#cb41-341" aria-hidden="true" tabindex="-1"></a>    &amp;= \sum_{i = 1}^n \text{function of } \big(Y_i - E(Y_i)\big) <span class="sc">\\</span></span>
<span id="cb41-342"><a href="#cb41-342" aria-hidden="true" tabindex="-1"></a>    &amp;= \sum_{i = 1}^n \text{function of } \big(Y_i - (\beta_0 + \beta_1 X_i)\big) \quad\quad \text{&lt; for SLR &gt;}</span>
<span id="cb41-343"><a href="#cb41-343" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb41-344"><a href="#cb41-344" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-345"><a href="#cb41-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-346"><a href="#cb41-346" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For least squares method specifically, we consider the sum of the $n$ squared errors (deviations). Thus we have:</span>
<span id="cb41-347"><a href="#cb41-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-348"><a href="#cb41-348" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-349"><a href="#cb41-349" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb41-350"><a href="#cb41-350" aria-hidden="true" tabindex="-1"></a>  Q &amp;= \sum_{i = 1}^n \epsilon_i^2 <span class="sc">\\</span></span>
<span id="cb41-351"><a href="#cb41-351" aria-hidden="true" tabindex="-1"></a>    &amp;= \sum_{i = 1}^n (Y_i - \beta_0 - \beta_1 X_i)^2</span>
<span id="cb41-352"><a href="#cb41-352" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb41-353"><a href="#cb41-353" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-354"><a href="#cb41-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-355"><a href="#cb41-355" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- discussion that this is a loss function, squared loss. there are others??? from theory --&gt;</span></span>
<span id="cb41-356"><a href="#cb41-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-357"><a href="#cb41-357" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>According to the method of least squares, the **point estimators** (functions of the random sample that estimate population quantities) of $\beta_0$ and $\beta_1$ are those values $\hat{\beta}_0$ and $\hat{\beta}_1$, respectively, that minimize the criterion $Q$ for the sample observations $(X_1, Y_1), \ldots, (X_n, Y_n)$.</span>
<span id="cb41-358"><a href="#cb41-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-359"><a href="#cb41-359" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Once data is collected, the **estimates** (realized values) for $\hat{\beta}_0$ and $\hat{\beta}_1$ are calculated based on the observed sample $(x_1, y_1), \ldots, (x_n, y_n)$. (Note: no good notation for this, maybe $\hat{b}_0$ and $\hat{b}_1$; similar idea for means: $\mu$, $\bar{X}$ and $\bar{x}$)</span>
<span id="cb41-360"><a href="#cb41-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-361"><a href="#cb41-361" aria-hidden="true" tabindex="-1"></a>Least squares estimators</span>
<span id="cb41-362"><a href="#cb41-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-363"><a href="#cb41-363" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>These can be found in two ways.</span>
<span id="cb41-364"><a href="#cb41-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-365"><a href="#cb41-365" aria-hidden="true" tabindex="-1"></a><span class="ss">    1.  </span>Numerical methods (optimization) → Search procedures to systematically evaluate the least squares criterion $Q$ for different estimates $\hat{\beta}_0$ and $\hat{\beta}_1$ until the ones that minimize $Q$ are found.</span>
<span id="cb41-366"><a href="#cb41-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-367"><a href="#cb41-367" aria-hidden="true" tabindex="-1"></a><span class="ss">    2.  </span>Analytical methods → Using calculus. The analytical approach is feasible when the regression model is not mathematically complex.</span>
<span id="cb41-368"><a href="#cb41-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-369"><a href="#cb41-369" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The general process for deriving the least squares estimators of any model is:</span>
<span id="cb41-370"><a href="#cb41-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-371"><a href="#cb41-371" aria-hidden="true" tabindex="-1"></a><span class="ss">    1.  </span>Write $Q$ as a function of the model error term $\epsilon_i$ as shown above.</span>
<span id="cb41-372"><a href="#cb41-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-373"><a href="#cb41-373" aria-hidden="true" tabindex="-1"></a><span class="ss">    2.  </span>Take derivative with respect to the desired parameter $\beta_i$.</span>
<span id="cb41-374"><a href="#cb41-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-375"><a href="#cb41-375" aria-hidden="true" tabindex="-1"></a><span class="ss">    3.  </span>Set derivative equal to zero (notation: substituting population term $\beta_i$ for its estimator $\hat{\beta}_i$) and solve for $\hat{\beta}_i$.</span>
<span id="cb41-376"><a href="#cb41-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-377"><a href="#cb41-377" aria-hidden="true" tabindex="-1"></a><span class="ss">    4.  </span>Check second derivative test to ensure global minimum (take derivative from result of step 2)</span>
<span id="cb41-378"><a href="#cb41-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-379"><a href="#cb41-379" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Using the analytical approach with the SLR model, we have the following results:</span>
<span id="cb41-380"><a href="#cb41-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-381"><a href="#cb41-381" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb41-382"><a href="#cb41-382" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results</span></span>
<span id="cb41-383"><a href="#cb41-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-384"><a href="#cb41-384" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The estimators $\hat{\beta}_0$ and $\hat{\beta}_1$ are found by solving the simultaneous equations (called the **normal equations**):</span>
<span id="cb41-385"><a href="#cb41-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-386"><a href="#cb41-386" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-387"><a href="#cb41-387" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb41-388"><a href="#cb41-388" aria-hidden="true" tabindex="-1"></a>  \sum Y_i n &amp;= \hat{\beta}_0 + \hat{\beta}_1 \sum X_i <span class="sc">\\</span></span>
<span id="cb41-389"><a href="#cb41-389" aria-hidden="true" tabindex="-1"></a>  \sum X_i Y_i &amp;= \hat{\beta}_0 \sum X_i + \hat{\beta}_1 \sum X_i^2</span>
<span id="cb41-390"><a href="#cb41-390" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb41-391"><a href="#cb41-391" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-392"><a href="#cb41-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-393"><a href="#cb41-393" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This leads to</span>
<span id="cb41-394"><a href="#cb41-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-395"><a href="#cb41-395" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-396"><a href="#cb41-396" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb41-397"><a href="#cb41-397" aria-hidden="true" tabindex="-1"></a>  \text{Intercept} \hspace{10pt} \hat{\beta}_0 \hspace{10pt} &amp;= \hspace{10pt} \frac{1}{n}\sum Y_i + \hat{\beta}_1 \frac{1}{n} \sum X_i \hspace{10pt} = \hspace{10pt} \bar{Y}- \hat{\beta}_1 \bar{X} <span class="sc">\\</span></span>
<span id="cb41-398"><a href="#cb41-398" aria-hidden="true" tabindex="-1"></a>  \text{Slope} \hspace{10pt} \hat{\beta_1} \hspace{10pt} &amp;= \hspace{10pt} \frac{\sum X_i Y_i -\frac{1}{n} \sum X_i Y_i}{\sum X_i^2 - \frac{1}{n}(\sum X_i)^2} \hspace{10pt} = \hspace{10pt} \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2} \hspace{10pt} = \hspace{10pt} \frac{S_{XY}}{S_{XX}}</span>
<span id="cb41-399"><a href="#cb41-399" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb41-400"><a href="#cb41-400" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-401"><a href="#cb41-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-402"><a href="#cb41-402" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Note: We did not have to assume any distribution of the error term. These are the LSE estimators for any SLR model.</span>
<span id="cb41-403"><a href="#cb41-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-404"><a href="#cb41-404" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Derivation</span></span>
<span id="cb41-405"><a href="#cb41-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-406"><a href="#cb41-406" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/slr-lse-derivation.png)</span>{width="100%"}</span>
<span id="cb41-407"><a href="#cb41-407" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb41-408"><a href="#cb41-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-409"><a href="#cb41-409" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Demo:</span>
<span id="cb41-410"><a href="#cb41-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-411"><a href="#cb41-411" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>First we can generate the sample data $(x_1, y_1), \ldots, (x_n, y_n)$.</span>
<span id="cb41-412"><a href="#cb41-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-415"><a href="#cb41-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-416"><a href="#cb41-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-417"><a href="#cb41-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-418"><a href="#cb41-418" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate sample regression dataset from population model</span></span>
<span id="cb41-419"><a href="#cb41-419" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; E ~ Uniform(a, b)</span></span>
<span id="cb41-420"><a href="#cb41-420" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; Y = B0 + B1X + E</span></span>
<span id="cb41-421"><a href="#cb41-421" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; Y | X ~ Uniform(B0 + B1*X - a, B0 + B1*X + b)</span></span>
<span id="cb41-422"><a href="#cb41-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-423"><a href="#cb41-423" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize items</span></span>
<span id="cb41-424"><a href="#cb41-424" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; sample size, population parameters and error distribution parameters</span></span>
<span id="cb41-425"><a href="#cb41-425" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb41-426"><a href="#cb41-426" aria-hidden="true" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb41-427"><a href="#cb41-427" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb41-428"><a href="#cb41-428" aria-hidden="true" tabindex="-1"></a>min <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb41-429"><a href="#cb41-429" aria-hidden="true" tabindex="-1"></a>max <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb41-430"><a href="#cb41-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-431"><a href="#cb41-431" aria-hidden="true" tabindex="-1"></a><span class="co"># generate X values</span></span>
<span id="cb41-432"><a href="#cb41-432" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> n, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb41-433"><a href="#cb41-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-434"><a href="#cb41-434" aria-hidden="true" tabindex="-1"></a><span class="co"># generate error terms</span></span>
<span id="cb41-435"><a href="#cb41-435" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; assumption for LSE is E(epsilon) = 0, so symmetric uniform about zero works</span></span>
<span id="cb41-436"><a href="#cb41-436" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> n, <span class="at">min =</span> min, <span class="at">max =</span> max)</span>
<span id="cb41-437"><a href="#cb41-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-438"><a href="#cb41-438" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate y terms as function of x and error terms</span></span>
<span id="cb41-439"><a href="#cb41-439" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> beta_0 <span class="sc">+</span> beta_1 <span class="sc">*</span> x <span class="sc">+</span> epsilon</span>
<span id="cb41-440"><a href="#cb41-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-441"><a href="#cb41-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-442"><a href="#cb41-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-445"><a href="#cb41-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-446"><a href="#cb41-446" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-447"><a href="#cb41-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-448"><a href="#cb41-448" aria-hidden="true" tabindex="-1"></a><span class="co"># display observed sample data</span></span>
<span id="cb41-449"><a href="#cb41-449" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(x, y) <span class="sc">%&gt;%</span> </span>
<span id="cb41-450"><a href="#cb41-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-451"><a href="#cb41-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display_nice</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>))</span>
<span id="cb41-452"><a href="#cb41-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-453"><a href="#cb41-453" aria-hidden="true" tabindex="-1"></a><span class="co"># plot sample data</span></span>
<span id="cb41-454"><a href="#cb41-454" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb41-455"><a href="#cb41-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-456"><a href="#cb41-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-457"><a href="#cb41-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-458"><a href="#cb41-458" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Then we can fit the model and visualize it on the scatter plot.</span>
<span id="cb41-459"><a href="#cb41-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-462"><a href="#cb41-462" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-463"><a href="#cb41-463" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-464"><a href="#cb41-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-465"><a href="#cb41-465" aria-hidden="true" tabindex="-1"></a><span class="co"># add regression line to plot</span></span>
<span id="cb41-466"><a href="#cb41-466" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb41-467"><a href="#cb41-467" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb41-468"><a href="#cb41-468" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">14</span>, <span class="at">y =</span> <span class="dv">22</span>, <span class="at">labels =</span> <span class="fu">bquote</span>(<span class="fu">hat</span>(Y) <span class="sc">*</span> <span class="st">" = "</span> <span class="sc">*</span> <span class="fu">hat</span>(beta)[<span class="dv">0</span>] <span class="sc">+</span> <span class="fu">hat</span>(beta)[<span class="dv">1</span>] <span class="sc">*</span> <span class="st">"X"</span>) , <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb41-469"><a href="#cb41-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-470"><a href="#cb41-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-471"><a href="#cb41-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-472"><a href="#cb41-472" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Finally we can get the estimates of $\hat{\beta}_0$ and $\hat{\beta}_1$.</span>
<span id="cb41-473"><a href="#cb41-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-474"><a href="#cb41-474" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb41-475"><a href="#cb41-475" aria-hidden="true" tabindex="-1"></a><span class="fu">#### R Functions</span></span>
<span id="cb41-476"><a href="#cb41-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-479"><a href="#cb41-479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-480"><a href="#cb41-480" aria-hidden="true" tabindex="-1"></a><span class="co"># fit SLR model</span></span>
<span id="cb41-481"><a href="#cb41-481" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; lm() calls lm.fit() behind the scenes --&gt; this performs a QR decomposition to fit the model, which is a more stable way to solve for LSE</span></span>
<span id="cb41-482"><a href="#cb41-482" aria-hidden="true" tabindex="-1"></a>mod_slr <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x)</span>
<span id="cb41-483"><a href="#cb41-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-484"><a href="#cb41-484" aria-hidden="true" tabindex="-1"></a><span class="co"># display estimated coefficients</span></span>
<span id="cb41-485"><a href="#cb41-485" aria-hidden="true" tabindex="-1"></a>mod_slr<span class="sc">$</span>coefficients</span>
<span id="cb41-486"><a href="#cb41-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-487"><a href="#cb41-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-488"><a href="#cb41-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-491"><a href="#cb41-491" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-492"><a href="#cb41-492" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval = FALSE</span></span>
<span id="cb41-493"><a href="#cb41-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-494"><a href="#cb41-494" aria-hidden="true" tabindex="-1"></a><span class="co"># or can do</span></span>
<span id="cb41-495"><a href="#cb41-495" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(mod_slr)</span>
<span id="cb41-496"><a href="#cb41-496" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod_slr) <span class="co"># alias for coefficients()</span></span>
<span id="cb41-497"><a href="#cb41-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-498"><a href="#cb41-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-499"><a href="#cb41-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-500"><a href="#cb41-500" aria-hidden="true" tabindex="-1"></a>These are estimates of the population coefficients, so can compare above values to $\beta_0$ = <span class="in">`r beta_0`</span> and $\beta_1$ = <span class="in">`r beta_1`</span>.</span>
<span id="cb41-501"><a href="#cb41-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-502"><a href="#cb41-502" aria-hidden="true" tabindex="-1"></a>&lt;mark&gt;**Programming note → Beautiful sites ([(1)](https://genomicsclass.github.io/book/pages/qr_and_regression.html) and [(2)](https://machinelearningmastery.com/solve-linear-regression-using-linear-algebra/#:~:text=The%20QR%20decomposition%20is%20an,down%20into%20its%20constituent%20elements.&amp;text=Where%20A%20is%20the%20matrix,the%20linear%20least%20squares%20equation.)) explaining QR decomposition and how it relates to LSE; must go through and recreate at some point.**&lt;/mark&gt;</span>
<span id="cb41-503"><a href="#cb41-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-504"><a href="#cb41-504" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Manual</span></span>
<span id="cb41-505"><a href="#cb41-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-508"><a href="#cb41-508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-509"><a href="#cb41-509" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate estimates for B0 and B1 using LSE formulas</span></span>
<span id="cb41-510"><a href="#cb41-510" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; b_1 = S_XY / S_XX</span></span>
<span id="cb41-511"><a href="#cb41-511" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; b_0 = Y-bar - b_1 X-bar</span></span>
<span id="cb41-512"><a href="#cb41-512" aria-hidden="true" tabindex="-1"></a>s_xy <span class="ot">&lt;-</span> <span class="fu">sum</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x)) <span class="sc">*</span> (y <span class="sc">-</span> <span class="fu">mean</span>(y)))</span>
<span id="cb41-513"><a href="#cb41-513" aria-hidden="true" tabindex="-1"></a>s_xx <span class="ot">&lt;-</span> <span class="fu">sum</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb41-514"><a href="#cb41-514" aria-hidden="true" tabindex="-1"></a>b_1 <span class="ot">&lt;-</span> s_xy <span class="sc">/</span> s_xx</span>
<span id="cb41-515"><a href="#cb41-515" aria-hidden="true" tabindex="-1"></a>b_0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) <span class="sc">-</span> b_1 <span class="sc">*</span> <span class="fu">mean</span>(x)</span>
<span id="cb41-516"><a href="#cb41-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-517"><a href="#cb41-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-518"><a href="#cb41-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-521"><a href="#cb41-521" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-522"><a href="#cb41-522" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-523"><a href="#cb41-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-524"><a href="#cb41-524" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to results from lm()</span></span>
<span id="cb41-525"><a href="#cb41-525" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="fu">c</span>(b_0, b_1), mod_slr<span class="sc">$</span>coefficients)</span>
<span id="cb41-526"><a href="#cb41-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-527"><a href="#cb41-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-528"><a href="#cb41-528" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb41-529"><a href="#cb41-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-530"><a href="#cb41-530" aria-hidden="true" tabindex="-1"></a>LSE for other models</span>
<span id="cb41-531"><a href="#cb41-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-532"><a href="#cb41-532" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Can also derive LSE estimators for other models using the same process.</span>
<span id="cb41-533"><a href="#cb41-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-534"><a href="#cb41-534" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Example 1</span>
<span id="cb41-535"><a href="#cb41-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-536"><a href="#cb41-536" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Regression through the origin: $Y = \beta X + \epsilon$.</span>
<span id="cb41-537"><a href="#cb41-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-538"><a href="#cb41-538" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb41-539"><a href="#cb41-539" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup and Derivation</span></span>
<span id="cb41-540"><a href="#cb41-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-543"><a href="#cb41-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-544"><a href="#cb41-544" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-545"><a href="#cb41-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-546"><a href="#cb41-546" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate sample regression through the origin dataset from population model</span></span>
<span id="cb41-547"><a href="#cb41-547" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; E ~ Uniform(a, b)</span></span>
<span id="cb41-548"><a href="#cb41-548" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; Y = BX + E</span></span>
<span id="cb41-549"><a href="#cb41-549" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; Y | X ~ Uniform(B*X + a, B*X + b)</span></span>
<span id="cb41-550"><a href="#cb41-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-551"><a href="#cb41-551" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize items</span></span>
<span id="cb41-552"><a href="#cb41-552" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; sample size, population parameters and error distribution parameters</span></span>
<span id="cb41-553"><a href="#cb41-553" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb41-554"><a href="#cb41-554" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb41-555"><a href="#cb41-555" aria-hidden="true" tabindex="-1"></a>min <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb41-556"><a href="#cb41-556" aria-hidden="true" tabindex="-1"></a>max <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb41-557"><a href="#cb41-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-558"><a href="#cb41-558" aria-hidden="true" tabindex="-1"></a><span class="co"># generate X values</span></span>
<span id="cb41-559"><a href="#cb41-559" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> n, <span class="at">min =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">max =</span> <span class="dv">5</span>)</span>
<span id="cb41-560"><a href="#cb41-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-561"><a href="#cb41-561" aria-hidden="true" tabindex="-1"></a><span class="co"># Y | X ~ Uniform(min = BX + a, max = BX + b)</span></span>
<span id="cb41-562"><a href="#cb41-562" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> n, <span class="at">min =</span> beta <span class="sc">*</span> x <span class="sc">+</span> min, <span class="at">max =</span> beta <span class="sc">*</span> x <span class="sc">+</span> max)</span>
<span id="cb41-563"><a href="#cb41-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-564"><a href="#cb41-564" aria-hidden="true" tabindex="-1"></a><span class="co"># plot sample data</span></span>
<span id="cb41-565"><a href="#cb41-565" aria-hidden="true" tabindex="-1"></a><span class="co"># add regression line to plot and reference line for origin</span></span>
<span id="cb41-566"><a href="#cb41-566" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb41-567"><a href="#cb41-567" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">-</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb41-568"><a href="#cb41-568" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"lightgrey"</span>)</span>
<span id="cb41-569"><a href="#cb41-569" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"lightgrey"</span>)</span>
<span id="cb41-570"><a href="#cb41-570" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">labels =</span> <span class="fu">bquote</span>(<span class="fu">hat</span>(Y) <span class="sc">*</span> <span class="st">" = "</span> <span class="sc">*</span> <span class="fu">hat</span>(beta) <span class="sc">*</span> <span class="st">"X"</span>) , <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb41-571"><a href="#cb41-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-572"><a href="#cb41-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-573"><a href="#cb41-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-574"><a href="#cb41-574" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Derivation of estimator:</span>
<span id="cb41-575"><a href="#cb41-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-576"><a href="#cb41-576" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/slr-lse-derivation-origin.png)</span>{width="40%"}</span>
<span id="cb41-577"><a href="#cb41-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-578"><a href="#cb41-578" aria-hidden="true" tabindex="-1"></a><span class="fu">#### R Functions</span></span>
<span id="cb41-579"><a href="#cb41-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-582"><a href="#cb41-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-583"><a href="#cb41-583" aria-hidden="true" tabindex="-1"></a><span class="co"># fit SLR model without intercept</span></span>
<span id="cb41-584"><a href="#cb41-584" aria-hidden="true" tabindex="-1"></a>mod_noint <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> x)</span>
<span id="cb41-585"><a href="#cb41-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-586"><a href="#cb41-586" aria-hidden="true" tabindex="-1"></a><span class="co"># display estimated coefficient</span></span>
<span id="cb41-587"><a href="#cb41-587" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(mod_noint)</span>
<span id="cb41-588"><a href="#cb41-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-589"><a href="#cb41-589" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-590"><a href="#cb41-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-591"><a href="#cb41-591" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Manual</span></span>
<span id="cb41-592"><a href="#cb41-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-595"><a href="#cb41-595" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-596"><a href="#cb41-596" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate estimate B using LSE formula</span></span>
<span id="cb41-597"><a href="#cb41-597" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">*</span> y) <span class="sc">/</span> <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb41-598"><a href="#cb41-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-599"><a href="#cb41-599" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-600"><a href="#cb41-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-603"><a href="#cb41-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-604"><a href="#cb41-604" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-605"><a href="#cb41-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-606"><a href="#cb41-606" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to results from lm()</span></span>
<span id="cb41-607"><a href="#cb41-607" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(b, <span class="fu">coefficients</span>(mod_noint))</span>
<span id="cb41-608"><a href="#cb41-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-609"><a href="#cb41-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-610"><a href="#cb41-610" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb41-611"><a href="#cb41-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-612"><a href="#cb41-612" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Example 2</span>
<span id="cb41-613"><a href="#cb41-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-614"><a href="#cb41-614" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Regression through the origin with squared predictor variable: $Y = \beta_1 X^2 + \epsilon$.</span>
<span id="cb41-615"><a href="#cb41-615" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-616"><a href="#cb41-616" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Sometimes a transformation can make deriving estimators easier. This way we can get the model in a familiar form and derive like usual (simpler). Then we just have to make the appropriate substitutions at the end in order to get the estimators for the original models.</span>
<span id="cb41-617"><a href="#cb41-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-618"><a href="#cb41-618" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>This strategy lessens the number of models we have to know how to derive (note this is just for deriving; no need to do it when fitting models because it's an extra middle step that doesn't change anything, leads to equivalent results).</span>
<span id="cb41-619"><a href="#cb41-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-620"><a href="#cb41-620" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb41-621"><a href="#cb41-621" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setup and Derivation</span></span>
<span id="cb41-622"><a href="#cb41-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-625"><a href="#cb41-625" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-626"><a href="#cb41-626" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-627"><a href="#cb41-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-628"><a href="#cb41-628" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate sample regression through the origin with squared predictor dataset from population model</span></span>
<span id="cb41-629"><a href="#cb41-629" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; E ~ Uniform(a, b)</span></span>
<span id="cb41-630"><a href="#cb41-630" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; Y = BX + E</span></span>
<span id="cb41-631"><a href="#cb41-631" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; Y | X ~ Uniform(B*X^2 + a, B*X^2 + b)</span></span>
<span id="cb41-632"><a href="#cb41-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-633"><a href="#cb41-633" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize items</span></span>
<span id="cb41-634"><a href="#cb41-634" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; sample size, population parameters and error distribution parameters</span></span>
<span id="cb41-635"><a href="#cb41-635" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb41-636"><a href="#cb41-636" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb41-637"><a href="#cb41-637" aria-hidden="true" tabindex="-1"></a>min <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb41-638"><a href="#cb41-638" aria-hidden="true" tabindex="-1"></a>max <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb41-639"><a href="#cb41-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-640"><a href="#cb41-640" aria-hidden="true" tabindex="-1"></a><span class="co"># generate X values</span></span>
<span id="cb41-641"><a href="#cb41-641" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> n, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">5</span>)</span>
<span id="cb41-642"><a href="#cb41-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-643"><a href="#cb41-643" aria-hidden="true" tabindex="-1"></a><span class="co"># Y | X ~ Uniform(min = BX^2 + a, max = BX^2 + b)</span></span>
<span id="cb41-644"><a href="#cb41-644" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> n, <span class="at">min =</span> beta <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> min, <span class="at">max =</span> beta <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> max)</span>
<span id="cb41-645"><a href="#cb41-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-646"><a href="#cb41-646" aria-hidden="true" tabindex="-1"></a><span class="co"># plot sample data</span></span>
<span id="cb41-647"><a href="#cb41-647" aria-hidden="true" tabindex="-1"></a><span class="co"># add regression line to plot and reference line for origin</span></span>
<span id="cb41-648"><a href="#cb41-648" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb41-649"><a href="#cb41-649" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">-</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb41-650"><a href="#cb41-650" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"lightgrey"</span>)</span>
<span id="cb41-651"><a href="#cb41-651" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"lightgrey"</span>)</span>
<span id="cb41-652"><a href="#cb41-652" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="dv">15</span>, <span class="at">labels =</span> <span class="fu">bquote</span>(<span class="fu">hat</span>(Y) <span class="sc">*</span> <span class="st">" = "</span> <span class="sc">*</span> <span class="fu">hat</span>(beta) <span class="sc">*</span> X<span class="sc">^</span><span class="dv">2</span>) , <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb41-653"><a href="#cb41-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-654"><a href="#cb41-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-655"><a href="#cb41-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-656"><a href="#cb41-656" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Derivation of estimator:</span>
<span id="cb41-657"><a href="#cb41-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-658"><a href="#cb41-658" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/slr-lse-derivation-origin-squared.png)</span>{width="90%"}</span>
<span id="cb41-659"><a href="#cb41-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-660"><a href="#cb41-660" aria-hidden="true" tabindex="-1"></a><span class="fu">#### R Functions</span></span>
<span id="cb41-661"><a href="#cb41-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-664"><a href="#cb41-664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-665"><a href="#cb41-665" aria-hidden="true" tabindex="-1"></a><span class="co"># fit SLR model with no intercept and squared X</span></span>
<span id="cb41-666"><a href="#cb41-666" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; use asis function I() to treat `^` as an arithmetic operator and not a formula operator</span></span>
<span id="cb41-667"><a href="#cb41-667" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; save design matrix for later demo</span></span>
<span id="cb41-668"><a href="#cb41-668" aria-hidden="true" tabindex="-1"></a>mod_noint_squared <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-669"><a href="#cb41-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-670"><a href="#cb41-670" aria-hidden="true" tabindex="-1"></a><span class="co"># display estimated coefficient</span></span>
<span id="cb41-671"><a href="#cb41-671" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod_noint_squared)</span>
<span id="cb41-672"><a href="#cb41-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-673"><a href="#cb41-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-674"><a href="#cb41-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-675"><a href="#cb41-675" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Manual</span></span>
<span id="cb41-676"><a href="#cb41-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-679"><a href="#cb41-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-680"><a href="#cb41-680" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate estimates B using LSE formula</span></span>
<span id="cb41-681"><a href="#cb41-681" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> y) <span class="sc">/</span> <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb41-682"><a href="#cb41-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-683"><a href="#cb41-683" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-684"><a href="#cb41-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-687"><a href="#cb41-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-688"><a href="#cb41-688" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-689"><a href="#cb41-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-690"><a href="#cb41-690" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to results from lm()</span></span>
<span id="cb41-691"><a href="#cb41-691" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(b, <span class="fu">coef</span>(mod_noint_squared))</span>
<span id="cb41-692"><a href="#cb41-692" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-693"><a href="#cb41-693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-694"><a href="#cb41-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-697"><a href="#cb41-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-698"><a href="#cb41-698" aria-hidden="true" tabindex="-1"></a><span class="co"># demonstrating that transformed model way is equivalent</span></span>
<span id="cb41-699"><a href="#cb41-699" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; square predictor variable</span></span>
<span id="cb41-700"><a href="#cb41-700" aria-hidden="true" tabindex="-1"></a>x_star <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb41-701"><a href="#cb41-701" aria-hidden="true" tabindex="-1"></a>mod_transformed <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span>  x_star, <span class="at">x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-702"><a href="#cb41-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-703"><a href="#cb41-703" aria-hidden="true" tabindex="-1"></a><span class="co"># compare design matrices of two models</span></span>
<span id="cb41-704"><a href="#cb41-704" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="fu">head</span>(mod_noint_squared<span class="sc">$</span>x), <span class="fu">head</span>(mod_transformed<span class="sc">$</span>x))</span>
<span id="cb41-705"><a href="#cb41-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-706"><a href="#cb41-706" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate estimates B using LSE formula</span></span>
<span id="cb41-707"><a href="#cb41-707" aria-hidden="true" tabindex="-1"></a>b_star <span class="ot">&lt;-</span> <span class="fu">sum</span>(x_star <span class="sc">*</span> y) <span class="sc">/</span> <span class="fu">sum</span>(x_star<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb41-708"><a href="#cb41-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-709"><a href="#cb41-709" aria-hidden="true" tabindex="-1"></a><span class="co"># compare betas from usual method and transformed model way</span></span>
<span id="cb41-710"><a href="#cb41-710" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(b, b_star)</span>
<span id="cb41-711"><a href="#cb41-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-712"><a href="#cb41-712" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-713"><a href="#cb41-713" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb41-714"><a href="#cb41-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-715"><a href="#cb41-715" aria-hidden="true" tabindex="-1"></a>Properties of least squares estimators</span>
<span id="cb41-716"><a href="#cb41-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-717"><a href="#cb41-717" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Gauss-Markov theorem**: If the conditions of the SLR model hold (i.e. $Y_i= \beta_0 + \beta_1 X_i + \epsilon_i$, where $\epsilon_i$ have mean zero, variance $\sigma^2$ and are uncorrelated), then the LSE $\hat{\beta}_0$ and $\hat{\beta}_1$ are the **Best Linear Unbiased Estimators (BLUE)** (note that $\epsilon_i$ do not have to be normal).</span>
<span id="cb41-718"><a href="#cb41-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-719"><a href="#cb41-719" aria-hidden="true" tabindex="-1"></a><span class="ss">    1.  </span>Linear estimators → Through lots of algebra (shown later), $\hat{\beta_0}$ and $\hat{\beta}_1$ can be written as be written as a linear combination of the $Y_i$: $\sum k_i Y_i$, where $k_i$ are constant. Thus they are linear estimators.</span>
<span id="cb41-720"><a href="#cb41-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-721"><a href="#cb41-721" aria-hidden="true" tabindex="-1"></a><span class="ss">    2.  </span>Unbiased estimators → Their expected values are $\beta_0$ and $\beta_1$, respectively. So neither estimator tends to overestimate or underestimate systematically.</span>
<span id="cb41-722"><a href="#cb41-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-723"><a href="#cb41-723" aria-hidden="true" tabindex="-1"></a><span class="ss">    3.  </span>Best → More precise than *all other linear unbiased estimators of* $\beta_0$ and $\beta_1$ (smaller variance of the sampling distributions).</span>
<span id="cb41-724"><a href="#cb41-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-725"><a href="#cb41-725" aria-hidden="true" tabindex="-1"></a><span class="fu">### Point estimation of the mean response</span></span>
<span id="cb41-726"><a href="#cb41-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-727"><a href="#cb41-727" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For the population relationship $Y = \beta_0 + \beta_1 X + \epsilon$, we have the regression function $E(Y) = \beta_0 + \beta_1 X$ (because $E(\epsilon) = 0$). This is estimated with $\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1 X$.</span>
<span id="cb41-728"><a href="#cb41-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-729"><a href="#cb41-729" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Terms and what they represent:</span>
<span id="cb41-730"><a href="#cb41-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-731"><a href="#cb41-731" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$Y$ is a value of the response variable; the observed value.</span>
<span id="cb41-732"><a href="#cb41-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-733"><a href="#cb41-733" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$E(Y)$ the mean response. So it is the center of the probability distribution of $Y$ corresponding to the level $X$ of the predictor variable (so technically a conditional expected value $E(Y \mid X)$.</span>
<span id="cb41-734"><a href="#cb41-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-735"><a href="#cb41-735" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\hat{Y}$ is a point estimator of the mean response when the level of the predictor variable is $X$; the fitted value.</span>
<span id="cb41-736"><a href="#cb41-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-737"><a href="#cb41-737" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Application of Gauss-Markov theorem</span>
<span id="cb41-738"><a href="#cb41-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-739"><a href="#cb41-739" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\hat{Y}$ is the BLUE for $E(Y)$ with $V(\hat{Y}) = V(\epsilon) = \sigma^2$.</span>
<span id="cb41-740"><a href="#cb41-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-741"><a href="#cb41-741" aria-hidden="true" tabindex="-1"></a><span class="fu">### Residuals and model errors</span></span>
<span id="cb41-742"><a href="#cb41-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-743"><a href="#cb41-743" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model error term $\epsilon_i = Y_i - E(Y_i) = Y_i - (\beta_0 + \beta_1 X_i)$ → Measures the difference between an observation and its expected value (unknown true regression line). It is unknown / unobservable.</span>
<span id="cb41-744"><a href="#cb41-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-745"><a href="#cb41-745" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Residual $\hat{\epsilon}_i = e_i = Y_i - \hat{Y}_i$ → This is a known, observable estimate of the unobservable model error. Measures the deviation of the observed value from the fitted regression function.</span>
<span id="cb41-746"><a href="#cb41-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-747"><a href="#cb41-747" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/residual.png)</span>{width="40%"}</span>
<span id="cb41-748"><a href="#cb41-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-749"><a href="#cb41-749" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Residuals are very useful for studying whether the given regression model is appropriate for the data.</span>
<span id="cb41-750"><a href="#cb41-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-751"><a href="#cb41-751" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- - &lt;mark&gt; Independence &lt;/mark&gt; &amp;rarr;  Because of how are models are constructed   the sum of the residuals is necessarily zero, and thus the residuals are necessarily not independent. However, the model errors are independent (by assumption), and their is almost surely not zero (???? but we expect them to balance out, expected value equal to zero). --&gt;</span></span>
<span id="cb41-752"><a href="#cb41-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-753"><a href="#cb41-753" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Properties of fitted regression line: PAGE 23, gives 6 properties, could demonstrate if wanted, not sure why these are useful to know --&gt;</span></span>
<span id="cb41-754"><a href="#cb41-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-755"><a href="#cb41-755" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimation of error terms variance</span></span>
<span id="cb41-756"><a href="#cb41-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-757"><a href="#cb41-757" aria-hidden="true" tabindex="-1"></a>Need to estimate the variance $\sigma^2$ of the error terms $\epsilon_i$ in a regression model to get an indication of the variability of the probability distributions of $Y$. Also several inferences for models require an estimate of $\sigma^2$.</span>
<span id="cb41-758"><a href="#cb41-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-759"><a href="#cb41-759" aria-hidden="true" tabindex="-1"></a>Motivation</span>
<span id="cb41-760"><a href="#cb41-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-761"><a href="#cb41-761" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For a single population, the variance $\sigma^2$ is estimated by the sample variance $S^2$, which is an unbiased estimator. We find $S^2$ by taking the sum of the squared deviations of the observed value and the estimated mean (sum of squares) and then dividing it by the degrees of freedom $n - 1$ (one df is lost when estimating $\mu$; mean square) .</span>
<span id="cb41-762"><a href="#cb41-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-763"><a href="#cb41-763" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-764"><a href="#cb41-764" aria-hidden="true" tabindex="-1"></a>S^2 = \frac{\sum_{i = 1}^n (Y_i - \bar{Y})^2}{n - 1}</span>
<span id="cb41-765"><a href="#cb41-765" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-766"><a href="#cb41-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-767"><a href="#cb41-767" aria-hidden="true" tabindex="-1"></a>Regression model</span>
<span id="cb41-768"><a href="#cb41-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-769"><a href="#cb41-769" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Same logic as above, except we use the residuals as the deviations because each $Y_i$ comes from a different probability distribution with different $X$ (depends on the $X_i$ level).</span>
<span id="cb41-770"><a href="#cb41-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-771"><a href="#cb41-771" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-772"><a href="#cb41-772" aria-hidden="true" tabindex="-1"></a>\text{Error (residual) sum of squares} \hspace{10pt} SSE = \sum_{i = 1}^n (Y_i - \hat{Y_i})^2 = \sum_{i = 1}^n e_i^2</span>
<span id="cb41-773"><a href="#cb41-773" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-774"><a href="#cb41-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-775"><a href="#cb41-775" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Then divide by the $df = n - 2$ to the mean square (two dfs are lost when because $\beta_0$ and $\beta_1$ need to be estimated when getting the estimated means $\hat{Y_i}$).</span>
<span id="cb41-776"><a href="#cb41-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-777"><a href="#cb41-777" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-778"><a href="#cb41-778" aria-hidden="true" tabindex="-1"></a>\text{Error (residual) mean square} \hspace{10pt} S^2 = MSE = \frac{SSE}{n - 2} = \frac{\sum_{i = 1}^n (Y_i - \hat{Y_i})^2}{n - 2} = \frac{\sum_{i = 1}^n e_i^2}{n - 2}</span>
<span id="cb41-779"><a href="#cb41-779" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-780"><a href="#cb41-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-781"><a href="#cb41-781" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>It will be shown later that $MSE$ is an unbiased estimator for $\sigma^2$ → $E(MSE) = \sigma^2$.</span>
<span id="cb41-782"><a href="#cb41-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-783"><a href="#cb41-783" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>An estimator of the standard deviation is simply $S = \sqrt{MSE}$.</span>
<span id="cb41-784"><a href="#cb41-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-785"><a href="#cb41-785" aria-hidden="true" tabindex="-1"></a>Demo</span>
<span id="cb41-786"><a href="#cb41-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-787"><a href="#cb41-787" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb41-788"><a href="#cb41-788" aria-hidden="true" tabindex="-1"></a><span class="fu">#### R functions</span></span>
<span id="cb41-789"><a href="#cb41-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-792"><a href="#cb41-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-793"><a href="#cb41-793" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate dataset (using uniform errors)</span></span>
<span id="cb41-794"><a href="#cb41-794" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize items, generate X values, errors and y values</span></span>
<span id="cb41-795"><a href="#cb41-795" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span>; beta_0 <span class="ot">&lt;-</span> <span class="dv">1</span>; beta_1 <span class="ot">&lt;-</span> <span class="dv">2</span>; min <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span>; max <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb41-796"><a href="#cb41-796" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> n, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb41-797"><a href="#cb41-797" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> n, <span class="at">min =</span> min, <span class="at">max =</span> max)</span>
<span id="cb41-798"><a href="#cb41-798" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> beta_0 <span class="sc">+</span> beta_1 <span class="sc">*</span> x <span class="sc">+</span> epsilon</span>
<span id="cb41-799"><a href="#cb41-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-800"><a href="#cb41-800" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb41-801"><a href="#cb41-801" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb41-802"><a href="#cb41-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-803"><a href="#cb41-803" aria-hidden="true" tabindex="-1"></a><span class="co"># display model summary -&gt; looking for residual standard error = S = sqrt(MSE)</span></span>
<span id="cb41-804"><a href="#cb41-804" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; save to object to extract it</span></span>
<span id="cb41-805"><a href="#cb41-805" aria-hidden="true" tabindex="-1"></a>(summ <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod))</span>
<span id="cb41-806"><a href="#cb41-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-807"><a href="#cb41-807" aria-hidden="true" tabindex="-1"></a><span class="co"># display S and MSE = S^2</span></span>
<span id="cb41-808"><a href="#cb41-808" aria-hidden="true" tabindex="-1"></a>summ<span class="sc">$</span>sigma</span>
<span id="cb41-809"><a href="#cb41-809" aria-hidden="true" tabindex="-1"></a>summ<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb41-810"><a href="#cb41-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-811"><a href="#cb41-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-812"><a href="#cb41-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-813"><a href="#cb41-813" aria-hidden="true" tabindex="-1"></a>These are estimates of population quantities for the error terms, and when simulating the data we assumed $\epsilon_i \sim \text{Uniform}\,(a, b) \Longrightarrow \sigma^2 = V(\epsilon_i) = \frac{(b - a)^2}{12}$. For $a$ = <span class="in">`r min`</span> and $b$ = <span class="in">`r max`</span>, $V(\epsilon_i)$ = <span class="in">`r round((max - min)^2 / 12, 3)`</span>.</span>
<span id="cb41-814"><a href="#cb41-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-815"><a href="#cb41-815" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Manual</span></span>
<span id="cb41-816"><a href="#cb41-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-819"><a href="#cb41-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-820"><a href="#cb41-820" aria-hidden="true" tabindex="-1"></a><span class="co"># SIDENOTE -&gt; showing multiple equivalent ways to do the same thing (just keep the last way)</span></span>
<span id="cb41-821"><a href="#cb41-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-822"><a href="#cb41-822" aria-hidden="true" tabindex="-1"></a><span class="co"># get fitted values using functions</span></span>
<span id="cb41-823"><a href="#cb41-823" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> mod<span class="sc">$</span>fitted.values</span>
<span id="cb41-824"><a href="#cb41-824" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(mod)</span>
<span id="cb41-825"><a href="#cb41-825" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fu">fitted.values</span>(mod) <span class="co"># alias for fitted()</span></span>
<span id="cb41-826"><a href="#cb41-826" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod) <span class="co"># discussed more later</span></span>
<span id="cb41-827"><a href="#cb41-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-828"><a href="#cb41-828" aria-hidden="true" tabindex="-1"></a><span class="co"># extract residuals using functions (or some manual calculations)</span></span>
<span id="cb41-829"><a href="#cb41-829" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">residuals</span>(mod)</span>
<span id="cb41-830"><a href="#cb41-830" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">resid</span>(mod) <span class="co"># alias for residuals()</span></span>
<span id="cb41-831"><a href="#cb41-831" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> mod<span class="sc">$</span>residuals</span>
<span id="cb41-832"><a href="#cb41-832" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> y <span class="sc">-</span> y_hat</span>
<span id="cb41-833"><a href="#cb41-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-834"><a href="#cb41-834" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate SSE and df</span></span>
<span id="cb41-835"><a href="#cb41-835" aria-hidden="true" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="fu">sum</span>(e<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb41-836"><a href="#cb41-836" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> mod<span class="sc">$</span>df.residual <span class="co"># extract from model object</span></span>
<span id="cb41-837"><a href="#cb41-837" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">df.residual</span>(mod)</span>
<span id="cb41-838"><a href="#cb41-838" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> summ<span class="sc">$</span>df[<span class="dv">2</span>] <span class="co"># extract from model summary -&gt; error df is the second item (even if have MLR model)</span></span>
<span id="cb41-839"><a href="#cb41-839" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> n <span class="sc">-</span> <span class="dv">2</span> <span class="co"># for SLR (with intercept)</span></span>
<span id="cb41-840"><a href="#cb41-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-841"><a href="#cb41-841" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate MSE</span></span>
<span id="cb41-842"><a href="#cb41-842" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> sse <span class="sc">/</span> df</span>
<span id="cb41-843"><a href="#cb41-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-844"><a href="#cb41-844" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate residual standard deviation</span></span>
<span id="cb41-845"><a href="#cb41-845" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse)</span>
<span id="cb41-846"><a href="#cb41-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-847"><a href="#cb41-847" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to results from summary(lm())</span></span>
<span id="cb41-848"><a href="#cb41-848" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; s</span></span>
<span id="cb41-849"><a href="#cb41-849" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(summ<span class="sc">$</span>sigma, s)</span>
<span id="cb41-850"><a href="#cb41-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-851"><a href="#cb41-851" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; MSE</span></span>
<span id="cb41-852"><a href="#cb41-852" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(summ<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span>, mse)</span>
<span id="cb41-853"><a href="#cb41-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-854"><a href="#cb41-854" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; SSE = MSE * df</span></span>
<span id="cb41-855"><a href="#cb41-855" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(summ<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> summ<span class="sc">$</span>df[<span class="dv">2</span>], sse)</span>
<span id="cb41-856"><a href="#cb41-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-857"><a href="#cb41-857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-858"><a href="#cb41-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-859"><a href="#cb41-859" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- alternate formula for sse = syy - beta1-hat sxy: from notes; not sure if needed --&gt;</span></span>
<span id="cb41-860"><a href="#cb41-860" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb41-861"><a href="#cb41-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-862"><a href="#cb41-862" aria-hidden="true" tabindex="-1"></a><span class="fu">## Normal error regression model</span></span>
<span id="cb41-863"><a href="#cb41-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-864"><a href="#cb41-864" aria-hidden="true" tabindex="-1"></a>Least squares results</span>
<span id="cb41-865"><a href="#cb41-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-866"><a href="#cb41-866" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>No matter what may be the form of the distribution of the error terms $\epsilon_i$ (and thus of the $Y_i$), the LSE provides unbiased point estimators of $\beta_0$ and $\beta_1$, that have minimum variance among all unbiased linear estimators (BLUEs).</span>
<span id="cb41-867"><a href="#cb41-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-868"><a href="#cb41-868" aria-hidden="true" tabindex="-1"></a>Assumptions on error term distribution</span>
<span id="cb41-869"><a href="#cb41-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-870"><a href="#cb41-870" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>These assumptions on $\epsilon_i$ are needed to set up interval estimates and make tests.</span>
<span id="cb41-871"><a href="#cb41-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-872"><a href="#cb41-872" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The standard assumption is that the error terms are normally distributed. This greatly simplifies the theory of regression analysis and is justifiable in many real-world situations where regression analysis is applied.</span>
<span id="cb41-873"><a href="#cb41-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-874"><a href="#cb41-874" aria-hidden="true" tabindex="-1"></a>New regression model</span>
<span id="cb41-875"><a href="#cb41-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-876"><a href="#cb41-876" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-877"><a href="#cb41-877" aria-hidden="true" tabindex="-1"></a>Y_i = \beta_0 + \beta_1 X_i + \epsilon_i, \hspace{20pt} \text{where} \hspace{10pt} \epsilon_i \overset{iid}\sim \text{Normal}\,(0,\sigma^2)</span>
<span id="cb41-878"><a href="#cb41-878" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-879"><a href="#cb41-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-880"><a href="#cb41-880" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This is the same regression model as before, just with specified error distribution now ($iid$ = independent and identically distributed).</span>
<span id="cb41-881"><a href="#cb41-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-882"><a href="#cb41-882" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Because this model assumes normal errors, the assumption of uncorrelatedness of the original (unspecified error) model now becomes an independence assumption ($\perp <span class="sc">\!\!\!</span> \perp\Longrightarrow \mathrm{Corr}(\epsilon_i,\epsilon_j) = 0$. So the outcome in anyone trial has no effect on the error term for any other trial (in terms of positive or negative, small or large).</span>
<span id="cb41-883"><a href="#cb41-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-884"><a href="#cb41-884" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This model means $Y_i \overset{\perp <span class="sc">\!\!\!</span> \perp}\sim \text{Normal}\,$ with $E(Y_i) = \beta_0 + \beta_1 X_i$ and $V(Y_i) = \sigma^2$.</span>
<span id="cb41-885"><a href="#cb41-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-886"><a href="#cb41-886" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/normal-error-model.png)</span>{width="50%"}</span>
<span id="cb41-887"><a href="#cb41-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-888"><a href="#cb41-888" aria-hidden="true" tabindex="-1"></a>Justification of the normality assumption.</span>
<span id="cb41-889"><a href="#cb41-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-890"><a href="#cb41-890" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Error terms frequently represent the effects of factors omitted from the model that affect the response to some extent and that vary at random without reference to the variable $X$.</span>
<span id="cb41-891"><a href="#cb41-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-892"><a href="#cb41-892" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>These random effects have a degree of mutual independence, the composite error term representing all these factors tends to normal as the number of factors becomes large (by the CLT).</span>
<span id="cb41-893"><a href="#cb41-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-894"><a href="#cb41-894" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Also, the estimation and testing procedures shown later are based on the $t$ distribution and are usually only sensitive to large departures from normality. So, unless the departures from normality are serious, particularly with respect to skewness, the actual confidence coefficients and risks of errors will be close to the levels for exact normality.</span>
<span id="cb41-895"><a href="#cb41-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-896"><a href="#cb41-896" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimation of paramters by method of maximum likelihood</span></span>
<span id="cb41-897"><a href="#cb41-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-898"><a href="#cb41-898" aria-hidden="true" tabindex="-1"></a>Overview</span>
<span id="cb41-899"><a href="#cb41-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-900"><a href="#cb41-900" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The method of maximum likelihood chooses as estimates values of the parameters that are most consistent with the sample data. The measure of consistency is the product of densities and is called the **likelihood value** $L(\mu)$.</span>
<span id="cb41-901"><a href="#cb41-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-902"><a href="#cb41-902" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If the value of $\mu$ is consistent with the sample data $\Longrightarrow$ densities relatively large $\Longrightarrow$ large likelihood value. If not, both will be small.</span>
<span id="cb41-903"><a href="#cb41-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-904"><a href="#cb41-904" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mle-example.png)</span>{width="70%"}</span>
<span id="cb41-905"><a href="#cb41-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-906"><a href="#cb41-906" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Just like the LSE, there are two ways to find MLEs: a systematic numerical search and by use of an analytical solution.</span>
<span id="cb41-907"><a href="#cb41-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-908"><a href="#cb41-908" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The product of the densities viewed as a function of the unknown parameters is called the **likelihood function**.</span>
<span id="cb41-909"><a href="#cb41-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-910"><a href="#cb41-910" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If the likelihood function is relatively peaked in the neighborhood of the maximum, then the MLE estimate is precise because values of $\mu$ not near the MLE are much less consistent with the data.</span>
<span id="cb41-911"><a href="#cb41-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-912"><a href="#cb41-912" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>When it is relatively flat in a fairly wide region around the MLE, many values of the parameter are almost as consistent with the sample data as the MLE and therefore the MLE is relatively imprecise.</span>
<span id="cb41-913"><a href="#cb41-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-914"><a href="#cb41-914" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- SHOW PLOTS and stuff from MLE DEMO??? --&gt;</span></span>
<span id="cb41-915"><a href="#cb41-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-916"><a href="#cb41-916" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- find example of flat mle maybe --&gt;</span></span>
<span id="cb41-917"><a href="#cb41-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-918"><a href="#cb41-918" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- and where have to numerical maximize to get coefficients? functions for how to do this in R?? Is this where gradient descent comes into play?? --&gt;</span></span>
<span id="cb41-919"><a href="#cb41-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-920"><a href="#cb41-920" aria-hidden="true" tabindex="-1"></a>Steps to MLEs</span>
<span id="cb41-921"><a href="#cb41-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-922"><a href="#cb41-922" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>For multivariate parameter vector $\boldsymbol{\theta} = (\theta_1, \ldots, \theta_{k})$, write the likelihood function (i.e. joint density function) and the log-likelihood function</span>
<span id="cb41-923"><a href="#cb41-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-924"><a href="#cb41-924" aria-hidden="true" tabindex="-1"></a>    <span class="co">&lt;!-- !!! add more background about MLEs, like why optimize log... --&gt;</span></span>
<span id="cb41-925"><a href="#cb41-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-926"><a href="#cb41-926" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-927"><a href="#cb41-927" aria-hidden="true" tabindex="-1"></a>L(\boldsymbol{\theta} \mid \mathbf{y}) = \prod_{i = 1}^n f(\mathbf{y} \mid \boldsymbol{\theta}) \hspace{20pt} \rightarrow \hspace{20pt} \ell(\boldsymbol{\theta}) = \ln<span class="co">[</span><span class="ot">L(\boldsymbol{\theta} \mid \mathbf{y})</span><span class="co">]</span></span>
<span id="cb41-928"><a href="#cb41-928" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-929"><a href="#cb41-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-930"><a href="#cb41-930" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Optimize the log-likelihood function by taking the partial derivatives with respect to each parameters of interest $\theta_1, \ldots, \theta_{k}$.</span>
<span id="cb41-931"><a href="#cb41-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-932"><a href="#cb41-932" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Set to zero and solve for each parameter of interest.</span>
<span id="cb41-933"><a href="#cb41-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-934"><a href="#cb41-934" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-935"><a href="#cb41-935" aria-hidden="true" tabindex="-1"></a>\text{For } j = 1, \ldots, k \hspace{20pt} \ell'(\boldsymbol{\theta}) = \frac{\partial}{\partial \theta_j} \ell(\boldsymbol{\theta}) = 0 \hspace{20pt} \rightarrow \hspace{20pt} \hat{\boldsymbol{\theta}} = (\hat{\theta}_1, \ldots, \hat{\theta}_{k}) = \text{potential MLE}</span>
<span id="cb41-936"><a href="#cb41-936" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-937"><a href="#cb41-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-938"><a href="#cb41-938" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Verify that the global maximum of the log-likelihood function occurs at $\boldsymbol{\theta} = \hat{\boldsymbol{\theta}}$.</span>
<span id="cb41-939"><a href="#cb41-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-940"><a href="#cb41-940" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Find the second derivative of the log-likelihood function, then plug in $\hat{\boldsymbol{\theta}}$ and see if less than zero.</span>
<span id="cb41-941"><a href="#cb41-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-942"><a href="#cb41-942" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Hessian matrix stuff --&gt;</span></span>
<span id="cb41-943"><a href="#cb41-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-944"><a href="#cb41-944" aria-hidden="true" tabindex="-1"></a>MLEs for normal error regression model</span>
<span id="cb41-945"><a href="#cb41-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-946"><a href="#cb41-946" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Generally</span>
<span id="cb41-947"><a href="#cb41-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-948"><a href="#cb41-948" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb41-949"><a href="#cb41-949" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results</span></span>
<span id="cb41-950"><a href="#cb41-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-951"><a href="#cb41-951" aria-hidden="true" tabindex="-1"></a>| Parameter  | MLE                                                                 |</span>
<span id="cb41-952"><a href="#cb41-952" aria-hidden="true" tabindex="-1"></a>|:--------------|:--------------------------------------------------------|</span>
<span id="cb41-953"><a href="#cb41-953" aria-hidden="true" tabindex="-1"></a>| $\beta_0$  | $\hat{\beta}_0 \hspace{10pt}$ Same as LSE                           |</span>
<span id="cb41-954"><a href="#cb41-954" aria-hidden="true" tabindex="-1"></a>| $\beta_1$  | $\hat{\beta}_1 \hspace{10pt}$ Same as LSE                           |</span>
<span id="cb41-955"><a href="#cb41-955" aria-hidden="true" tabindex="-1"></a>| $\sigma^2$ | $\displaystyle \hat{\sigma}^2 = \frac{\sum (Y_i - \hat{Y_i})^2}{n}$ |</span>
<span id="cb41-956"><a href="#cb41-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-957"><a href="#cb41-957" aria-hidden="true" tabindex="-1"></a>Notes</span>
<span id="cb41-958"><a href="#cb41-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-959"><a href="#cb41-959" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Properties of estimators</span>
<span id="cb41-960"><a href="#cb41-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-961"><a href="#cb41-961" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Since MLEs for $\hat{\beta}_0$ and $\hat{\beta}_1$ are the same as the LSE estimators, they have the same properties: BLUE (unbiased and minimum variance in class of unbiased linear estimators).</span>
<span id="cb41-962"><a href="#cb41-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-963"><a href="#cb41-963" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>And because they are MLEs, we can also say they are: consistent ($\hat{\beta}_i \overset{p}\rightarrow \beta_i$, converge in probability to their respective parameters); sufficient (captures all of the information about $\beta_i$ contained in the sample); minimum variance in class of unbiased estimators (linear or otherwise).</span>
<span id="cb41-964"><a href="#cb41-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-965"><a href="#cb41-965" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- better explanation of sufficiency; state theorem why best variance for all unbiased estimators --&gt;</span></span>
<span id="cb41-966"><a href="#cb41-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-967"><a href="#cb41-967" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MLE $\hat{\sigma}^2$ and MSE</span>
<span id="cb41-968"><a href="#cb41-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-969"><a href="#cb41-969" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Relationship $S^2 = MSE = \frac{n}{n - 2} \hat{\sigma}^2 \hspace{20pt} \Longleftrightarrow \hspace{20pt} \hat{\sigma}^2 = \frac{n - 2}{n} MSE$. However, for large $n$, the difference is small.</span>
<span id="cb41-970"><a href="#cb41-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-971"><a href="#cb41-971" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>MLE $\hat{\sigma}^2$ is biased → $E(\hat{\sigma}^2) = \frac{n - 2}{n} \sigma^2$, which is an underestimation of $\sigma^2$. Because of this, MSE is generally used because it is unbiased. However, $\hat{\sigma}^2$ is asymptotically unbiased (as $n \rightarrow \infty$) and has a smaller variance than MSE, which may be preferred in some scenarios (tradeoff between bias and precision).</span>
<span id="cb41-972"><a href="#cb41-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-973"><a href="#cb41-973" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Generally MLE gives the same results as LSE.</span>
<span id="cb41-974"><a href="#cb41-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-975"><a href="#cb41-975" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- investigate this, when, why? when is one better? !!!! what about when not normal??--&gt;</span></span>
<span id="cb41-976"><a href="#cb41-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-977"><a href="#cb41-977" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Derivation</span></span>
<span id="cb41-978"><a href="#cb41-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-979"><a href="#cb41-979" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/placeholder.png)</span>{width="50%"}</span>
<span id="cb41-980"><a href="#cb41-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-981"><a href="#cb41-981" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Can also derive MLEs for transformed models using the same strategy as with LSE.</span>
<span id="cb41-982"><a href="#cb41-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-983"><a href="#cb41-983" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Example: Suppose we have $\ln(Y_i) = \beta_0 + \beta_1 X_i + \epsilon_i$. We can transform $Y_i^* = \beta_0^* + \beta_1^* X_i + \epsilon_i$, derive like usual, then substitute at end to get untransformed estimators.</span>
<span id="cb41-984"><a href="#cb41-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-985"><a href="#cb41-985" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- demo calculating mle sigma2 in r based on residuals and compare to mse --&gt;</span></span>
<span id="cb41-986"><a href="#cb41-986" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>