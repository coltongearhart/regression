<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.517">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Regression - 5&nbsp; Multiple regression 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./notes-multiple-regression-2.html" rel="next">
<link href="./part2-mlr.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part2-mlr.html">Multiple linear regression</a></li><li class="breadcrumb-item"><a href="./notes-multiple-regression-1.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Multiple regression 1</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part2-mlr.html">Multiple linear regression</a></li><li class="breadcrumb-item"><a href="./notes-multiple-regression-1.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Multiple regression 1</span></a></li></ol></nav><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Multiple regression 1</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Regression</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part1-slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notes-slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notes-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notes-diagnostics-and-remedial-measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Diagnostics and remedial measures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notes-matrix-slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Matrix approach to SLR</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part2-mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notes-multiple-regression-1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Multiple regression 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notes-multiple-regression-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Multiple regression 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notes-reg-models-quan-and-qual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regression models for quanititative and qualitative predictors</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">5.1</span> Overview</a></li>
  <li>
<a href="#multiple-regression-models" id="toc-multiple-regression-models" class="nav-link" data-scroll-target="#multiple-regression-models"><span class="header-section-number">5.2</span> Multiple regression models</a>
  <ul class="collapse">
<li><a href="#sec-first-order-two-preds" id="toc-sec-first-order-two-preds" class="nav-link" data-scroll-target="#sec-first-order-two-preds"><span class="header-section-number">5.2.1</span> First order model with two predictors</a></li>
  <li><a href="#first-order-model-with-more-than-two-predictor-variables" id="toc-first-order-model-with-more-than-two-predictor-variables" class="nav-link" data-scroll-target="#first-order-model-with-more-than-two-predictor-variables"><span class="header-section-number">5.2.2</span> First order model with more than two predictor variables</a></li>
  <li><a href="#general-linear-regression-model" id="toc-general-linear-regression-model" class="nav-link" data-scroll-target="#general-linear-regression-model"><span class="header-section-number">5.2.3</span> General linear regression model</a></li>
  </ul>
</li>
  <li>
<a href="#sec-main-mlr-demo" id="toc-sec-main-mlr-demo" class="nav-link" data-scroll-target="#sec-main-mlr-demo"><span class="header-section-number">5.3</span> General linear regression model in matrix terms</a>
  <ul class="collapse">
<li><a href="#estimation-of-regression-coefficients-fitted-values-and-residuals" id="toc-estimation-of-regression-coefficients-fitted-values-and-residuals" class="nav-link" data-scroll-target="#estimation-of-regression-coefficients-fitted-values-and-residuals"><span class="header-section-number">5.3.1</span> Estimation of regression coefficients, fitted values and residuals</a></li>
  <li><a href="#sec-anova-matrices" id="toc-sec-anova-matrices" class="nav-link" data-scroll-target="#sec-anova-matrices"><span class="header-section-number">5.3.2</span> ANOVA</a></li>
  <li><a href="#sec-f-test-overall" id="toc-sec-f-test-overall" class="nav-link" data-scroll-target="#sec-f-test-overall"><span class="header-section-number">5.3.3</span> F-test for regression relation</a></li>
  <li><a href="#coefficient-of-multiple-determination" id="toc-coefficient-of-multiple-determination" class="nav-link" data-scroll-target="#coefficient-of-multiple-determination"><span class="header-section-number">5.3.4</span> Coefficient of multiple determination</a></li>
  <li><a href="#coefficient-of-multiple-correlation" id="toc-coefficient-of-multiple-correlation" class="nav-link" data-scroll-target="#coefficient-of-multiple-correlation"><span class="header-section-number">5.3.5</span> Coefficient of multiple correlation</a></li>
  <li><a href="#inferences-about-regression-parameters" id="toc-inferences-about-regression-parameters" class="nav-link" data-scroll-target="#inferences-about-regression-parameters"><span class="header-section-number">5.3.6</span> Inferences about regression parameters</a></li>
  <li><a href="#estimation-of-mean-response-and-prediction-of-new-observation" id="toc-estimation-of-mean-response-and-prediction-of-new-observation" class="nav-link" data-scroll-target="#estimation-of-mean-response-and-prediction-of-new-observation"><span class="header-section-number">5.3.7</span> Estimation of mean response and prediction of new observation</a></li>
  </ul>
</li>
  <li>
<a href="#diagnostics-and-remedial-measures" id="toc-diagnostics-and-remedial-measures" class="nav-link" data-scroll-target="#diagnostics-and-remedial-measures"><span class="header-section-number">5.4</span> Diagnostics and remedial measures</a>
  <ul class="collapse">
<li><a href="#residual-plots-demo-for-various-misfitting-models" id="toc-residual-plots-demo-for-various-misfitting-models" class="nav-link" data-scroll-target="#residual-plots-demo-for-various-misfitting-models"><span class="header-section-number">5.4.1</span> Residual plots demo for various misfitting models</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><!-- % define LaTeX macros (/shortcuts) --><!-- % define vector (without parentheses, so when writing out in like a definition) of the form X_1, ..., X_n, where X and n are variable. NOTE: to call use $\vecn{X}{n}$ --><!-- % shortcut for ~ 'Named dist ' in normal font with space before parameters would go --><!-- % (followsp is short for 'follow special') shortcut that can be used for iid or ind ~ 'Named dist ' in normal font with space before parameters would go --><!-- % define independence symbol (it basically makes two orthogonal symbols very close to each other. The number of \! controls the space between each of the orthogonal symbols) --><!-- % shortcut for Cov(X,Y) with formatting for Cov --><!-- % shortcut for Corr(X,Y) with formatting for Corr --><!-- % shortcut for non-italic e in math mode --><!-- % shortcut for matrix notation --><section id="overview" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="overview">
<span class="header-section-number">5.1</span> Overview</h2>
<p>Multiple regression analysis is one of the most widely used of all statistical methods. In this section, we first discuss a variety of multiple regression models.</p>
<p>Since the matrix expressions for multiple regression are the same as for simple linear regression, can just refer to <a href="notes-matrix-slr.html" class="quarto-xref"><span>Chapter&nbsp;4</span></a>.</p>
<p>The need for multiple predictors</p>
<ul>
<li><p>Often times, a single predictor variable in the model provides an inadequate description since a number of key variables affect the response variable in important and distinctive ways.</p></li>
<li><p>Furthermore, in situations like this, we frequently find that predictions of the response variable based on a model containing only a single predictor variable are too imprecise to be useful.</p></li>
<li><p>Multiple predictors is useful in observational studies when there is no control over the variables as well as in experimental situations where the experimenter can control the <span class="math inline">\(X\)</span> levels and investigate different combination simultaneously.</p></li>
</ul></section><section id="multiple-regression-models" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="multiple-regression-models">
<span class="header-section-number">5.2</span> Multiple regression models</h2>
<section id="sec-first-order-two-preds" class="level3" data-number="5.2.1"><h3 data-number="5.2.1" class="anchored" data-anchor-id="sec-first-order-two-preds">
<span class="header-section-number">5.2.1</span> First order model with two predictors</h3>
<p>When there are two predictor variables <span class="math inline">\(X_l\)</span> and <span class="math inline">\(X_2\)</span>, the regression model:</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2} + \epsilon_i\]</span></p>
<p>This model is still linear in its predictors. It follows that if <span class="math inline">\(E(\epsilon_i) = 0\)</span></p>
<p><span class="math display">\[E(Y_i) = \beta_0 + \beta_1 X_1 + \beta_1 X_2\]</span></p>
<p>Note that now predictions are a plane and any point on the response plane corresponds to the mean response <span class="math inline">\(E(Y)\)</span> at the given combination of levels of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>.</p>
<p><img src="files/images/response-plane.png" class="img-fluid" style="width:50.0%"></p>
<p>Here the vertical distance from <span class="math inline">\(Y_i\)</span> to the response plane represents the error term <span class="math inline">\(\epsilon_i = Y_i - E(Y)\)</span>.</p>
<p>Frequently the regression function in multiple regression is called a <em>regression surface</em> or a <em>response surface</em>.</p>
<p>Meaning of regression coefficients</p>
<ul>
<li>
<p>The parameter <span class="math inline">\(\beta_0\)</span> is the intercept of the regression plane.</p>
<ul>
<li>If the scope of the model includes <span class="math inline">\(X_1 = 0\)</span> and <span class="math inline">\(X_2 = 0\)</span>, then <span class="math inline">\(\beta_0 = 10\)</span> for example represents the mean response <span class="math inline">\(E(Y)\)</span> at <span class="math inline">\(X_1 = 0\)</span> and <span class="math inline">\(X_2 = 0\)</span>.</li>
</ul>
</li>
<li>
<p>The parameter <span class="math inline">\(\beta_1\)</span> indicates the change in the mean response <span class="math inline">\(E(Y)\)</span> per unit increase in <span class="math inline">\(X_1\)</span> when <span class="math inline">\(X_2\)</span> is held constant. Same but reverse for <span class="math inline">\(\beta_2\)</span>.</p>
<ul>
<li><p>For example: If <span class="math inline">\(E(Y) = 10 + 2X_1 + 5X_2\)</span> and the level of <span class="math inline">\(X_2\)</span> is held at 2, then <span class="math inline">\(E(Y) = 10 + 2X_1 + 5(2) = 20 + 2X_1\)</span>.</p></li>
<li><p>This response function is a straight line with slope <span class="math inline">\(\beta_1 = 2\)</span>. This is true for all other values of <span class="math inline">\(X_2\)</span>, only the value of the intercept changes.</p></li>
</ul>
</li>
</ul>
<p>Additive models vs interaction models</p>
<ul>
<li><p>When the effect of <span class="math inline">\(X_1\)</span> on the mean response does not depend on the level of <span class="math inline">\(X_2\)</span>, and correspondingly the effect of <span class="math inline">\(X_2\)</span> does not depend on the level of <span class="math inline">\(X_1\)</span>, the two predictor variables are said to have <em>additive effects</em> or not to <em>interact</em>.</p></li>
<li><p>Thus, the first-order regression model is designed for predictor variables whose effects on the mean response are additive or do not interact.</p></li>
<li><p>The parameters <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> are sometimes called <em>partial regression coefficients</em> because they reflect the partial effect of one predictor variable when the other predictor variable is included in the model and is held constant.</p></li>
</ul></section><section id="first-order-model-with-more-than-two-predictor-variables" class="level3" data-number="5.2.2"><h3 data-number="5.2.2" class="anchored" data-anchor-id="first-order-model-with-more-than-two-predictor-variables">
<span class="header-section-number">5.2.2</span> First order model with more than two predictor variables</h3>
<p>We consider now the case where there are <span class="math inline">\(p - 1\)</span> predictor variables <span class="math inline">\(X_1, \ldots , X_{p-1}\)</span>. The regression model:</p>
<p><span id="eq-first-order-all-preds"><span class="math display">\[Y_i = \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2} + \cdots + \beta_{p-1} X_{i,p-1} + \epsilon_i \tag{5.1}\]</span></span></p>
<p>is called a first-order model with <span class="math inline">\(p - 1\)</span> predictor variables. It can also be written as:</p>
<p><span class="math display">\[Y_i = \beta_0 + \sum_{k = 1}^{p - 1} \beta_k X_{ik} + \epsilon_i\]</span></p>
<p>It follows that if <span class="math inline">\(E(\epsilon_i) = 0\)</span></p>
<p><span class="math display">\[E(Y_i) =  \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2} + \cdots + \beta_{p-1} X_{i,p-1}\]</span></p>
<p>Notes about model:</p>
<ul>
<li><p>This response function is a <em>hyperplane</em>, which is a plane in more than two dimensions. It is no longer possible to picture this plane.</p></li>
<li><p>The meaning of the parameters is the same as when there were two predictors, just extended to all other <span class="math inline">\(X\)</span> levels held constant.</p></li>
<li><p>This first-order regression model is still designed for predictor variables whose effects on the mean response are additive and therefore do interact.</p></li>
<li><p>When <span class="math inline">\(p - 1 = 1\)</span>, this model reduces to the SLR model we are used to.</p></li>
</ul></section><section id="general-linear-regression-model" class="level3" data-number="5.2.3"><h3 data-number="5.2.3" class="anchored" data-anchor-id="general-linear-regression-model">
<span class="header-section-number">5.2.3</span> General linear regression model</h3>
<p>In general, the variables <span class="math inline">\(X_1, \ldots, X_{p-1}\)</span> in a regression model do not need to represent different predictor variables, as we will see soon. Therefore, we define the general linear regression model, with normal error terms, simply in terms of <span class="math inline">\(X\)</span> variables (same as before, just now more general of what the <span class="math inline">\(X\)</span>s can represent):</p>
<p><span id="eq-gen-reg-mod"><span class="math display">\[Y_i = \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2} + \cdots + \beta_{p-1} X_{i,p-1} + \epsilon_i \tag{5.2}\]</span></span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_{p-1}\)</span> are parameters (note there are <span class="math inline">\(p\)</span> parameters because of the intercept)</p></li>
<li><p><span class="math inline">\(X_{i1}, \ldots, X_{i,p-1}\)</span> are known constants</p></li>
<li><p><span class="math inline">\(\epsilon_i \overset{iid}\sim \text{Normal}\,(0, \sigma^2)\)</span></p></li>
<li><p><span class="math inline">\(i = 1, \ldots, n\)</span></p></li>
</ul>
<p>Again since <span class="math inline">\(E(\epsilon_i) = 0\)</span>,</p>
<p><span class="math display">\[E(Y_i) = \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2} + \cdots + \beta_{p-1} X_{i,p-1}\]</span></p>
<p>Thus, the general linear regression model with normal error terms implies that the observations <span class="math inline">\(Y_i\)</span> are independent normal variables, with mean <span class="math inline">\(E(Y)\)</span> as given by above and with constant variance <span class="math inline">\(\sigma^2\)</span>.</p>
<p>This general linear model encompasses a vast variety of situations. We consider a few of these now.</p>
<p><span class="math inline">\(p - 1\)</span> predictor variables</p>
<ul>
<li>When <span class="math inline">\(X_1, \ldots, X_{p-1}\)</span> represent <span class="math inline">\(p - 1\)</span> different predictor variables, the general linear regression model above is simply <a href="#eq-first-order-all-preds" class="quarto-xref">Equation&nbsp;<span>5.1</span></a> seen earlier (first-order model in which there are no interaction effects between the predictor variables).</li>
</ul>
<p>Qualitative predictors</p>
<ul>
<li><p>Model in <a href="#eq-gen-reg-mod" class="quarto-xref">Equation&nbsp;<span>5.2</span></a> encompasses not only quantitative predictor variables but also qualitative ones.</p></li>
<li><p>We use indicator variables that take on the values 0 and 1 to identify the classes of a qualitative variable. For example if length of hospital stay <span class="math inline">\(Y\)</span> with <span class="math inline">\(X_1\)</span> = age and <span class="math inline">\(X_2\)</span> = gender of patient where:</p></li>
</ul>
<p><span class="math display">\[
X_2 =
   \left\{
   \begin{array}{ll}
     0 &amp; \text{female}\\
     1 &amp; \text{male}
  \end{array}
  \right.
\]</span></p>
<ul>
<li>The first-order regression model is (with variables defined above):</li>
</ul>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \epsilon_i\]</span> - The response function is</p>
<p><span class="math display">\[E(Y_i) = \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2}\]</span></p>
<ul>
<li>For female patients, <span class="math inline">\(X_2 = 0\)</span> and the response function becomes</li>
</ul>
<p><span class="math display">\[E(Y_i) = \beta_0 + \beta_1 X_{i1}\]</span> - For male patients, <span class="math inline">\(X_2 = 1\)</span> and the response function becomes</p>
<p><span class="math display">\[E(Y_i) = (\beta_0 + \beta_2) + \beta_1 X_{i1}\]</span></p>
<ul>
<li><p>These two response functions represent parallel straight lines with different intercepts.</p></li>
<li><p>In general, we represent a qualitative variable with <span class="math inline">\(c\)</span> classes by means of <span class="math inline">\(c - 1\)</span> indicator variables.</p></li>
</ul>
<p>Polynomial regression</p>
<ul>
<li><p>Polynomial regression models are special cases of the general linear regression model. They contain squared and higher-order terms of the predictor variable(s), making the response function curvilinear.</p></li>
<li><p>The following is a polynomial regres’sion model with one predictor variable:</p></li>
</ul>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_i1 + \beta_2 X_i^2+ \epsilon_i\]</span></p>
<ul>
<li>Despite the curvilinear nature of the response function for regression model above, it is a special casee of general linear regression model <a href="#eq-gen-reg-mod" class="quarto-xref">Equation&nbsp;<span>5.2</span></a>. If we let <span class="math inline">\(X_{i1} = X_i\)</span> and <span class="math inline">\(X_{i2} = X_i^2\)</span>, we can write the above model in the same format as usual:</li>
</ul>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \epsilon_i\]</span></p>
<p>Transformed variables</p>
<ul>
<li>Models with transformed variables involve complex, curvilinear response functions, yet still are special cases of the general linear regression model. Consider the following model with transformed <span class="math inline">\(Y\)</span> variable</li>
</ul>
<p><span class="math display">\[\ln(Y_i) = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \beta_3 X_{i3} + \epsilon_i\]</span> - Here, the response surface is complex, yet this model can still be treated as a general linear regression model if we let <span class="math inline">\(Y_i' = \ln(Y_i)\)</span>. Then just write the regression model as:</p>
<p><span class="math display">\[Y_i' = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \beta_3 X_{i3} + \epsilon_i\]</span></p>
<ul>
<li><p>This has the same form as <a href="#eq-gen-reg-mod" class="quarto-xref">Equation&nbsp;<span>5.2</span></a>, the response variable just happens to be the natural logarithm of <span class="math inline">\(Y\)</span>.</p></li>
<li><p>Many models can be transformed into the g’enerallinear regression model. For example, take this model:</p></li>
</ul>
<p><span class="math display">\[Y_i = \frac{1}{\beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \epsilon_i}\]</span></p>
<ul>
<li>It can be transformed to the general linear regression model by letting <span class="math inline">\(Y_i' = 1/Y_i\)</span>. Then we have</li>
</ul>
<p><span class="math display">\[Y_i' = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \epsilon_i\]</span></p>
<p>Interaction effects</p>
<ul>
<li><p>When the effects of the predictor variables on the response variable are not additive, the effect of one predictor variable depends on the levels of the other predictor variables.</p></li>
<li><p>Our general linear regression model encompasses regression models with nonadditive or interacting effects. An example of a nonadditive regression model with two predictor variables <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> is the following:</p></li>
</ul>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \beta_3 X_{i1} X_{i2} + \epsilon_i\]</span> - Here the response function is complex because of the interaction term <span class="math inline">\(\beta_3 X_{i1} X_{i2}\)</span>. Yet this regression model is still a special case of the general linear regression model. Let <span class="math inline">\(X_3i = X_{i1} X_{i2}\)</span> and then write the model as:</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \beta_3 X_{i3} + \epsilon_i\]</span></p>
<p>Combination of cases</p>
<ul>
<li>A regression model may combine several of the elements we have just noted and still be treated as a general linear regression model.</li>
</ul>
<p><img src="files/images/complex-model.png" class="img-fluid" style="width:50.0%"></p>
<ul>
<li>Examples of complex regression surfaces for two predictors:</li>
</ul>
<p><img src="files/images/regression-surfaces.png" class="img-fluid" style="width:50.0%"> Meaning of linear in general linear regression model</p>
<ul>
<li><p>It should be clear from the various examples that general linear regression model <a href="#eq-gen-reg-mod" class="quarto-xref">Equation&nbsp;<span>5.2</span></a> is not restricted to linear response surfaces.</p></li>
<li><p>The term <em>linear model</em> refers to the fact that the model is linear in the parameters; it does-not refer to the shape of the response surface.</p></li>
<li><p>We say that a regression model is linear in the parameters when it can be written in the form:</p></li>
</ul>
<p><span id="eq-lin-mod"><span class="math display">\[Y_i = c_{i0} \beta_0 + c_{i1} \beta_1 + c_{i2} \beta_2 + \cdots + c_{i,p-1} \beta_{p-1} + \epsilon_i \tag{5.3}\]</span></span></p>
<ul>
<li>Here the terms <span class="math inline">\(c_{i0}, c_{i1}, \ldots\)</span> are coefficients involving the predictor variables. For example, take the first-order model with two variables:</li>
</ul>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2} + \epsilon_i\]</span></p>
<ul>
<li><p>This is linear in parameters with <span class="math inline">\(c_{i0} = 1\)</span>, <span class="math inline">\(c_{i1} = X_{i1}\)</span> and <span class="math inline">\(c_{i2} = X_{i2}\)</span>.</p></li>
<li><p>An example of a nonlinear regression model is the following:</p></li>
</ul>
<p><span class="math display">\[Y_i = \beta_0 \mathrm{e}^{\beta_1 X_i} + \epsilon_i\]</span></p>
<ul>
<li>This is a nonlinear regression model because it cannot be expressed in the form of <a href="#eq-lin-mod" class="quarto-xref">Equation&nbsp;<span>5.3</span></a>.</li>
</ul></section></section><section id="sec-main-mlr-demo" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="sec-main-mlr-demo">
<span class="header-section-number">5.3</span> General linear regression model in matrix terms</h2>
<p>It is a remarkable property of matrix algebra that the results for the general linear regression model <a href="#eq-gen-reg-mod" class="quarto-xref">Equation&nbsp;<span>5.2</span></a> in matrix notation appear exactly as those for the simple linear regression model <a href="notes-matrix-slr.html#eq-slr-matrix-mod" class="quarto-xref">Equation&nbsp;<span>4.1</span></a>. Only the degrees of freedom and other constants related to the number of <span class="math inline">\(X\)</span> variables and the dimensions of some matrices are different. Hence, We are able to present the results very concisely.</p>
<p>We need the following matrices:</p>
<p><img src="files/images/mlr-matrices.png" class="img-fluid" style="width:50.0%"></p>
<p>Everything is just extended to <span class="math inline">\(p\)</span> parameters and <span class="math inline">\(p - 1\)</span> predictor variables.</p>
<p>In matrix terms, the general linear regression model <a href="#eq-gen-reg-mod" class="quarto-xref">Equation&nbsp;<span>5.2</span></a> is:</p>
<p><span id="eq-mlr-matrix-mod"><span class="math display">\[\underset{n \times 1}{\boldsymbol{Y}} = \underset{n \times p}{\boldsymbol{X}} \, \underset{p \times 1}{\boldsymbol{\beta}} + \underset{n \times 1}{\boldsymbol{\epsilon}} \hspace{10pt} \text{and} \hspace{10pt} \underset{n \times 1}{\boldsymbol{E(Y)}} = \underset{n \times 1}{\boldsymbol{X\beta}} \tag{5.4}\]</span></span></p>
<section id="estimation-of-regression-coefficients-fitted-values-and-residuals" class="level3" data-number="5.3.1"><h3 data-number="5.3.1" class="anchored" data-anchor-id="estimation-of-regression-coefficients-fitted-values-and-residuals">
<span class="header-section-number">5.3.1</span> Estimation of regression coefficients, fitted values and residuals</h3>
<p>This is also the exact same, just extended (see <a href="notes-matrix-slr.html#sec-slr-matrix" class="quarto-xref"><span>Section&nbsp;4.3</span></a>).</p>
<p><span class="math inline">\(\underset{p \times 1}{\boldsymbol{\hat{\beta}}} = (\underset{p \times p}{\boldsymbol{X'X}})^{-1}\underset{p \times 1}{\boldsymbol{X'Y}}\)</span></p>
<p><img src="files/images/mlr-mle.png" class="img-fluid" style="width:80.0%"></p>
<p><img src="files/images/mlr-matrix-form.png" class="img-fluid" style="width:80.0%"></p>
<p>Demo</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R functions</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Manual (matrices)</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>(True) Population model: <span class="math inline">\(Y = \beta_0 + \beta_1 Z_1 + \beta_2 Z_2 + \beta_3 Z_3 + \beta_4 Z_4 + \beta_5 Z_5 + \epsilon_i\)</span></p>
<p>where <span class="math inline">\(\hspace{10pt} Z_1 = X_1, Z_2 = X_2, Z_3 = X_3, Z_4 = X_1^2, Z_5 = X_1 X_2 \hspace{10pt} \text{and} \hspace{10pt} \epsilon_i \overset{iid}\sim \text{Normal}\,(0, \sigma^2)\)</span></p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># NOTE: generating a single dataset (and fitting single model) to use for all of the following examples</span></span>
<span><span class="co"># -&gt; so incorporating lots of aspects into this model (polynomial, interaction, omitted predictor, unnecessary predictor)</span></span>
<span></span>
<span><span class="co"># generate predictor data</span></span>
<span><span class="co"># -&gt; num_x number of base predictors (assumed known; generated from same dist)</span></span>
<span><span class="co"># -&gt; num_noise unimportant predictors (placed at end)</span></span>
<span><span class="co"># -&gt; hardcoded 2 higher order / interaction terms (X1^2 and X1*X2)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">num_x</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">num_noise</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">num_x</span><span class="op">+</span><span class="va">num_noise</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span>, <span class="va">X</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">num_x</span><span class="op">)</span><span class="op">]</span>, <span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span>, <span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">X</span><span class="op">[</span> , <span class="fl">2</span><span class="op">]</span>, <span class="va">X</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">num_x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set betas according to which ones are noise (and intercept)</span></span>
<span><span class="va">betas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">num_x</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">num_noise</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate mean response and add random error</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">Z</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">betas</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(Fitted) Population model: <span class="math inline">\(Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_4 + \beta_5 X_1^2 + \beta_6 X_2 X_3\)</span></p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create dataframe of sample data using above</span></span>
<span><span class="va">data_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">data.frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data_sample</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">data_sample</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit mlr regression model</span></span>
<span><span class="co"># -&gt; omitting X3, adding in unnecessary predictor X4, and adding in correct higher order terms</span></span>
<span><span class="va">mod_mlr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X4</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">X1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">X1</span><span class="op">*</span><span class="va">X2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data_sample</span>, x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># view model summary</span></span>
<span><span class="co"># now using broom functions</span></span>
<span><span class="co"># -&gt; see expected results</span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)    1.74      1.55      1.12  2.70e- 1
2 X1             2.11      0.471     4.47  5.38e- 5
3 X2             1.57      0.409     3.85  3.77e- 4
4 X4             0.264     0.429     0.615 5.42e- 1
5 I(X1^2)        2.06      0.137    15.1   5.40e-19
6 I(X1 * X2)     1.95      0.206     9.47  3.50e-12</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Now comparing lots of things</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># extract design matrix from model for simplicity</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="va">mod_mlr</span><span class="op">$</span><span class="va">x</span></span>
<span></span>
<span><span class="co"># estimate coefficients</span></span>
<span><span class="co"># -&gt; betas_hat = (X'X)^(-1) X'Y</span></span>
<span><span class="va">betas_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">design</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Y</span></span>
<span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span>, <span class="va">betas_hat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
$comparison$result
[1] FALSE

$comparison$description
[1] "Attributes: &lt; names for current but not for target &gt;"             
[2] "Attributes: &lt; Length mismatch: comparison on first 0 components &gt;"
[3] "target is numeric, current is matrix"                             

$comparison$`element-wise`
[1] TRUE TRUE TRUE TRUE TRUE TRUE


$`coef(mod_mlr)`
(Intercept)          X1          X2          X4     I(X1^2)  I(X1 * X2) 
  1.7351776   2.1069293   1.5742790   0.2635299   2.0604271   1.9498712 

$betas_hat
                 [,1]
(Intercept) 1.7351776
X1          2.1069293
X2          1.5742790
X4          0.2635299
I(X1^2)     2.0604271
I(X1 * X2)  1.9498712</code></pre>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fitted values</span></span>
<span><span class="va">y_hat</span> <span class="op">&lt;-</span> <span class="va">design</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">betas_hat</span></span>
<span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">y_hat</span><span class="op">)</span>, return_items <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="sec-anova-matrices" class="level3" data-number="5.3.2"><h3 data-number="5.3.2" class="anchored" data-anchor-id="sec-anova-matrices">
<span class="header-section-number">5.3.2</span> ANOVA</h3>
<p>Sum of squares are the exact same as in <a href="notes-matrix-slr.html#sec-slr-anova-matrix" class="quarto-xref"><span>Section&nbsp;4.4</span></a>, just the degrees of freedom are adjusted for the mean squares.</p>
<ul>
<li><p><span class="math inline">\(SSTO\)</span> has the usual <span class="math inline">\(n - 1\)</span> df.</p></li>
<li><p><span class="math inline">\(SSE\)</span> had <span class="math inline">\(n - p\)</span> df due to <span class="math inline">\(p\)</span> parameters needed to be estimated in the regression model <a href="#eq-mlr-matrix-mod" class="quarto-xref">Equation&nbsp;<span>5.4</span></a>.</p></li>
<li><p><span class="math inline">\(SSR\)</span> has <span class="math inline">\(p - 1\)</span> df, representing the number of <span class="math inline">\(X\)</span> variables <span class="math inline">\(X_1, \ldots, X_{p-1}\)</span> (one minus the number of parameters because the intercept doesn’t count)</p></li>
</ul>
<p><span class="math display">\[MSR = \frac{SSR}{p - 1} \hspace{20pt} MSE = \frac{SSE}{n - p}\]</span></p>
<p><img src="files/images/expected-ms-mlr.png" class="img-fluid" style="width:80.0%"></p>
<p><img src="files/images/mlr-anova-table.png" class="img-fluid" style="width:80.0%"></p>
<p>Demo</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R functions</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Manual (matrices)</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Returning to the demo in <a href="#sec-main-mlr-demo" class="quarto-xref"><span>Section&nbsp;5.3</span></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate anova table</span></span>
<span><span class="op">(</span><span class="va">at</span> <span class="op">&lt;-</span> <span class="va">mod_mlr</span> <span class="op">%&gt;%</span> <span class="va">anova</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  term          df  sumsq  meansq statistic   p.value
  &lt;chr&gt;      &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 X1             1 14562. 14562.      211.   2.11e-18
2 X2             1  2291.  2291.       33.2  7.49e- 7
3 X4             1   852.   852.       12.4  1.03e- 3
4 I(X1^2)        1 26138. 26138.      379.   3.00e-23
5 I(X1 * X2)     1  6183.  6183.       89.7  3.50e-12
6 Residuals     44  3035.    69.0      NA   NA       </code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate sum of squares</span></span>
<span><span class="va">ssto</span> <span class="op">&lt;-</span> <span class="va">at</span> <span class="op">%&gt;%</span> <span class="fu">summarize</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">sumsq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sse</span> <span class="op">&lt;-</span> <span class="va">at</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">==</span> <span class="st">"Residuals"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">sumsq</span><span class="op">)</span></span>
<span><span class="va">ssr</span> <span class="op">&lt;-</span> <span class="va">ssto</span> <span class="op">-</span> <span class="va">sse</span></span>
<span><span class="va">ssr</span> <span class="op">&lt;-</span> <span class="va">at</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">!=</span> <span class="st">"Residuals"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarize</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">sumsq</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate sum of squares using quadratic forms</span></span>
<span><span class="co"># -&gt; SSTO = Y'[I-(1/n)J]Y </span></span>
<span><span class="va">SSTO</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Y</span></span>
<span></span>
<span><span class="co"># -&gt; SSE = Y'(I-H)Y</span></span>
<span><span class="va">hat_matrix</span> <span class="op">&lt;-</span> <span class="va">design</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">design</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span>
<span><span class="va">SSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="op">(</span><span class="fu">Matrix</span><span class="fu">::</span><span class="fu">diag</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">hat_matrix</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Y</span></span>
<span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">sse</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">SSE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE

$`as.numeric(sse)`
[1] 3034.76

$`as.numeric(SSE)`
[1] 3034.76</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># -&gt; SSR = Y'[H-(1/n)J]Y </span></span>
<span><span class="va">SSR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="op">(</span><span class="va">hat_matrix</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Y</span></span>
<span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">ssr</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">SSR</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE

$`as.numeric(ssr)`
[1] 50027.51

$`as.numeric(SSR)`
[1] 50027.51</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="sec-f-test-overall" class="level3" data-number="5.3.3"><h3 data-number="5.3.3" class="anchored" data-anchor-id="sec-f-test-overall">
<span class="header-section-number">5.3.3</span> F-test for regression relation</h3>
<p><img src="files/images/mlr-f-test.png" class="img-fluid" style="width:80.0%"></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R functions</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Manual (matrices)</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Returning to the demo in <a href="#sec-main-mlr-demo" class="quarto-xref"><span>Section&nbsp;5.3</span></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># get f-stat model summary</span></span>
<span><span class="co"># -&gt; looking for statistic</span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.943         0.936  8.30      145. 3.55e-26     5  -174.  361.  375.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Continuing with sum of squares calculated from previous demo in <a href="#sec-anova-matrices" class="quarto-xref"><span>Section&nbsp;5.3.2</span></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate sum of squares using quadratic forms</span></span>
<span><span class="co"># -&gt; F = MSR / MSE = (SSR / df_R) / (SSE / df_E)</span></span>
<span><span class="va">MSR</span> <span class="op">&lt;-</span> <span class="va">SSR</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">betas_hat</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">MSE</span> <span class="op">&lt;-</span> <span class="va">SSE</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">betas_hat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">F_stat</span> <span class="op">&lt;-</span> <span class="va">MSR</span> <span class="op">/</span> <span class="va">MSE</span></span>
<span></span>
<span><span class="co"># extract mse from model summary</span></span>
<span><span class="co"># -&gt; df = dr_R and df.residual = df_E -&gt; used to get p-value of F-stat</span></span>
<span><span class="va">mse</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span><span class="op">$</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">mse</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">MSE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE

$`as.numeric(mse)`
[1] 68.97183

$`as.numeric(MSE)`
[1] 68.97183</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">compare</span><span class="op">(</span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">F_stat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE

$`broom::glance(mod_mlr)$statistic`
   value 
145.0665 

$`as.numeric(F_stat)`
[1] 145.0665</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="coefficient-of-multiple-determination" class="level3" data-number="5.3.4"><h3 data-number="5.3.4" class="anchored" data-anchor-id="coefficient-of-multiple-determination">
<span class="header-section-number">5.3.4</span> Coefficient of multiple determination</h3>
<p>The coefficient of multiple determination <span class="math inline">\(R^2\)</span> is the same as in SLR:</p>
<p><span class="math display">\[R^2 = \frac{SSR}{SSTO} = 1 - \frac{SSE}{SSTO}\]</span></p>
<p>It measures the proportionate reduction of total variation in <span class="math inline">\(Y\)</span> associated with the use of the set of X variables <span class="math inline">\(X_1, \ldots , X_{p_1}\)</span>.</p>
<p>Adding more <span class="math inline">\(X\)</span> variables to the regression model can only increase <span class="math inline">\(R^2\)</span> and never reduce it, because <span class="math inline">\(SSE\)</span> can never become larger with more <span class="math inline">\(X\)</span> variables and <span class="math inline">\(SSTO\)</span> is always the same for a given set of responses.</p>
<p>Therefore, we often use the <em>adjusted coefficient of multiple determination</em> <span class="math inline">\(R^2_{adj}\)</span>. It adjusts <span class="math inline">\(R^2\)</span> by dividing each sum of squares by its respective df.</p>
<p><span class="math display">\[R^2_{adj} = 1 - \Big(\frac{SSE}{n - p}\Big) \Big/ \Big(\frac{SSTO}{n - 1}\Big) = 1 - \big(\frac{n - 1}{n - p}\big) \frac{SSE}{SSTO}\]</span></p>
<p>This adjusted coefficient of multiple determination may actually become smaller when another <span class="math inline">\(X\)</span> variable is introduced into the model, because any decrease in <span class="math inline">\(SSE\)</span> may be more than offset by the loss of a degree of freedom in the denominator <span class="math inline">\(n - p\)</span>.</p>
<p>Notes</p>
<ul>
<li><p>It can be shown that the coefficient of multiple determination <span class="math inline">\(R^2\)</span>can be viewed as a coefficient of simple determination between the responses <span class="math inline">\(Y_i\)</span> and the fitted values <span class="math inline">\(\hat{Y}_i\)</span>.</p></li>
<li>
<p>A large value of <span class="math inline">\(R^2\)</span> does not necessarily imply that the fitted model is a useful one.</p>
<ul>
<li><p>For instance, observations may have been taken at only a few levels of the predictor variables. Despite a high <span class="math inline">\(R^2\)</span> in this case, the fitted model may not be useful if most predictions require extrapolations outside the region of observations.</p></li>
<li><p>Again, even though <span class="math inline">\(R^2\)</span> is large, <span class="math inline">\(MSE\)</span> may still be too large for inferences to be useful when high precision is required.</p></li>
</ul>
</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R functions</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Manual (matrices)</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Returning to the demo in <a href="#sec-main-mlr-demo" class="quarto-xref"><span>Section&nbsp;5.3</span></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># view model statistics</span></span>
<span><span class="co"># -&gt; looking at r.squared and adj.r.squared</span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.943         0.936  8.30      145. 3.55e-26     5  -174.  361.  375.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Continuing with sum of squares calculated from a previous demo in <a href="#sec-anova-matrices" class="quarto-xref"><span>Section&nbsp;5.3.2</span></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate coefficient of determination</span></span>
<span><span class="co"># -&gt; R^2 = SSR / SSTO = 1 - SSE / SSTO</span></span>
<span><span class="va">R2</span> <span class="op">&lt;-</span> <span class="va">SSR</span> <span class="op">/</span> <span class="va">SSTO</span></span>
<span><span class="va">R2</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">SSE</span> <span class="op">/</span> <span class="va">SSTO</span></span>
<span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">R2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE

$`as.numeric(broom::glance(mod_mlr)$r.squared)`
[1] 0.9428076

$`as.numeric(R2)`
[1] 0.9428076</code></pre>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate adjusted coefficient of determination</span></span>
<span><span class="co"># -&gt; R^2 = 1 - (n - 1) / (n - p) SSE / SSTO</span></span>
<span><span class="va">R2_adj</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">betas_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">SSE</span> <span class="op">/</span> <span class="va">SSTO</span></span>
<span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">R2_adj</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE

$`as.numeric(broom::glance(mod_mlr)$adj.r.squared)`
[1] 0.9363084

$`as.numeric(R2_adj)`
[1] 0.9363084</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="coefficient-of-multiple-correlation" class="level3" data-number="5.3.5"><h3 data-number="5.3.5" class="anchored" data-anchor-id="coefficient-of-multiple-correlation">
<span class="header-section-number">5.3.5</span> Coefficient of multiple correlation</h3>
<p>The coefficient of multiple correlation <span class="math inline">\(R\)</span> is the positive square root of <span class="math inline">\(R^2\)</span>:</p>
<p><span class="math display">\[R = \sqrt{R^2}\]</span></p>
<p>When there is only one variable in the model, thec oefficient of multiple correlation <span class="math inline">\(R\)</span> equals in absolute value the correlation coefficient <span class="math inline">\(r\)</span> in SLR.</p>
</section><section id="inferences-about-regression-parameters" class="level3" data-number="5.3.6"><h3 data-number="5.3.6" class="anchored" data-anchor-id="inferences-about-regression-parameters">
<span class="header-section-number">5.3.6</span> Inferences about regression parameters</h3>
<p><img src="files/images/mlr-beta-inferences.png" class="img-fluid" style="width:80.0%"></p>
<p><img src="files/images/mlr-beta-intervals-and-tests.png" class="img-fluid" style="width:80.0%"></p>
<p>Demo</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Individual test on <span class="math inline">\(\beta_k\)</span></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Individual CI on <span class="math inline">\(\beta_k\)</span> – R functions</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Individual CI on <span class="math inline">\(\beta_k\)</span> – Manual</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<ul>
<li>Returning to the demo in <a href="#sec-main-mlr-demo" class="quarto-xref"><span>Section&nbsp;5.3</span></a>.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># view coefficient summaries</span></span>
<span><span class="co"># -&gt; looking at std.error, statistic and p.value columns</span></span>
<span><span class="op">(</span><span class="va">summ1</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)    1.74      1.55      1.12  2.70e- 1
2 X1             2.11      0.471     4.47  5.38e- 5
3 X2             1.57      0.409     3.85  3.77e- 4
4 X4             0.264     0.429     0.615 5.42e- 1
5 I(X1^2)        2.06      0.137    15.1   5.40e-19
6 I(X1 * X2)     1.95      0.206     9.47  3.50e-12</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># just going to recreate the p-value from given info</span></span>
<span><span class="op">(</span><span class="va">summ2</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.943         0.936  8.30      145. 3.55e-26     5  -174.  361.  375.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># verify t-stat = estimate / std.error</span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">summ1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">summ1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="va">summ1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE

$`as.numeric(summ1[2, 4])`
[1] 4.472731

$`as.numeric(summ1[2, 2]/summ1[2, 3])`
[1] 4.472731</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate p-value from theoretical (beta_k-hat - beta_k)/ SE(\beta_k-hat) ~ t_(n-p) </span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">summ1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">summ2</span><span class="op">$</span><span class="va">df.residual</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span></span>
<span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">summ1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span>, <span class="va">p_value</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE

$`as.numeric(summ1[2, 5])`
[1] 0.00005378785

$p_value
[1] 0.00005378785</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate confidence interval for single coefficient</span></span>
<span><span class="co"># -&gt; remember these are all individual inferences, not simultaneous confidence intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   2.5 %   97.5 % 
1.157568 3.056290 </code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate lower and upper bounds</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> </span>
<span><span class="va">bound_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">summ1</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span>, df <span class="op">=</span> <span class="va">summ2</span><span class="op">$</span><span class="va">df.residual</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">summ1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">bound_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">summ1</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span>, df <span class="op">=</span> <span class="va">summ2</span><span class="op">$</span><span class="va">df.residual</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">summ1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">compare</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bound_lower</span>, <span class="va">bound_upper</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$comparison
[1] TRUE

$`as.numeric(confint(mod_mlr)[2, ])`
[1] 1.157568 3.056290

$`c(bound_lower, bound_upper)`
[1] 1.157568 3.056290</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><img src="files/images/mlr-joint-beta-inferences.png" class="img-fluid" style="width:80.0%"></p>
<!-- Demo -->
<!-- come back to joint estimation of beta -->
</section><section id="estimation-of-mean-response-and-prediction-of-new-observation" class="level3" data-number="5.3.7"><h3 data-number="5.3.7" class="anchored" data-anchor-id="estimation-of-mean-response-and-prediction-of-new-observation">
<span class="header-section-number">5.3.7</span> Estimation of mean response and prediction of new observation</h3>
<p><img src="files/images/mlr-interval-estimation-EY.png" class="img-fluid" style="width:80.0%"></p>
<p><img src="files/images/mlr-confidence-regression-surface.png" class="img-fluid" style="width:80.0%"></p>
<p><img src="files/images/mlr-simulataneous-cis-mean-responses.png" class="img-fluid" style="width:80.0%"></p>
<p><img src="files/images/mlr-prediction.png" class="img-fluid" style="width:80.0%"></p>
<p><img src="files/images/mlr-hidden-extrapolation.png" class="img-fluid" style="width:80.0%"></p>
</section></section><section id="diagnostics-and-remedial-measures" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="diagnostics-and-remedial-measures">
<span class="header-section-number">5.4</span> Diagnostics and remedial measures</h2>
<p>Diagnostics play an impol1ant role in the development and evaluation of multiple regression models. Most of the diagnostic procedures and remedial meausures for simple linear regression that we described in <a href="notes-diagnostics-and-remedial-measures.html" class="quarto-xref"><span>Chapter&nbsp;3</span></a> carry over directly to multiple regression.</p>
<p>Scatterplot matrix</p>
<ul>
<li><p>Box plots, sequence plots, and dot plots for each of the predictor variables and for the response variable can provide helpful, preliminary univariate information about these variables.</p></li>
<li><p>Scatter plots of the <span class="math inline">\(Y\)</span> against each <span class="math inline">\(X\)</span> can aid in determining the nature and strength of the bivariate relationships and in identifying gaps in the data points as well as outlying data points. Scatter plots of <span class="math inline">\(X\)</span> against each of the other <span class="math inline">\(X\)</span>s provide similar information.</p></li>
<li><p>A complement to the scatter plot matrix that may be useful at times is the correlation matrix (matrix format as <span class="math inline">\([Y, X]\)</span>). Note this is a symmetric matrix with 1 on the main diagonal, so often can just print the upper or lower traingle matrix.</p></li>
</ul>
<p><img src="files/images/correlation-matrix.png" class="img-fluid" style="width:50.0%"></p>
<p>Demo</p>
<p>Returning to the demo in <a href="#sec-main-mlr-demo" class="quarto-xref"><span>Section&nbsp;5.3</span></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># scatterplot matrix (of just the Xs, not the transformed variables as well)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">data_sample</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># correlation matrix</span></span>
<span><span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">data_sample</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Y    X1     X2     X3     X4
Y   1.000 0.524  0.221  0.094 -0.076
X1  0.524 1.000  0.026  0.023  0.086
X2  0.221 0.026  1.000 -0.105  0.026
X3  0.094 0.023 -0.105  1.000  0.003
X4 -0.076 0.086  0.026  0.003  1.000</code></pre>
</div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># correlation plot</span></span>
<span><span class="fu">corrplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># upper triangle correlation matrix</span></span>
<span><span class="va">r</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">r</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Y    X1    X2     X3     X4
Y   1 0.524 0.221  0.094 -0.076
X1 NA 1.000 0.026  0.023  0.086
X2 NA    NA 1.000 -0.105  0.026
X3 NA    NA    NA  1.000  0.003
X4 NA    NA    NA     NA  1.000</code></pre>
</div>
</div>
<p>Residual plots</p>
<ul>
<li><p>Same as for SLR, a plot of the residuals against the fitted values is useful for assessing the appropriateness of the multiple regression function and the constancy of the variance of the error terms, as well as for providing information about outliers.</p></li>
<li><p>Box plots and normal probability plots of the residuals are useful for examining whether the error terms are reasonably normally distributed.</p></li>
<li><p>In addition, residuals should be plotted against each of the predictor variables. Each of these plots can provide further information about the adequacy of the regression function with respect to that predictor variable (e.g., whether a curvature effect is required for that variable) and about possible variation in the magnitude of the error variance in relation to that predictor variable.</p></li>
<li><p>Residuals should also be plotted against important predictor variables that were omitted from the model, to see if the omitted variables have substantial additional effects on the response variable that have not yet been recognized in the regression model.</p></li>
<li><p>Also, residuals should be plotted against interaction terms for potential interaction effects not included in the regression model, such as against <span class="math inline">\(X_1 X_2\)</span>, <span class="math inline">\(X_1 X_3\)</span>, and <span class="math inline">\(X_2 X_3\)</span>, to see whether some or all of these interaction terms are required in the model.</p></li>
<li>
<p>A plot of the absolute residuals or the squared residuals against the fitted values is useful for examining the constancy of the variance of the error terms.</p>
<ul>
<li>If nonconstancy is detected, a plot of the absolute residuals or the squared residuals against each of the predictor vaIiables may identify one or several of the predictor variables to which the magnitude of the error variability is related.</li>
</ul>
</li>
</ul>
<p>Demo</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># residual plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-15-4.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
</div>
<!-- All the tests for MLR about error terms and lack of fit -->
<p>Remedial measures</p>
<ul>
<li><p>The remedial measures described previously are also applicable to multiple regression.</p></li>
<li>
<p>When a more complex model is required to recognize curvature or interaction effects, the multiple regression model can be expanded to include these effects.</p>
<ul>
<li>For example, <span class="math inline">\(X_2^2\)</span> might be added as a variable to take into account a curvature effect of <span class="math inline">\(X_2\)</span>, or <span class="math inline">\(X_1 X_3\)</span> might be added as a variable to recognize an interaction effect between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_3\)</span> on the response variable.</li>
</ul>
</li>
<li>
<p>Alternatively, transformations on the response and/or the predictor variables can be made as discussed before.</p>
<ul>
<li><p>Transformations on the response variable may be helpful when the distributions of the error terms are quite skewed and the variance of the error terms is not constant.</p></li>
<li><p>Transformations of some of the predictor variables may be helpful when the effects of these variables are curvilinear.</p></li>
<li><p>In addition, transformations on <span class="math inline">\(Y\)</span> and or the predictor variables may be helpful in eliminating or substantially reducing interaction effects.</p></li>
</ul>
</li>
<li><p>As with simple linear regression, the usefulness of potential transformations needs to be examined by means of residual plots and other diagnostic tools to determine whether the multiple regression model for the transformed data is appropriate.</p></li>
<li><p>Can still do the Box Cox transformation (<a href="notes-diagnostics-and-remedial-measures.html#sec-box-cox" class="quarto-xref"><span>Section&nbsp;3.7.3</span></a>) like usual.</p></li>
</ul>
<p>Demo</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># run boxcox procedure</span></span>
<span><span class="co"># -&gt; plot MLE of lambda</span></span>
<span><span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/boxcox.html">boxcox</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in boxcox.default(mod_mlr): response variable must be positive</code></pre>
</div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># add constant to response variable so can run box-cox</span></span>
<span><span class="co"># -&gt; from simulation for 'effects of constants and scalars', adding constant to Y only changes the intercept -&gt; still valid model</span></span>
<span><span class="va">mod_mlr_prime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">+</span><span class="fl">50</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X4</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">X1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">X1</span><span class="op">*</span><span class="va">X2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data_sample</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># try again</span></span>
<span><span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/boxcox.html">boxcox</a></span><span class="op">(</span><span class="va">mod_mlr_prime</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># lambda = 1 -&gt; no transformation is needed, as expected</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="residual-plots-demo-for-various-misfitting-models" class="level3" data-number="5.4.1"><h3 data-number="5.4.1" class="anchored" data-anchor-id="residual-plots-demo-for-various-misfitting-models">
<span class="header-section-number">5.4.1</span> Residual plots demo for various misfitting models</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Missing important predictor</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Missing polynomial predictor</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Missing interaction predictor</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Create residual plots against each <span class="math inline">\(X\)</span> in data.</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># get residuals</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot against each X</span></span>
<span><span class="va">nms_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data_sample</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">map2</span><span class="op">(</span><span class="va">data_sample</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">nms_x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">e</span>, main <span class="op">=</span> <span class="va">nm</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html">lowess</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">e</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-17-4.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$X1
NULL

$X2
NULL

$X3
NULL

$X4
NULL</code></pre>
</div>
</div>
<p>Note that there is no pattern for important predictors included in the model or for the unnecessary predictor. BUT for the important predictor <span class="math inline">\(X_3\)</span> omitted from the model, there is clear systematic deviation!</p>
<p>This indicates that it should be in the model.</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Create residual plots.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fit new model without polyomial predictor</span></span>
<span><span class="va">mod_no_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">mod_mlr</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">X1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">mod_no_poly</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term        estimate std.error statistic     p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 (Intercept)   16.8       2.92      5.73  0.000000789
2 X1             5.04      1.05      4.78  0.0000192  
3 X2             1.89      1.00      1.89  0.0655     
4 X4             0.977     1.05      0.934 0.355      
5 I(X1 * X2)     3.01      0.475     6.33  0.000000103</code></pre>
</div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># see residuals vs fitted</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod_no_poly</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-18-4.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># get residuals</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mod_no_poly</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot against each X</span></span>
<span><span class="va">nms_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data_sample</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">map2</span><span class="op">(</span><span class="va">data_sample</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">nms_x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">e</span>, main <span class="op">=</span> <span class="va">nm</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html">lowess</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">e</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-18-5.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-18-6.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-18-7.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-18-8.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$X1
NULL

$X2
NULL

$X3
NULL

$X4
NULL</code></pre>
</div>
</div>
<p>Note that there is curvature in the residuals vs fitted. Then when viewing vs each predictor, it is clear that it comes from <span class="math inline">\(X_1\)</span>!</p>
<p>This indicates that a polynomial term for <span class="math inline">\(X_1\)</span> should be in the model.</p>
<p>Also note that missing the polynomial term hides the effect of missing <span class="math inline">\(X_3\)</span> <span class="math inline">\(\Longrightarrow\)</span> Need to model the terms in there correctly first before looking at more variables.</p>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p>Create residual plots.</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fit new model without polyomial predictor</span></span>
<span><span class="va">mod_no_interaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">mod_mlr</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">X1</span><span class="op">*</span><span class="va">X2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">mod_no_interaction</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)    -1.59     2.61     -0.609 5.46e- 1
2 X1              2.14     0.812     2.63  1.15e- 2
3 X2              1.79     0.703     2.54  1.47e- 2
4 X4             -1.25     0.685    -1.82  7.48e- 2
5 I(X1^2)         2.50     0.221    11.3   9.98e-15</code></pre>
</div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># see residuals vs fitted</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod_no_interaction</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-19-4.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># get residuals</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mod_no_interaction</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot against each X</span></span>
<span><span class="va">nms_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data_sample</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">map2</span><span class="op">(</span><span class="va">data_sample</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">nms_x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">e</span>, main <span class="op">=</span> <span class="va">nm</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html">lowess</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">e</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-19-5.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-19-6.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-19-7.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes-multiple-regression-1_files/figure-html/unnamed-chunk-19-8.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$X1
NULL

$X2
NULL

$X3
NULL

$X4
NULL</code></pre>
</div>
</div>
<p>Note that there is maybe a slight pattern with respect to <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>, but definitely harder to detect.</p>
<p>hardt o tell if should include an interaction or not, obviosuly it should be based on the known true model.</p>
<p>Also note that again this hides the effect of missing <span class="math inline">\(X_3\)</span>, just like the previous one.</p>
</div>
</div>
</div>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./part2-mlr.html" class="pagination-link  aria-label=" multiple="" linear="" regression="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Multiple linear regression</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./notes-multiple-regression-2.html" class="pagination-link" aria-label="<span class='chapter-number'>6</span>&nbsp; <span class='chapter-title'>Multiple regression 2</span>">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Multiple regression 2</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb62" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Multiple regression 1</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-prereqs</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr options</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"_common.R"</span>)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % define LaTeX macros (/shortcuts) --&gt;</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % define vector (without parentheses, so when writing out in like a definition) of the form X_1, ..., X_n, where X and n are variable. </span><span class="al">NOTE</span><span class="co">: to call use $\vecn{X}{n}$ --&gt;</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>\newcommand{\vecn}<span class="co">[</span><span class="ot">2</span><span class="co">]</span>{#1_1, \ldots, #1_{#2}}</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % shortcut for ~ 'Named dist ' in normal font with space before parameters would go --&gt;</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>\newcommand{\follow}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\sim \text{#1}\,}</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % (followsp is short for 'follow special') shortcut that can be used for iid or ind ~ 'Named dist ' in normal font with space before parameters would go --&gt;</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>\newcommand{\followsp}<span class="co">[</span><span class="ot">2</span><span class="co">]</span>{\overset{#1}\sim \text{#2}\,}</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % define independence symbol (it basically makes two orthogonal symbols very close to each other. The number of \! controls the space between each of the orthogonal symbols) --&gt;</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>\newcommand{\ind}{\perp <span class="sc">\!\!\!</span> \perp}</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % shortcut for Cov(X,Y) with formatting for Cov --&gt;</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>\newcommand{\cov}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\mathrm{Cov}(#1)}</span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % shortcut for Corr(X,Y) with formatting for Corr --&gt;</span></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>\newcommand{\corr}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\mathrm{Corr}(#1)}</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % shortcut for non-italic e in math mode --&gt;</span></span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>\newcommand{\e}{\mathrm{e}}</span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % shortcut for matrix notation --&gt;</span></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>\newcommand{\mat}<span class="co">[</span><span class="ot">3</span><span class="co">]</span>{\underset{#2 \times #3}{\boldsymbol{#1}}}</span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>Multiple regression analysis is one of the most widely used of all statistical methods. In this section, we first discuss a variety of multiple regression models.</span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a>Since the matrix expressions for multiple regression are the same as for simple linear regression, can just refer to @sec-matrix-slr.</span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a>The need for multiple predictors</span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Often times, a single predictor variable in the model provides an inadequate description since a number of key variables affect the response variable in important and distinctive ways.</span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Furthermore, in situations like this, we frequently find that predictions of the response variable based on a model containing only a single predictor variable are too imprecise to be useful.</span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Multiple predictors is useful in observational studies when there is no control over the variables as well as in experimental situations where the experimenter can control the $X$ levels and investigate different combination simultaneously.</span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple regression models</span></span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true" tabindex="-1"></a><span class="fu">### First order model with two predictors {#sec-first-order-two-preds}</span></span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true" tabindex="-1"></a>When there are two predictor variables $X_l$ and $X_2$, the regression model:</span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true" tabindex="-1"></a>$$Y_i = \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2} + \epsilon_i$$</span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-71"><a href="#cb62-71" aria-hidden="true" tabindex="-1"></a>This model is still linear in its predictors. It follows that if $E(\epsilon_i) = 0$</span>
<span id="cb62-72"><a href="#cb62-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-73"><a href="#cb62-73" aria-hidden="true" tabindex="-1"></a>$$E(Y_i) = \beta_0 + \beta_1 X_1 + \beta_1 X_2$$</span>
<span id="cb62-74"><a href="#cb62-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-75"><a href="#cb62-75" aria-hidden="true" tabindex="-1"></a>Note that now predictions are a plane and any point on the response plane corresponds to the mean response $E(Y)$ at the given combination of levels of $X_1$ and $X_2$.</span>
<span id="cb62-76"><a href="#cb62-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-77"><a href="#cb62-77" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/response-plane.png)</span>{width="50%"}</span>
<span id="cb62-78"><a href="#cb62-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-79"><a href="#cb62-79" aria-hidden="true" tabindex="-1"></a>Here the vertical distance from $Y_i$ to the response plane represents the error term $\epsilon_i = Y_i - E(Y)$.</span>
<span id="cb62-80"><a href="#cb62-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-81"><a href="#cb62-81" aria-hidden="true" tabindex="-1"></a>Frequently the regression function in multiple regression is called a *regression surface* or a *response surface*.</span>
<span id="cb62-82"><a href="#cb62-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-83"><a href="#cb62-83" aria-hidden="true" tabindex="-1"></a>Meaning of regression coefficients</span>
<span id="cb62-84"><a href="#cb62-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-85"><a href="#cb62-85" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The parameter $\beta_0$ is the intercept of the regression plane.</span>
<span id="cb62-86"><a href="#cb62-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-87"><a href="#cb62-87" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>If the scope of the model includes $X_1 = 0$ and $X_2 = 0$, then $\beta_0 = 10$ for example represents the mean response $E(Y)$ at $X_1 = 0$ and $X_2 = 0$.</span>
<span id="cb62-88"><a href="#cb62-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-89"><a href="#cb62-89" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The parameter $\beta_1$ indicates the change in the mean response $E(Y)$ per unit increase in $X_1$ when $X_2$ is held constant. Same but reverse for $\beta_2$.</span>
<span id="cb62-90"><a href="#cb62-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-91"><a href="#cb62-91" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>For example: If $E(Y) = 10 + 2X_1 + 5X_2$ and the level of $X_2$ is held at 2, then $E(Y) = 10 + 2X_1 + 5(2) = 20 + 2X_1$.</span>
<span id="cb62-92"><a href="#cb62-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-93"><a href="#cb62-93" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>This response function is a straight line with slope $\beta_1 = 2$. This is true for all other values of $X_2$, only the value of the intercept changes.</span>
<span id="cb62-94"><a href="#cb62-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-95"><a href="#cb62-95" aria-hidden="true" tabindex="-1"></a>Additive models vs interaction models</span>
<span id="cb62-96"><a href="#cb62-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-97"><a href="#cb62-97" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When the effect of $X_1$ on the mean response does not depend on the level of $X_2$, and correspondingly the effect of $X_2$ does not depend on the level of $X_1$, the two predictor variables are said to have *additive effects* or not to *interact*.</span>
<span id="cb62-98"><a href="#cb62-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-99"><a href="#cb62-99" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Thus, the first-order regression model is designed for predictor variables whose effects on the mean response are additive or do not interact.</span>
<span id="cb62-100"><a href="#cb62-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-101"><a href="#cb62-101" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The parameters $\beta_1$ and $\beta_2$ are sometimes called *partial regression coefficients* because they reflect the partial effect of one predictor variable when the other predictor variable is included in the model and is held constant.</span>
<span id="cb62-102"><a href="#cb62-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-103"><a href="#cb62-103" aria-hidden="true" tabindex="-1"></a><span class="fu">### First order model with more than two predictor variables</span></span>
<span id="cb62-104"><a href="#cb62-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-105"><a href="#cb62-105" aria-hidden="true" tabindex="-1"></a>We consider now the case where there are $p - 1$ predictor variables $X_1, \ldots , X_{p-1}$. The regression model:</span>
<span id="cb62-106"><a href="#cb62-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-107"><a href="#cb62-107" aria-hidden="true" tabindex="-1"></a>$$Y_i = \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2} + \cdots + \beta_{p-1} X_{i,p-1} + \epsilon_i$$ {#eq-first-order-all-preds}</span>
<span id="cb62-108"><a href="#cb62-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-109"><a href="#cb62-109" aria-hidden="true" tabindex="-1"></a>is called a first-order model with $p - 1$ predictor variables. It can also be written as:</span>
<span id="cb62-110"><a href="#cb62-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-111"><a href="#cb62-111" aria-hidden="true" tabindex="-1"></a>$$Y_i = \beta_0 + \sum_{k = 1}^{p - 1} \beta_k X_{ik} + \epsilon_i$$</span>
<span id="cb62-112"><a href="#cb62-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-113"><a href="#cb62-113" aria-hidden="true" tabindex="-1"></a>It follows that if $E(\epsilon_i) = 0$</span>
<span id="cb62-114"><a href="#cb62-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-115"><a href="#cb62-115" aria-hidden="true" tabindex="-1"></a>$$E(Y_i) =  \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2} + \cdots + \beta_{p-1} X_{i,p-1}$$</span>
<span id="cb62-116"><a href="#cb62-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-117"><a href="#cb62-117" aria-hidden="true" tabindex="-1"></a>Notes about model:</span>
<span id="cb62-118"><a href="#cb62-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-119"><a href="#cb62-119" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This response function is a *hyperplane*, which is a plane in more than two dimensions. It is no longer possible to picture this plane.</span>
<span id="cb62-120"><a href="#cb62-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-121"><a href="#cb62-121" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The meaning of the parameters is the same as when there were two predictors, just extended to all other $X$ levels held constant.</span>
<span id="cb62-122"><a href="#cb62-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-123"><a href="#cb62-123" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This first-order regression model is still designed for predictor variables whose effects on the mean response are additive and therefore do interact.</span>
<span id="cb62-124"><a href="#cb62-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-125"><a href="#cb62-125" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When $p - 1 = 1$, this model reduces to the SLR model we are used to.</span>
<span id="cb62-126"><a href="#cb62-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-127"><a href="#cb62-127" aria-hidden="true" tabindex="-1"></a><span class="fu">### General linear regression model</span></span>
<span id="cb62-128"><a href="#cb62-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-129"><a href="#cb62-129" aria-hidden="true" tabindex="-1"></a>In general, the variables $X_1, \ldots, X_{p-1}$ in a regression model do not need to represent different predictor variables, as we will see soon. Therefore, we define the general linear regression model, with normal error terms, simply in terms of $X$ variables (same as before, just now more general of what the $X$s can represent):</span>
<span id="cb62-130"><a href="#cb62-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-131"><a href="#cb62-131" aria-hidden="true" tabindex="-1"></a>$$Y_i = \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2} + \cdots + \beta_{p-1} X_{i,p-1} + \epsilon_i$$ {#eq-gen-reg-mod}</span>
<span id="cb62-132"><a href="#cb62-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-133"><a href="#cb62-133" aria-hidden="true" tabindex="-1"></a>where</span>
<span id="cb62-134"><a href="#cb62-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-135"><a href="#cb62-135" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta_0, \beta_1, \ldots, \beta_{p-1}$ are parameters (note there are $p$ parameters because of the intercept)</span>
<span id="cb62-136"><a href="#cb62-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-137"><a href="#cb62-137" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$X_{i1}, \ldots, X_{i,p-1}$ are known constants</span>
<span id="cb62-138"><a href="#cb62-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-139"><a href="#cb62-139" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\epsilon_i \followsp{iid}{Normal}(0, \sigma^2)$</span>
<span id="cb62-140"><a href="#cb62-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-141"><a href="#cb62-141" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$i = 1, \ldots, n$</span>
<span id="cb62-142"><a href="#cb62-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-143"><a href="#cb62-143" aria-hidden="true" tabindex="-1"></a>Again since $E(\epsilon_i) = 0$,</span>
<span id="cb62-144"><a href="#cb62-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-145"><a href="#cb62-145" aria-hidden="true" tabindex="-1"></a>$$E(Y_i) = \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2} + \cdots + \beta_{p-1} X_{i,p-1}$$</span>
<span id="cb62-146"><a href="#cb62-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-147"><a href="#cb62-147" aria-hidden="true" tabindex="-1"></a>Thus, the general linear regression model with normal error terms implies that the observations $Y_i$ are independent normal variables, with mean $E(Y)$ as given by above and with constant variance $\sigma^2$.</span>
<span id="cb62-148"><a href="#cb62-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-149"><a href="#cb62-149" aria-hidden="true" tabindex="-1"></a>This general linear model encompasses a vast variety of situations. We consider a few of these now.</span>
<span id="cb62-150"><a href="#cb62-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-151"><a href="#cb62-151" aria-hidden="true" tabindex="-1"></a>$p - 1$ predictor variables</span>
<span id="cb62-152"><a href="#cb62-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-153"><a href="#cb62-153" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When $X_1, \ldots, X_{p-1}$ represent $p - 1$ different predictor variables, the general linear regression model above is simply @eq-first-order-all-preds seen earlier (first-order model in which there are no interaction effects between the predictor variables).</span>
<span id="cb62-154"><a href="#cb62-154" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-155"><a href="#cb62-155" aria-hidden="true" tabindex="-1"></a>Qualitative predictors</span>
<span id="cb62-156"><a href="#cb62-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-157"><a href="#cb62-157" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Model in @eq-gen-reg-mod encompasses not only quantitative predictor variables but also qualitative ones.</span>
<span id="cb62-158"><a href="#cb62-158" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-159"><a href="#cb62-159" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>We use indicator variables that take on the values 0 and 1 to identify the classes of a qualitative variable. For example if length of hospital stay $Y$ with $X_1$ = age and $X_2$ = gender of patient where:</span>
<span id="cb62-160"><a href="#cb62-160" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-161"><a href="#cb62-161" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb62-162"><a href="#cb62-162" aria-hidden="true" tabindex="-1"></a> X_2 =</span>
<span id="cb62-163"><a href="#cb62-163" aria-hidden="true" tabindex="-1"></a>   \left<span class="sc">\{</span></span>
<span id="cb62-164"><a href="#cb62-164" aria-hidden="true" tabindex="-1"></a>   \begin{array}{ll}</span>
<span id="cb62-165"><a href="#cb62-165" aria-hidden="true" tabindex="-1"></a>     0 &amp; \text{female}<span class="sc">\\</span></span>
<span id="cb62-166"><a href="#cb62-166" aria-hidden="true" tabindex="-1"></a>     1 &amp; \text{male}</span>
<span id="cb62-167"><a href="#cb62-167" aria-hidden="true" tabindex="-1"></a>  \end{array}</span>
<span id="cb62-168"><a href="#cb62-168" aria-hidden="true" tabindex="-1"></a>  \right.</span>
<span id="cb62-169"><a href="#cb62-169" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb62-170"><a href="#cb62-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-171"><a href="#cb62-171" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The first-order regression model is (with variables defined above):</span>
<span id="cb62-172"><a href="#cb62-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-173"><a href="#cb62-173" aria-hidden="true" tabindex="-1"></a>$$Y_i = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \epsilon_i$$</span>
<span id="cb62-174"><a href="#cb62-174" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The response function is</span>
<span id="cb62-175"><a href="#cb62-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-176"><a href="#cb62-176" aria-hidden="true" tabindex="-1"></a>$$E(Y_i) = \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2}$$</span>
<span id="cb62-177"><a href="#cb62-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-178"><a href="#cb62-178" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For female patients, $X_2 = 0$ and the response function becomes</span>
<span id="cb62-179"><a href="#cb62-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-180"><a href="#cb62-180" aria-hidden="true" tabindex="-1"></a>$$E(Y_i) = \beta_0 + \beta_1 X_{i1}$$</span>
<span id="cb62-181"><a href="#cb62-181" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For male patients, $X_2 = 1$ and the response function becomes</span>
<span id="cb62-182"><a href="#cb62-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-183"><a href="#cb62-183" aria-hidden="true" tabindex="-1"></a>$$E(Y_i) = (\beta_0 + \beta_2) + \beta_1 X_{i1}$$</span>
<span id="cb62-184"><a href="#cb62-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-185"><a href="#cb62-185" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>These two response functions represent parallel straight lines with different intercepts.</span>
<span id="cb62-186"><a href="#cb62-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-187"><a href="#cb62-187" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In general, we represent a qualitative variable with $c$ classes by means of $c - 1$ indicator variables.</span>
<span id="cb62-188"><a href="#cb62-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-189"><a href="#cb62-189" aria-hidden="true" tabindex="-1"></a>Polynomial regression</span>
<span id="cb62-190"><a href="#cb62-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-191"><a href="#cb62-191" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Polynomial regression models are special cases of the general linear regression model. They contain squared and higher-order terms of the predictor variable(s), making the response function curvilinear.</span>
<span id="cb62-192"><a href="#cb62-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-193"><a href="#cb62-193" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The following is a polynomial regres'sion model with one predictor variable:</span>
<span id="cb62-194"><a href="#cb62-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-195"><a href="#cb62-195" aria-hidden="true" tabindex="-1"></a>$$Y_i = \beta_0 + \beta_1 X_i1 + \beta_2 X_i^2+ \epsilon_i$$</span>
<span id="cb62-196"><a href="#cb62-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-197"><a href="#cb62-197" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Despite the curvilinear nature of the response function for regression model above, it is a special casee of general linear regression model @eq-gen-reg-mod. If we let $X_{i1} = X_i$ and $X_{i2} = X_i^2$, we can write the above model in the same format as usual:</span>
<span id="cb62-198"><a href="#cb62-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-199"><a href="#cb62-199" aria-hidden="true" tabindex="-1"></a>$$Y_i = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \epsilon_i$$</span>
<span id="cb62-200"><a href="#cb62-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-201"><a href="#cb62-201" aria-hidden="true" tabindex="-1"></a>Transformed variables</span>
<span id="cb62-202"><a href="#cb62-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-203"><a href="#cb62-203" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Models with transformed variables involve complex, curvilinear response functions, yet still are special cases of the general linear regression model. Consider the following model with transformed $Y$ variable</span>
<span id="cb62-204"><a href="#cb62-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-205"><a href="#cb62-205" aria-hidden="true" tabindex="-1"></a>$$\ln(Y_i) = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \beta_3 X_{i3} + \epsilon_i$$</span>
<span id="cb62-206"><a href="#cb62-206" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Here, the response surface is complex, yet this model can still be treated as a general linear regression model if we let $Y_i' = \ln(Y_i)$. Then just write the regression model as:</span>
<span id="cb62-207"><a href="#cb62-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-208"><a href="#cb62-208" aria-hidden="true" tabindex="-1"></a>$$Y_i' = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \beta_3 X_{i3} + \epsilon_i$$</span>
<span id="cb62-209"><a href="#cb62-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-210"><a href="#cb62-210" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This has the same form as @eq-gen-reg-mod, the response variable just happens to be the natural logarithm of $Y$.</span>
<span id="cb62-211"><a href="#cb62-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-212"><a href="#cb62-212" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Many models can be transformed into the g'enerallinear regression model. For example, take this model:</span>
<span id="cb62-213"><a href="#cb62-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-214"><a href="#cb62-214" aria-hidden="true" tabindex="-1"></a>$$Y_i = \frac{1}{\beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \epsilon_i}$$</span>
<span id="cb62-215"><a href="#cb62-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-216"><a href="#cb62-216" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>It can be transformed to the general linear regression model by letting $Y_i' = 1/Y_i$. Then we have</span>
<span id="cb62-217"><a href="#cb62-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-218"><a href="#cb62-218" aria-hidden="true" tabindex="-1"></a>$$Y_i' = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \epsilon_i$$</span>
<span id="cb62-219"><a href="#cb62-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-220"><a href="#cb62-220" aria-hidden="true" tabindex="-1"></a>Interaction effects</span>
<span id="cb62-221"><a href="#cb62-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-222"><a href="#cb62-222" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When the effects of the predictor variables on the response variable are not additive, the effect of one predictor variable depends on the levels of the other predictor variables.</span>
<span id="cb62-223"><a href="#cb62-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-224"><a href="#cb62-224" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Our general linear regression model encompasses regression models with nonadditive or interacting effects. An example of a nonadditive regression model with two predictor variables $X_1$ and $X_2$ is the following:</span>
<span id="cb62-225"><a href="#cb62-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-226"><a href="#cb62-226" aria-hidden="true" tabindex="-1"></a>$$Y_i = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \beta_3 X_{i1} X_{i2} + \epsilon_i$$</span>
<span id="cb62-227"><a href="#cb62-227" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Here the response function is complex because of the interaction term $\beta_3 X_{i1} X_{i2}$. Yet this regression model is still a special case of the general linear regression model. Let $X_3i = X_{i1} X_{i2}$ and then write the model as:</span>
<span id="cb62-228"><a href="#cb62-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-229"><a href="#cb62-229" aria-hidden="true" tabindex="-1"></a>$$Y_i = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \beta_3 X_{i3} + \epsilon_i$$</span>
<span id="cb62-230"><a href="#cb62-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-231"><a href="#cb62-231" aria-hidden="true" tabindex="-1"></a>Combination of cases</span>
<span id="cb62-232"><a href="#cb62-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-233"><a href="#cb62-233" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A regression model may combine several of the elements we have just noted and still be treated as a general linear regression model.</span>
<span id="cb62-234"><a href="#cb62-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-235"><a href="#cb62-235" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/complex-model.png)</span>{width="50%"}</span>
<span id="cb62-236"><a href="#cb62-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-237"><a href="#cb62-237" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Examples of complex regression surfaces for two predictors:</span>
<span id="cb62-238"><a href="#cb62-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-239"><a href="#cb62-239" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/regression-surfaces.png)</span>{width="50%"}</span>
<span id="cb62-240"><a href="#cb62-240" aria-hidden="true" tabindex="-1"></a>Meaning of linear in general linear regression model</span>
<span id="cb62-241"><a href="#cb62-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-242"><a href="#cb62-242" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>It should be clear from the various examples that general linear regression model @eq-gen-reg-mod is not restricted to linear response surfaces.</span>
<span id="cb62-243"><a href="#cb62-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-244"><a href="#cb62-244" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The term *linear model* refers to the fact that the model is linear in the parameters; it does-not refer to the shape of the response surface.</span>
<span id="cb62-245"><a href="#cb62-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-246"><a href="#cb62-246" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>We say that a regression model is linear in the parameters when it can be written in the form:</span>
<span id="cb62-247"><a href="#cb62-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-248"><a href="#cb62-248" aria-hidden="true" tabindex="-1"></a>$$Y_i = c_{i0} \beta_0 + c_{i1} \beta_1 + c_{i2} \beta_2 + \cdots + c_{i,p-1} \beta_{p-1} + \epsilon_i$$ {#eq-lin-mod}</span>
<span id="cb62-249"><a href="#cb62-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-250"><a href="#cb62-250" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Here the terms $c_{i0}, c_{i1}, \ldots$ are coefficients involving the predictor variables. For example, take the first-order model with two variables:</span>
<span id="cb62-251"><a href="#cb62-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-252"><a href="#cb62-252" aria-hidden="true" tabindex="-1"></a>$$Y_i = \beta_0 + \beta_1 X_{i1} + \beta_1 X_{i2} + \epsilon_i$$</span>
<span id="cb62-253"><a href="#cb62-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-254"><a href="#cb62-254" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This is linear in  parameters with $c_{i0} = 1$, $c_{i1} = X_{i1}$ and $c_{i2} = X_{i2}$.</span>
<span id="cb62-255"><a href="#cb62-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-256"><a href="#cb62-256" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>An example of a nonlinear regression model is the following:</span>
<span id="cb62-257"><a href="#cb62-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-258"><a href="#cb62-258" aria-hidden="true" tabindex="-1"></a>$$Y_i = \beta_0 \e^{\beta_1 X_i} + \epsilon_i$$</span>
<span id="cb62-259"><a href="#cb62-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-260"><a href="#cb62-260" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This is a nonlinear regression model because it cannot be expressed in the form of @eq-lin-mod.</span>
<span id="cb62-261"><a href="#cb62-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-262"><a href="#cb62-262" aria-hidden="true" tabindex="-1"></a><span class="fu">## General linear regression model in matrix terms {#sec-main-mlr-demo}</span></span>
<span id="cb62-263"><a href="#cb62-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-264"><a href="#cb62-264" aria-hidden="true" tabindex="-1"></a>It is a remarkable property of matrix algebra that the results for the general linear regression model @eq-gen-reg-mod in matrix notation appear exactly as those for the simple linear regression model @eq-slr-matrix-mod. Only the degrees of freedom and other constants related to the number of $X$ variables and the dimensions of some matrices are different. Hence, We are able to present the results very concisely.</span>
<span id="cb62-265"><a href="#cb62-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-266"><a href="#cb62-266" aria-hidden="true" tabindex="-1"></a>We need the following matrices:</span>
<span id="cb62-267"><a href="#cb62-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-268"><a href="#cb62-268" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mlr-matrices.png)</span>{width="50%"}</span>
<span id="cb62-269"><a href="#cb62-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-270"><a href="#cb62-270" aria-hidden="true" tabindex="-1"></a>Everything is just extended to $p$ parameters and $p - 1$ predictor variables.</span>
<span id="cb62-271"><a href="#cb62-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-272"><a href="#cb62-272" aria-hidden="true" tabindex="-1"></a>In matrix terms, the general linear regression model @eq-gen-reg-mod is:</span>
<span id="cb62-273"><a href="#cb62-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-274"><a href="#cb62-274" aria-hidden="true" tabindex="-1"></a>$$\mat{Y}{n}{1} = \mat{X}{n}{p} \, \mat{\beta}{p}{1} + \mat{\epsilon}{n}{1} \hspace{10pt} \text{and} \hspace{10pt} \mat{E(Y)}{n}{1} = \mat{X\beta}{n}{1}$$ {#eq-mlr-matrix-mod}</span>
<span id="cb62-275"><a href="#cb62-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-276"><a href="#cb62-276" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimation of regression coefficients, fitted values and residuals</span></span>
<span id="cb62-277"><a href="#cb62-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-278"><a href="#cb62-278" aria-hidden="true" tabindex="-1"></a>This is also the exact same, just extended (see @sec-slr-matrix).</span>
<span id="cb62-279"><a href="#cb62-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-280"><a href="#cb62-280" aria-hidden="true" tabindex="-1"></a>$\mat{\hat{\beta}}{p}{1} = (\mat{X'X}{p}{p})^{-1}\mat{X'Y}{p}{1}$</span>
<span id="cb62-281"><a href="#cb62-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-282"><a href="#cb62-282" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mlr-mle.png)</span>{width="80%"}</span>
<span id="cb62-283"><a href="#cb62-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-284"><a href="#cb62-284" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mlr-matrix-form.png)</span>{width="80%"}</span>
<span id="cb62-285"><a href="#cb62-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-286"><a href="#cb62-286" aria-hidden="true" tabindex="-1"></a>Demo </span>
<span id="cb62-287"><a href="#cb62-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-288"><a href="#cb62-288" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb62-289"><a href="#cb62-289" aria-hidden="true" tabindex="-1"></a><span class="fu">#### R functions</span></span>
<span id="cb62-290"><a href="#cb62-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-291"><a href="#cb62-291" aria-hidden="true" tabindex="-1"></a>(True) Population model: $Y = \beta_0 + \beta_1 Z_1 + \beta_2 Z_2 + \beta_3 Z_3 + \beta_4 Z_4 + \beta_5 Z_5 + \epsilon_i$</span>
<span id="cb62-292"><a href="#cb62-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-293"><a href="#cb62-293" aria-hidden="true" tabindex="-1"></a>where $\hspace{10pt} Z_1 = X_1, Z_2 = X_2, Z_3 = X_3, Z_4 = X_1^2, Z_5 = X_1 X_2 \hspace{10pt} \text{and} \hspace{10pt} \epsilon_i \followsp{iid}{Normal}(0, \sigma^2)$</span>
<span id="cb62-294"><a href="#cb62-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-297"><a href="#cb62-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-298"><a href="#cb62-298" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: generating a single dataset (and fitting single model) to use for all of the following examples</span></span>
<span id="cb62-299"><a href="#cb62-299" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; so incorporating lots of aspects into this model (polynomial, interaction, omitted predictor, unnecessary predictor)</span></span>
<span id="cb62-300"><a href="#cb62-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-301"><a href="#cb62-301" aria-hidden="true" tabindex="-1"></a><span class="co"># generate predictor data</span></span>
<span id="cb62-302"><a href="#cb62-302" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; num_x number of base predictors (assumed known; generated from same dist)</span></span>
<span id="cb62-303"><a href="#cb62-303" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; num_noise unimportant predictors (placed at end)</span></span>
<span id="cb62-304"><a href="#cb62-304" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; hardcoded 2 higher order / interaction terms (X1^2 and X1*X2)</span></span>
<span id="cb62-305"><a href="#cb62-305" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb62-306"><a href="#cb62-306" aria-hidden="true" tabindex="-1"></a>num_x <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb62-307"><a href="#cb62-307" aria-hidden="true" tabindex="-1"></a>num_noise <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-308"><a href="#cb62-308" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>(num_x<span class="sc">+</span>num_noise), <span class="cf">function</span>(i) {<span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)})</span>
<span id="cb62-309"><a href="#cb62-309" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), X[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>num_x)], X[, <span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>, X[, <span class="dv">1</span>] <span class="sc">*</span> X[ , <span class="dv">2</span>], X[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>num_x)])</span>
<span id="cb62-310"><a href="#cb62-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-311"><a href="#cb62-311" aria-hidden="true" tabindex="-1"></a><span class="co"># set betas according to which ones are noise (and intercept)</span></span>
<span id="cb62-312"><a href="#cb62-312" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">2</span>, num_x<span class="sc">+</span><span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">0</span>, num_noise))</span>
<span id="cb62-313"><a href="#cb62-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-314"><a href="#cb62-314" aria-hidden="true" tabindex="-1"></a><span class="co"># generate mean response and add random error</span></span>
<span id="cb62-315"><a href="#cb62-315" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> Z <span class="sc">%*%</span> betas <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb62-316"><a href="#cb62-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-317"><a href="#cb62-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-318"><a href="#cb62-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-319"><a href="#cb62-319" aria-hidden="true" tabindex="-1"></a>(Fitted) Population model: $Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_4 + \beta_5 X_1^2 + \beta_6 X_2 X_3$</span>
<span id="cb62-320"><a href="#cb62-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-323"><a href="#cb62-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-324"><a href="#cb62-324" aria-hidden="true" tabindex="-1"></a><span class="co"># create dataframe of sample data using above</span></span>
<span id="cb62-325"><a href="#cb62-325" aria-hidden="true" tabindex="-1"></a>data_sample <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Y, X) <span class="sc">%&gt;%</span> data.frame</span>
<span id="cb62-326"><a href="#cb62-326" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_sample) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Y"</span>, <span class="fu">paste0</span>(<span class="st">"X"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(data_sample)<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb62-327"><a href="#cb62-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-328"><a href="#cb62-328" aria-hidden="true" tabindex="-1"></a><span class="co"># fit mlr regression model</span></span>
<span id="cb62-329"><a href="#cb62-329" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; omitting X3, adding in unnecessary predictor X4, and adding in correct higher order terms</span></span>
<span id="cb62-330"><a href="#cb62-330" aria-hidden="true" tabindex="-1"></a>mod_mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X4 <span class="sc">+</span> <span class="fu">I</span>(X1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(X1<span class="sc">*</span>X2), <span class="at">data =</span> data_sample, <span class="at">x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-331"><a href="#cb62-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-332"><a href="#cb62-332" aria-hidden="true" tabindex="-1"></a><span class="co"># view model summary</span></span>
<span id="cb62-333"><a href="#cb62-333" aria-hidden="true" tabindex="-1"></a><span class="co"># now using broom functions</span></span>
<span id="cb62-334"><a href="#cb62-334" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; see expected results</span></span>
<span id="cb62-335"><a href="#cb62-335" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(mod_mlr)</span>
<span id="cb62-336"><a href="#cb62-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-337"><a href="#cb62-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-338"><a href="#cb62-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-339"><a href="#cb62-339" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Manual (matrices)</span></span>
<span id="cb62-340"><a href="#cb62-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-341"><a href="#cb62-341" aria-hidden="true" tabindex="-1"></a>Now comparing lots of things</span>
<span id="cb62-342"><a href="#cb62-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-345"><a href="#cb62-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-346"><a href="#cb62-346" aria-hidden="true" tabindex="-1"></a><span class="co"># extract design matrix from model for simplicity</span></span>
<span id="cb62-347"><a href="#cb62-347" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> mod_mlr<span class="sc">$</span>x</span>
<span id="cb62-348"><a href="#cb62-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-349"><a href="#cb62-349" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate coefficients</span></span>
<span id="cb62-350"><a href="#cb62-350" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; betas_hat = (X'X)^(-1) X'Y</span></span>
<span id="cb62-351"><a href="#cb62-351" aria-hidden="true" tabindex="-1"></a>betas_hat <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(design) <span class="sc">%*%</span> design) <span class="sc">%*%</span> <span class="fu">t</span>(design) <span class="sc">%*%</span> Y</span>
<span id="cb62-352"><a href="#cb62-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-353"><a href="#cb62-353" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="fu">coef</span>(mod_mlr), betas_hat)</span>
<span id="cb62-354"><a href="#cb62-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-355"><a href="#cb62-355" aria-hidden="true" tabindex="-1"></a><span class="co"># fitted values</span></span>
<span id="cb62-356"><a href="#cb62-356" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> design <span class="sc">%*%</span> betas_hat</span>
<span id="cb62-357"><a href="#cb62-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-358"><a href="#cb62-358" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="fu">fitted</span>(mod_mlr), <span class="fu">as.numeric</span>(y_hat), <span class="at">return_items =</span> <span class="cn">FALSE</span>)</span>
<span id="cb62-359"><a href="#cb62-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-360"><a href="#cb62-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-361"><a href="#cb62-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-362"><a href="#cb62-362" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-363"><a href="#cb62-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-364"><a href="#cb62-364" aria-hidden="true" tabindex="-1"></a><span class="fu">### ANOVA {#sec-anova-matrices}</span></span>
<span id="cb62-365"><a href="#cb62-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-366"><a href="#cb62-366" aria-hidden="true" tabindex="-1"></a>Sum of squares are the exact same as in @sec-slr-anova-matrix, just the degrees of freedom are adjusted for the mean squares.</span>
<span id="cb62-367"><a href="#cb62-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-368"><a href="#cb62-368" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$SSTO$ has the usual $n - 1$ df.</span>
<span id="cb62-369"><a href="#cb62-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-370"><a href="#cb62-370" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$SSE$ had $n - p$ df due to $p$ parameters needed to be estimated in the regression model @eq-mlr-matrix-mod.</span>
<span id="cb62-371"><a href="#cb62-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-372"><a href="#cb62-372" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$SSR$ has $p - 1$ df, representing the number of $X$ variables $X_1, \ldots, X_{p-1}$ (one minus the number of parameters because the intercept doesn't count)</span>
<span id="cb62-373"><a href="#cb62-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-374"><a href="#cb62-374" aria-hidden="true" tabindex="-1"></a>$$MSR = \frac{SSR}{p - 1} \hspace{20pt} MSE = \frac{SSE}{n - p}$$</span>
<span id="cb62-375"><a href="#cb62-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-376"><a href="#cb62-376" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/expected-ms-mlr.png)</span>{width="80%"}</span>
<span id="cb62-377"><a href="#cb62-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-378"><a href="#cb62-378" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mlr-anova-table.png)</span>{width="80%"}</span>
<span id="cb62-379"><a href="#cb62-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-380"><a href="#cb62-380" aria-hidden="true" tabindex="-1"></a>Demo</span>
<span id="cb62-381"><a href="#cb62-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-382"><a href="#cb62-382" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb62-383"><a href="#cb62-383" aria-hidden="true" tabindex="-1"></a><span class="fu">#### R functions</span></span>
<span id="cb62-384"><a href="#cb62-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-385"><a href="#cb62-385" aria-hidden="true" tabindex="-1"></a>Returning to the demo in @sec-main-mlr-demo.</span>
<span id="cb62-386"><a href="#cb62-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-389"><a href="#cb62-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-390"><a href="#cb62-390" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate anova table</span></span>
<span id="cb62-391"><a href="#cb62-391" aria-hidden="true" tabindex="-1"></a>(at <span class="ot">&lt;-</span> mod_mlr <span class="sc">%&gt;%</span> anova <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>())</span>
<span id="cb62-392"><a href="#cb62-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-393"><a href="#cb62-393" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate sum of squares</span></span>
<span id="cb62-394"><a href="#cb62-394" aria-hidden="true" tabindex="-1"></a>ssto <span class="ot">&lt;-</span> at <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="fu">sum</span>(sumsq))</span>
<span id="cb62-395"><a href="#cb62-395" aria-hidden="true" tabindex="-1"></a>sse <span class="ot">&lt;-</span> at <span class="sc">%&gt;%</span> <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"Residuals"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(sumsq)</span>
<span id="cb62-396"><a href="#cb62-396" aria-hidden="true" tabindex="-1"></a>ssr <span class="ot">&lt;-</span> ssto <span class="sc">-</span> sse</span>
<span id="cb62-397"><a href="#cb62-397" aria-hidden="true" tabindex="-1"></a>ssr <span class="ot">&lt;-</span> at <span class="sc">%&gt;%</span> <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"Residuals"</span>) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="fu">sum</span>(sumsq))</span>
<span id="cb62-398"><a href="#cb62-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-399"><a href="#cb62-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-400"><a href="#cb62-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-401"><a href="#cb62-401" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Manual (matrices)</span></span>
<span id="cb62-402"><a href="#cb62-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-405"><a href="#cb62-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-406"><a href="#cb62-406" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate sum of squares using quadratic forms</span></span>
<span id="cb62-407"><a href="#cb62-407" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; SSTO = Y'[I-(1/n)J]Y </span></span>
<span id="cb62-408"><a href="#cb62-408" aria-hidden="true" tabindex="-1"></a>SSTO <span class="ot">&lt;-</span> <span class="fu">t</span>(Y) <span class="sc">%*%</span> (<span class="fu">diag</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="fu">length</span>(Y)) <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">length</span>(Y)) <span class="sc">*</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(Y)<span class="sc">^</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="fu">length</span>(Y), <span class="at">ncol =</span> <span class="fu">length</span>(Y))) <span class="sc">%*%</span> Y</span>
<span id="cb62-409"><a href="#cb62-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-410"><a href="#cb62-410" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; SSE = Y'(I-H)Y</span></span>
<span id="cb62-411"><a href="#cb62-411" aria-hidden="true" tabindex="-1"></a>hat_matrix <span class="ot">&lt;-</span> design <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">t</span>(design) <span class="sc">%*%</span> design) <span class="sc">%*%</span> <span class="fu">t</span>(design)</span>
<span id="cb62-412"><a href="#cb62-412" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">t</span>(Y) <span class="sc">%*%</span> (Matrix<span class="sc">::</span><span class="fu">diag</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="fu">length</span>(Y)) <span class="sc">-</span> hat_matrix) <span class="sc">%*%</span> Y</span>
<span id="cb62-413"><a href="#cb62-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-414"><a href="#cb62-414" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="fu">as.numeric</span>(sse), <span class="fu">as.numeric</span>(SSE))</span>
<span id="cb62-415"><a href="#cb62-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-416"><a href="#cb62-416" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; SSR = Y'[H-(1/n)J]Y </span></span>
<span id="cb62-417"><a href="#cb62-417" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">t</span>(Y) <span class="sc">%*%</span> (hat_matrix <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">length</span>(Y)) <span class="sc">*</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(Y)<span class="sc">^</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="fu">length</span>(Y), <span class="at">ncol =</span> <span class="fu">length</span>(Y))) <span class="sc">%*%</span> Y</span>
<span id="cb62-418"><a href="#cb62-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-419"><a href="#cb62-419" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="fu">as.numeric</span>(ssr), <span class="fu">as.numeric</span>(SSR))</span>
<span id="cb62-420"><a href="#cb62-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-421"><a href="#cb62-421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-422"><a href="#cb62-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-423"><a href="#cb62-423" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-424"><a href="#cb62-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-425"><a href="#cb62-425" aria-hidden="true" tabindex="-1"></a><span class="fu">### F-test for regression relation {#sec-f-test-overall}</span></span>
<span id="cb62-426"><a href="#cb62-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-427"><a href="#cb62-427" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mlr-f-test.png)</span>{width="80%"}</span>
<span id="cb62-428"><a href="#cb62-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-429"><a href="#cb62-429" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb62-430"><a href="#cb62-430" aria-hidden="true" tabindex="-1"></a><span class="fu">#### R functions</span></span>
<span id="cb62-431"><a href="#cb62-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-432"><a href="#cb62-432" aria-hidden="true" tabindex="-1"></a>Returning to the demo in @sec-main-mlr-demo.</span>
<span id="cb62-433"><a href="#cb62-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-436"><a href="#cb62-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-437"><a href="#cb62-437" aria-hidden="true" tabindex="-1"></a><span class="co"># get f-stat model summary</span></span>
<span id="cb62-438"><a href="#cb62-438" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; looking for statistic</span></span>
<span id="cb62-439"><a href="#cb62-439" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(mod_mlr)</span>
<span id="cb62-440"><a href="#cb62-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-441"><a href="#cb62-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-442"><a href="#cb62-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-443"><a href="#cb62-443" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Manual (matrices)</span></span>
<span id="cb62-444"><a href="#cb62-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-445"><a href="#cb62-445" aria-hidden="true" tabindex="-1"></a>Continuing with sum of squares calculated from previous demo in @sec-anova-matrices.</span>
<span id="cb62-446"><a href="#cb62-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-449"><a href="#cb62-449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-450"><a href="#cb62-450" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate sum of squares using quadratic forms</span></span>
<span id="cb62-451"><a href="#cb62-451" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; F = MSR / MSE = (SSR / df_R) / (SSE / df_E)</span></span>
<span id="cb62-452"><a href="#cb62-452" aria-hidden="true" tabindex="-1"></a>MSR <span class="ot">&lt;-</span> SSR <span class="sc">/</span> (<span class="fu">length</span>(betas_hat) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb62-453"><a href="#cb62-453" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> SSE <span class="sc">/</span> (<span class="fu">length</span>(Y) <span class="sc">-</span> <span class="fu">length</span>(betas_hat))</span>
<span id="cb62-454"><a href="#cb62-454" aria-hidden="true" tabindex="-1"></a>F_stat <span class="ot">&lt;-</span> MSR <span class="sc">/</span> MSE</span>
<span id="cb62-455"><a href="#cb62-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-456"><a href="#cb62-456" aria-hidden="true" tabindex="-1"></a><span class="co"># extract mse from model summary</span></span>
<span id="cb62-457"><a href="#cb62-457" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; df = dr_R and df.residual = df_E -&gt; used to get p-value of F-stat</span></span>
<span id="cb62-458"><a href="#cb62-458" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">glance</span>(mod_mlr)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb62-459"><a href="#cb62-459" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="fu">as.numeric</span>(mse), <span class="fu">as.numeric</span>(MSE))</span>
<span id="cb62-460"><a href="#cb62-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-461"><a href="#cb62-461" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(broom<span class="sc">::</span><span class="fu">glance</span>(mod_mlr)<span class="sc">$</span>statistic, <span class="fu">as.numeric</span>(F_stat))</span>
<span id="cb62-462"><a href="#cb62-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-463"><a href="#cb62-463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-464"><a href="#cb62-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-465"><a href="#cb62-465" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-466"><a href="#cb62-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-467"><a href="#cb62-467" aria-hidden="true" tabindex="-1"></a><span class="fu">### Coefficient of multiple determination</span></span>
<span id="cb62-468"><a href="#cb62-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-469"><a href="#cb62-469" aria-hidden="true" tabindex="-1"></a>The coefficient of multiple determination $R^2$ is the same as in SLR:</span>
<span id="cb62-470"><a href="#cb62-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-471"><a href="#cb62-471" aria-hidden="true" tabindex="-1"></a>$$R^2 = \frac{SSR}{SSTO} = 1 - \frac{SSE}{SSTO}$$</span>
<span id="cb62-472"><a href="#cb62-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-473"><a href="#cb62-473" aria-hidden="true" tabindex="-1"></a>It measures the proportionate reduction of total variation in $Y$ associated with the use of the set of X variables $X_1, \ldots , X_{p_1}$.</span>
<span id="cb62-474"><a href="#cb62-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-475"><a href="#cb62-475" aria-hidden="true" tabindex="-1"></a>Adding more $X$ variables to the regression model can only increase $R^2$ and never reduce it, because $SSE$ can never become larger with more $X$ variables and $SSTO$ is always the same for a given set of responses.</span>
<span id="cb62-476"><a href="#cb62-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-477"><a href="#cb62-477" aria-hidden="true" tabindex="-1"></a>Therefore, we often use the *adjusted coefficient of multiple determination* $R^2_{adj}$. It adjusts $R^2$ by dividing each sum of squares by its respective df.</span>
<span id="cb62-478"><a href="#cb62-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-479"><a href="#cb62-479" aria-hidden="true" tabindex="-1"></a>$$R^2_{adj} = 1 - \Big(\frac{SSE}{n - p}\Big) \Big/ \Big(\frac{SSTO}{n - 1}\Big) = 1 - \big(\frac{n - 1}{n - p}\big) \frac{SSE}{SSTO}$$</span>
<span id="cb62-480"><a href="#cb62-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-481"><a href="#cb62-481" aria-hidden="true" tabindex="-1"></a>This adjusted coefficient of multiple determination may actually become smaller when another $X$ variable is introduced into the model, because any decrease in $SSE$ may be more than offset by the loss of a degree of freedom in the denominator $n - p$.</span>
<span id="cb62-482"><a href="#cb62-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-483"><a href="#cb62-483" aria-hidden="true" tabindex="-1"></a>Notes</span>
<span id="cb62-484"><a href="#cb62-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-485"><a href="#cb62-485" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>It can be shown that the coefficient of multiple determination $R^2$can be viewed as a coefficient of simple determination between the responses $Y_i$ and the fitted values $\hat{Y}_i$.</span>
<span id="cb62-486"><a href="#cb62-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-487"><a href="#cb62-487" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A large value of $R^2$ does not necessarily imply that the fitted model is a useful one.</span>
<span id="cb62-488"><a href="#cb62-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-489"><a href="#cb62-489" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>For instance, observations may have been taken at only a few levels of the predictor variables. Despite a high $R^2$ in this case, the fitted model may not be useful if most predictions require extrapolations outside the region of observations.</span>
<span id="cb62-490"><a href="#cb62-490" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-491"><a href="#cb62-491" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Again, even though $R^2$ is large, $MSE$ may still be too large for inferences to be useful when high precision is required.</span>
<span id="cb62-492"><a href="#cb62-492" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-493"><a href="#cb62-493" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb62-494"><a href="#cb62-494" aria-hidden="true" tabindex="-1"></a><span class="fu">#### R functions</span></span>
<span id="cb62-495"><a href="#cb62-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-496"><a href="#cb62-496" aria-hidden="true" tabindex="-1"></a>Returning to the demo in @sec-main-mlr-demo.</span>
<span id="cb62-497"><a href="#cb62-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-500"><a href="#cb62-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-501"><a href="#cb62-501" aria-hidden="true" tabindex="-1"></a><span class="co"># view model statistics</span></span>
<span id="cb62-502"><a href="#cb62-502" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; looking at r.squared and adj.r.squared</span></span>
<span id="cb62-503"><a href="#cb62-503" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(mod_mlr)</span>
<span id="cb62-504"><a href="#cb62-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-505"><a href="#cb62-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-506"><a href="#cb62-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-507"><a href="#cb62-507" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Manual (matrices)</span></span>
<span id="cb62-508"><a href="#cb62-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-509"><a href="#cb62-509" aria-hidden="true" tabindex="-1"></a>Continuing with sum of squares calculated from a previous demo in @sec-anova-matrices.</span>
<span id="cb62-510"><a href="#cb62-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-513"><a href="#cb62-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-514"><a href="#cb62-514" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate coefficient of determination</span></span>
<span id="cb62-515"><a href="#cb62-515" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; R^2 = SSR / SSTO = 1 - SSE / SSTO</span></span>
<span id="cb62-516"><a href="#cb62-516" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> SSR <span class="sc">/</span> SSTO</span>
<span id="cb62-517"><a href="#cb62-517" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SSE <span class="sc">/</span> SSTO</span>
<span id="cb62-518"><a href="#cb62-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-519"><a href="#cb62-519" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="fu">as.numeric</span>(broom<span class="sc">::</span><span class="fu">glance</span>(mod_mlr)<span class="sc">$</span>r.squared), <span class="fu">as.numeric</span>(R2))</span>
<span id="cb62-520"><a href="#cb62-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-521"><a href="#cb62-521" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate adjusted coefficient of determination</span></span>
<span id="cb62-522"><a href="#cb62-522" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; R^2 = 1 - (n - 1) / (n - p) SSE / SSTO</span></span>
<span id="cb62-523"><a href="#cb62-523" aria-hidden="true" tabindex="-1"></a>R2_adj <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="fu">length</span>(Y) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (<span class="fu">length</span>(Y) <span class="sc">-</span> <span class="fu">length</span>(betas_hat)) <span class="sc">*</span> SSE <span class="sc">/</span> SSTO</span>
<span id="cb62-524"><a href="#cb62-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-525"><a href="#cb62-525" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="fu">as.numeric</span>(broom<span class="sc">::</span><span class="fu">glance</span>(mod_mlr)<span class="sc">$</span>adj.r.squared), <span class="fu">as.numeric</span>(R2_adj))</span>
<span id="cb62-526"><a href="#cb62-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-527"><a href="#cb62-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-528"><a href="#cb62-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-529"><a href="#cb62-529" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-530"><a href="#cb62-530" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-531"><a href="#cb62-531" aria-hidden="true" tabindex="-1"></a><span class="fu">### Coefficient of multiple correlation</span></span>
<span id="cb62-532"><a href="#cb62-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-533"><a href="#cb62-533" aria-hidden="true" tabindex="-1"></a>The coefficient of multiple correlation $R$ is the positive square root of $R^2$:</span>
<span id="cb62-534"><a href="#cb62-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-535"><a href="#cb62-535" aria-hidden="true" tabindex="-1"></a>$$R = \sqrt{R^2}$$</span>
<span id="cb62-536"><a href="#cb62-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-537"><a href="#cb62-537" aria-hidden="true" tabindex="-1"></a>When there is only one variable in the model, thec oefficient of multiple correlation $R$ equals in absolute value the correlation coefficient $r$ in SLR.</span>
<span id="cb62-538"><a href="#cb62-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-539"><a href="#cb62-539" aria-hidden="true" tabindex="-1"></a><span class="fu">### Inferences about regression parameters</span></span>
<span id="cb62-540"><a href="#cb62-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-541"><a href="#cb62-541" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mlr-beta-inferences.png)</span>{width="80%"}</span>
<span id="cb62-542"><a href="#cb62-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-543"><a href="#cb62-543" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mlr-beta-intervals-and-tests.png)</span>{width="80%"}</span>
<span id="cb62-544"><a href="#cb62-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-545"><a href="#cb62-545" aria-hidden="true" tabindex="-1"></a>Demo</span>
<span id="cb62-546"><a href="#cb62-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-547"><a href="#cb62-547" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb62-548"><a href="#cb62-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-549"><a href="#cb62-549" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individual test on $\beta_k$</span></span>
<span id="cb62-550"><a href="#cb62-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-551"><a href="#cb62-551" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Returning to the demo in @sec-main-mlr-demo.</span>
<span id="cb62-552"><a href="#cb62-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-555"><a href="#cb62-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-556"><a href="#cb62-556" aria-hidden="true" tabindex="-1"></a><span class="co"># view coefficient summaries</span></span>
<span id="cb62-557"><a href="#cb62-557" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; looking at std.error, statistic and p.value columns</span></span>
<span id="cb62-558"><a href="#cb62-558" aria-hidden="true" tabindex="-1"></a>(summ1 <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(mod_mlr))</span>
<span id="cb62-559"><a href="#cb62-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-560"><a href="#cb62-560" aria-hidden="true" tabindex="-1"></a><span class="co"># just going to recreate the p-value from given info</span></span>
<span id="cb62-561"><a href="#cb62-561" aria-hidden="true" tabindex="-1"></a>(summ2 <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">glance</span>(mod_mlr))</span>
<span id="cb62-562"><a href="#cb62-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-563"><a href="#cb62-563" aria-hidden="true" tabindex="-1"></a><span class="co"># verify t-stat = estimate / std.error</span></span>
<span id="cb62-564"><a href="#cb62-564" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="fu">as.numeric</span>(summ1[<span class="dv">2</span>,<span class="dv">4</span>]), <span class="fu">as.numeric</span>(summ1[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">/</span> summ1[<span class="dv">2</span>,<span class="dv">3</span>]))</span>
<span id="cb62-565"><a href="#cb62-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-566"><a href="#cb62-566" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate p-value from theoretical (beta_k-hat - beta_k)/ SE(\beta_k-hat) ~ t_(n-p) </span></span>
<span id="cb62-567"><a href="#cb62-567" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">pt</span>(<span class="at">q =</span> <span class="fu">as.numeric</span>(summ1[<span class="dv">2</span>,<span class="dv">4</span>]), <span class="at">df =</span> summ2<span class="sc">$</span>df.residual, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb62-568"><a href="#cb62-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-569"><a href="#cb62-569" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="fu">as.numeric</span>(summ1[<span class="dv">2</span>,<span class="dv">5</span>]), p_value)</span>
<span id="cb62-570"><a href="#cb62-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-571"><a href="#cb62-571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-572"><a href="#cb62-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-573"><a href="#cb62-573" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individual CI on $\beta_k$ -- R functions</span></span>
<span id="cb62-574"><a href="#cb62-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-577"><a href="#cb62-577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-578"><a href="#cb62-578" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate confidence interval for single coefficient</span></span>
<span id="cb62-579"><a href="#cb62-579" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; remember these are all individual inferences, not simultaneous confidence intervals</span></span>
<span id="cb62-580"><a href="#cb62-580" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_mlr)[<span class="dv">2</span>, ]</span>
<span id="cb62-581"><a href="#cb62-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-582"><a href="#cb62-582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-583"><a href="#cb62-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-584"><a href="#cb62-584" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individual CI on $\beta_k$ -- Manual</span></span>
<span id="cb62-585"><a href="#cb62-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-588"><a href="#cb62-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-589"><a href="#cb62-589" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate lower and upper bounds</span></span>
<span id="cb62-590"><a href="#cb62-590" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span> </span>
<span id="cb62-591"><a href="#cb62-591" aria-hidden="true" tabindex="-1"></a>bound_lower <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(summ1[<span class="dv">2</span>, <span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">qt</span>(alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> summ2<span class="sc">$</span>df.residual) <span class="sc">*</span> <span class="fu">as.numeric</span>(summ1[<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb62-592"><a href="#cb62-592" aria-hidden="true" tabindex="-1"></a>bound_upper <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(summ1[<span class="dv">2</span>, <span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> summ2<span class="sc">$</span>df.residual) <span class="sc">*</span> <span class="fu">as.numeric</span>(summ1[<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb62-593"><a href="#cb62-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-594"><a href="#cb62-594" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="fu">as.numeric</span>(<span class="fu">confint</span>(mod_mlr)[<span class="dv">2</span>, ]), <span class="fu">c</span>(bound_lower, bound_upper))</span>
<span id="cb62-595"><a href="#cb62-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-596"><a href="#cb62-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-597"><a href="#cb62-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-598"><a href="#cb62-598" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-599"><a href="#cb62-599" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-600"><a href="#cb62-600" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mlr-joint-beta-inferences.png)</span>{width="80%"}</span>
<span id="cb62-601"><a href="#cb62-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-602"><a href="#cb62-602" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Demo --&gt;</span></span>
<span id="cb62-603"><a href="#cb62-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-604"><a href="#cb62-604" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- come back to joint estimation of beta --&gt;</span></span>
<span id="cb62-605"><a href="#cb62-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-606"><a href="#cb62-606" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimation of mean response and prediction of new observation</span></span>
<span id="cb62-607"><a href="#cb62-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-608"><a href="#cb62-608" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mlr-interval-estimation-EY.png)</span>{width="80%"}</span>
<span id="cb62-609"><a href="#cb62-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-610"><a href="#cb62-610" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mlr-confidence-regression-surface.png)</span>{width="80%"}</span>
<span id="cb62-611"><a href="#cb62-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-612"><a href="#cb62-612" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mlr-simulataneous-cis-mean-responses.png)</span>{width="80%"}</span>
<span id="cb62-613"><a href="#cb62-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-614"><a href="#cb62-614" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mlr-prediction.png)</span>{width="80%"}</span>
<span id="cb62-615"><a href="#cb62-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-616"><a href="#cb62-616" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/mlr-hidden-extrapolation.png)</span>{width="80%"}</span>
<span id="cb62-617"><a href="#cb62-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-618"><a href="#cb62-618" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diagnostics and remedial measures</span></span>
<span id="cb62-619"><a href="#cb62-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-620"><a href="#cb62-620" aria-hidden="true" tabindex="-1"></a>Diagnostics play an impol1ant role in the development and evaluation of multiple regression models. Most of the diagnostic procedures and remedial meausures for simple linear regression that we described in @sec-diag-remedial-measures carry over directly to multiple regression.</span>
<span id="cb62-621"><a href="#cb62-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-622"><a href="#cb62-622" aria-hidden="true" tabindex="-1"></a>Scatterplot matrix</span>
<span id="cb62-623"><a href="#cb62-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-624"><a href="#cb62-624" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Box plots, sequence plots, and dot plots for each of the predictor variables and for the response variable can provide helpful, preliminary univariate information about these variables.</span>
<span id="cb62-625"><a href="#cb62-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-626"><a href="#cb62-626" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Scatter plots of the $Y$ against each $X$ can aid in determining the nature and strength of the bivariate relationships and in identifying gaps in the data points as well as outlying data points. Scatter plots of $X$ against each of the other $X$s provide similar information.</span>
<span id="cb62-627"><a href="#cb62-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-628"><a href="#cb62-628" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A complement to the scatter plot matrix that may be useful at times is the correlation matrix (matrix format as $<span class="co">[</span><span class="ot">Y, X</span><span class="co">]</span>$). Note this is a symmetric matrix with 1 on the main diagonal, so often can just print the upper or lower traingle matrix.</span>
<span id="cb62-629"><a href="#cb62-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-630"><a href="#cb62-630" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/correlation-matrix.png)</span>{width="50%"}</span>
<span id="cb62-631"><a href="#cb62-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-632"><a href="#cb62-632" aria-hidden="true" tabindex="-1"></a>Demo</span>
<span id="cb62-633"><a href="#cb62-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-634"><a href="#cb62-634" aria-hidden="true" tabindex="-1"></a>Returning to the demo in @sec-main-mlr-demo.</span>
<span id="cb62-635"><a href="#cb62-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-638"><a href="#cb62-638" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-639"><a href="#cb62-639" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot matrix (of just the Xs, not the transformed variables as well)</span></span>
<span id="cb62-640"><a href="#cb62-640" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(data_sample)</span>
<span id="cb62-641"><a href="#cb62-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-642"><a href="#cb62-642" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation matrix</span></span>
<span id="cb62-643"><a href="#cb62-643" aria-hidden="true" tabindex="-1"></a>(r <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_sample) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>))</span>
<span id="cb62-644"><a href="#cb62-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-645"><a href="#cb62-645" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation plot</span></span>
<span id="cb62-646"><a href="#cb62-646" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(r)</span>
<span id="cb62-647"><a href="#cb62-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-648"><a href="#cb62-648" aria-hidden="true" tabindex="-1"></a><span class="co"># upper triangle correlation matrix</span></span>
<span id="cb62-649"><a href="#cb62-649" aria-hidden="true" tabindex="-1"></a>r[<span class="fu">lower.tri</span>(r)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb62-650"><a href="#cb62-650" aria-hidden="true" tabindex="-1"></a>r</span>
<span id="cb62-651"><a href="#cb62-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-652"><a href="#cb62-652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-653"><a href="#cb62-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-654"><a href="#cb62-654" aria-hidden="true" tabindex="-1"></a>Residual plots</span>
<span id="cb62-655"><a href="#cb62-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-656"><a href="#cb62-656" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Same as for SLR, a plot of the residuals against the fitted values is useful for assessing the appropriateness of the multiple regression function and the constancy of the variance of the error terms, as well as for providing information about outliers.</span>
<span id="cb62-657"><a href="#cb62-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-658"><a href="#cb62-658" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Box plots and normal probability plots of the residuals are useful for examining whether the error terms are reasonably normally distributed.</span>
<span id="cb62-659"><a href="#cb62-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-660"><a href="#cb62-660" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In addition, residuals should be plotted against each of the predictor variables. Each of these plots can provide further information about the adequacy of the regression function with respect to that predictor variable (e.g., whether a curvature effect is required for that variable) and about possible variation in the magnitude of the error variance in relation to that predictor variable.</span>
<span id="cb62-661"><a href="#cb62-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-662"><a href="#cb62-662" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Residuals should also be plotted against important predictor variables that were omitted from the model, to see if the omitted variables have substantial additional effects on the response variable that have not yet been recognized in the regression model.</span>
<span id="cb62-663"><a href="#cb62-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-664"><a href="#cb62-664" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Also, residuals should be plotted against interaction terms for potential interaction effects not included in the regression model, such as against $X_1 X_2$, $X_1 X_3$, and $X_2 X_3$, to see whether some or all of these interaction terms are required in the model.</span>
<span id="cb62-665"><a href="#cb62-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-666"><a href="#cb62-666" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A plot of the absolute residuals or the squared residuals against the fitted values is useful for examining the constancy of the variance of the error terms.</span>
<span id="cb62-667"><a href="#cb62-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-668"><a href="#cb62-668" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>If nonconstancy is detected, a plot of the absolute residuals or the squared residuals against each of the predictor vaIiables may identify one or several of the predictor variables to which the magnitude of the error variability is related.</span>
<span id="cb62-669"><a href="#cb62-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-670"><a href="#cb62-670" aria-hidden="true" tabindex="-1"></a>Demo</span>
<span id="cb62-671"><a href="#cb62-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-674"><a href="#cb62-674" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-675"><a href="#cb62-675" aria-hidden="true" tabindex="-1"></a><span class="co"># residual plots</span></span>
<span id="cb62-676"><a href="#cb62-676" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_mlr)</span>
<span id="cb62-677"><a href="#cb62-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-678"><a href="#cb62-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-679"><a href="#cb62-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-680"><a href="#cb62-680" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- All the tests for MLR about error terms and lack of fit --&gt;</span></span>
<span id="cb62-681"><a href="#cb62-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-682"><a href="#cb62-682" aria-hidden="true" tabindex="-1"></a>Remedial measures</span>
<span id="cb62-683"><a href="#cb62-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-684"><a href="#cb62-684" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The remedial measures described previously are also applicable to multiple regression.</span>
<span id="cb62-685"><a href="#cb62-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-686"><a href="#cb62-686" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When a more complex model is required to recognize curvature or interaction effects, the multiple regression model can be expanded to include these effects.</span>
<span id="cb62-687"><a href="#cb62-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-688"><a href="#cb62-688" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>For example, $X_2^2$ might be added as a variable to take into account a curvature effect of $X_2$, or $X_1 X_3$ might be added as a variable to recognize an interaction effect between $X_1$ and $X_3$ on the response variable.</span>
<span id="cb62-689"><a href="#cb62-689" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-690"><a href="#cb62-690" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Alternatively, transformations on the response and/or the predictor variables can be made as discussed before.</span>
<span id="cb62-691"><a href="#cb62-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-692"><a href="#cb62-692" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Transformations on the response variable may be helpful when the distributions of the error terms are quite skewed and the variance of the error terms is not constant.</span>
<span id="cb62-693"><a href="#cb62-693" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-694"><a href="#cb62-694" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Transformations of some of the predictor variables may be helpful when the effects of these variables are curvilinear.</span>
<span id="cb62-695"><a href="#cb62-695" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-696"><a href="#cb62-696" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>In addition, transformations on $Y$ and or the predictor variables may be helpful in eliminating or substantially reducing interaction effects.</span>
<span id="cb62-697"><a href="#cb62-697" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-698"><a href="#cb62-698" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>As with simple linear regression, the usefulness of potential transformations needs to be examined by means of residual plots and other diagnostic tools to determine whether the multiple regression model for the transformed data is appropriate.</span>
<span id="cb62-699"><a href="#cb62-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-700"><a href="#cb62-700" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Can still do the Box Cox transformation (@sec-box-cox) like usual.</span>
<span id="cb62-701"><a href="#cb62-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-702"><a href="#cb62-702" aria-hidden="true" tabindex="-1"></a>Demo</span>
<span id="cb62-703"><a href="#cb62-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-706"><a href="#cb62-706" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-707"><a href="#cb62-707" aria-hidden="true" tabindex="-1"></a><span class="co"># run boxcox procedure</span></span>
<span id="cb62-708"><a href="#cb62-708" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; plot MLE of lambda</span></span>
<span id="cb62-709"><a href="#cb62-709" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">boxcox</span>(mod_mlr)</span>
<span id="cb62-710"><a href="#cb62-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-711"><a href="#cb62-711" aria-hidden="true" tabindex="-1"></a><span class="co"># add constant to response variable so can run box-cox</span></span>
<span id="cb62-712"><a href="#cb62-712" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; from simulation for 'effects of constants and scalars', adding constant to Y only changes the intercept -&gt; still valid model</span></span>
<span id="cb62-713"><a href="#cb62-713" aria-hidden="true" tabindex="-1"></a>mod_mlr_prime <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">+</span><span class="dv">50</span> <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X4 <span class="sc">+</span> <span class="fu">I</span>(X1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(X1<span class="sc">*</span>X2), <span class="at">data =</span> data_sample)</span>
<span id="cb62-714"><a href="#cb62-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-715"><a href="#cb62-715" aria-hidden="true" tabindex="-1"></a><span class="co"># try again</span></span>
<span id="cb62-716"><a href="#cb62-716" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">boxcox</span>(mod_mlr_prime)</span>
<span id="cb62-717"><a href="#cb62-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-718"><a href="#cb62-718" aria-hidden="true" tabindex="-1"></a><span class="co"># lambda = 1 -&gt; no transformation is needed, as expected</span></span>
<span id="cb62-719"><a href="#cb62-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-720"><a href="#cb62-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-721"><a href="#cb62-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-722"><a href="#cb62-722" aria-hidden="true" tabindex="-1"></a><span class="fu">### Residual plots demo for various misfitting models</span></span>
<span id="cb62-723"><a href="#cb62-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-724"><a href="#cb62-724" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb62-725"><a href="#cb62-725" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Missing important predictor</span></span>
<span id="cb62-726"><a href="#cb62-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-727"><a href="#cb62-727" aria-hidden="true" tabindex="-1"></a>Create residual plots against each $X$ in data.</span>
<span id="cb62-728"><a href="#cb62-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-731"><a href="#cb62-731" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-732"><a href="#cb62-732" aria-hidden="true" tabindex="-1"></a><span class="co"># get residuals</span></span>
<span id="cb62-733"><a href="#cb62-733" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">residuals</span>(mod_mlr)</span>
<span id="cb62-734"><a href="#cb62-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-735"><a href="#cb62-735" aria-hidden="true" tabindex="-1"></a><span class="co"># plot against each X</span></span>
<span id="cb62-736"><a href="#cb62-736" aria-hidden="true" tabindex="-1"></a>nms_x <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data_sample[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb62-737"><a href="#cb62-737" aria-hidden="true" tabindex="-1"></a><span class="fu">map2</span>(data_sample[,<span class="sc">-</span><span class="dv">1</span>], nms_x, <span class="cf">function</span>(x, nm) {</span>
<span id="cb62-738"><a href="#cb62-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">y =</span> e, <span class="at">main =</span> nm)</span>
<span id="cb62-739"><a href="#cb62-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(<span class="at">x =</span> x, <span class="at">y =</span> e), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb62-740"><a href="#cb62-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb62-741"><a href="#cb62-741" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb62-742"><a href="#cb62-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-743"><a href="#cb62-743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-744"><a href="#cb62-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-745"><a href="#cb62-745" aria-hidden="true" tabindex="-1"></a>Note that there is no pattern for important predictors included in the model or for the unnecessary predictor. BUT for the important predictor $X_3$ omitted from the model, there is clear systematic deviation!</span>
<span id="cb62-746"><a href="#cb62-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-747"><a href="#cb62-747" aria-hidden="true" tabindex="-1"></a>This indicates that it should be in the model.</span>
<span id="cb62-748"><a href="#cb62-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-749"><a href="#cb62-749" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Missing polynomial predictor</span></span>
<span id="cb62-750"><a href="#cb62-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-751"><a href="#cb62-751" aria-hidden="true" tabindex="-1"></a>Create residual plots.</span>
<span id="cb62-752"><a href="#cb62-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-755"><a href="#cb62-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-756"><a href="#cb62-756" aria-hidden="true" tabindex="-1"></a><span class="co"># fit new model without polyomial predictor</span></span>
<span id="cb62-757"><a href="#cb62-757" aria-hidden="true" tabindex="-1"></a>mod_no_poly <span class="ot">&lt;-</span> <span class="fu">update</span>(mod_mlr, . <span class="sc">~</span> . <span class="sc">-</span> <span class="fu">I</span>(X1<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb62-758"><a href="#cb62-758" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(mod_no_poly)</span>
<span id="cb62-759"><a href="#cb62-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-760"><a href="#cb62-760" aria-hidden="true" tabindex="-1"></a><span class="co"># see residuals vs fitted</span></span>
<span id="cb62-761"><a href="#cb62-761" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_no_poly)</span>
<span id="cb62-762"><a href="#cb62-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-763"><a href="#cb62-763" aria-hidden="true" tabindex="-1"></a><span class="co"># get residuals</span></span>
<span id="cb62-764"><a href="#cb62-764" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">residuals</span>(mod_no_poly)</span>
<span id="cb62-765"><a href="#cb62-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-766"><a href="#cb62-766" aria-hidden="true" tabindex="-1"></a><span class="co"># plot against each X</span></span>
<span id="cb62-767"><a href="#cb62-767" aria-hidden="true" tabindex="-1"></a>nms_x <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data_sample[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb62-768"><a href="#cb62-768" aria-hidden="true" tabindex="-1"></a><span class="fu">map2</span>(data_sample[,<span class="sc">-</span><span class="dv">1</span>], nms_x, <span class="cf">function</span>(x, nm) {</span>
<span id="cb62-769"><a href="#cb62-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">y =</span> e, <span class="at">main =</span> nm)</span>
<span id="cb62-770"><a href="#cb62-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(<span class="at">x =</span> x, <span class="at">y =</span> e), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb62-771"><a href="#cb62-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb62-772"><a href="#cb62-772" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb62-773"><a href="#cb62-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-774"><a href="#cb62-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-775"><a href="#cb62-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-776"><a href="#cb62-776" aria-hidden="true" tabindex="-1"></a>Note that there is curvature in the residuals vs fitted. Then when viewing vs each predictor, it is clear that it comes from $X_1$!</span>
<span id="cb62-777"><a href="#cb62-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-778"><a href="#cb62-778" aria-hidden="true" tabindex="-1"></a>This indicates that a polynomial term for $X_1$ should be in the model.</span>
<span id="cb62-779"><a href="#cb62-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-780"><a href="#cb62-780" aria-hidden="true" tabindex="-1"></a>Also note that missing the polynomial term hides the effect of missing $X_3$ $\Longrightarrow$ Need to model the terms in there correctly first before looking at more variables.</span>
<span id="cb62-781"><a href="#cb62-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-782"><a href="#cb62-782" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Missing interaction predictor</span></span>
<span id="cb62-783"><a href="#cb62-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-784"><a href="#cb62-784" aria-hidden="true" tabindex="-1"></a>Create residual plots.</span>
<span id="cb62-785"><a href="#cb62-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-788"><a href="#cb62-788" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-789"><a href="#cb62-789" aria-hidden="true" tabindex="-1"></a><span class="co"># fit new model without polyomial predictor</span></span>
<span id="cb62-790"><a href="#cb62-790" aria-hidden="true" tabindex="-1"></a>mod_no_interaction <span class="ot">&lt;-</span> <span class="fu">update</span>(mod_mlr, . <span class="sc">~</span> . <span class="sc">-</span> <span class="fu">I</span>(X1<span class="sc">*</span>X2))</span>
<span id="cb62-791"><a href="#cb62-791" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(mod_no_interaction)</span>
<span id="cb62-792"><a href="#cb62-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-793"><a href="#cb62-793" aria-hidden="true" tabindex="-1"></a><span class="co"># see residuals vs fitted</span></span>
<span id="cb62-794"><a href="#cb62-794" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_no_interaction)</span>
<span id="cb62-795"><a href="#cb62-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-796"><a href="#cb62-796" aria-hidden="true" tabindex="-1"></a><span class="co"># get residuals</span></span>
<span id="cb62-797"><a href="#cb62-797" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">residuals</span>(mod_no_interaction)</span>
<span id="cb62-798"><a href="#cb62-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-799"><a href="#cb62-799" aria-hidden="true" tabindex="-1"></a><span class="co"># plot against each X</span></span>
<span id="cb62-800"><a href="#cb62-800" aria-hidden="true" tabindex="-1"></a>nms_x <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data_sample[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb62-801"><a href="#cb62-801" aria-hidden="true" tabindex="-1"></a><span class="fu">map2</span>(data_sample[,<span class="sc">-</span><span class="dv">1</span>], nms_x, <span class="cf">function</span>(x, nm) {</span>
<span id="cb62-802"><a href="#cb62-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">y =</span> e, <span class="at">main =</span> nm)</span>
<span id="cb62-803"><a href="#cb62-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(<span class="at">x =</span> x, <span class="at">y =</span> e), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb62-804"><a href="#cb62-804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb62-805"><a href="#cb62-805" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb62-806"><a href="#cb62-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-807"><a href="#cb62-807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-808"><a href="#cb62-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-809"><a href="#cb62-809" aria-hidden="true" tabindex="-1"></a>Note that there is maybe a slight pattern with respect to $X_1$ and $X_2$, but definitely harder to detect.</span>
<span id="cb62-810"><a href="#cb62-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-811"><a href="#cb62-811" aria-hidden="true" tabindex="-1"></a>hardt o tell if should include an interaction or not, obviosuly it should be based on the known true model.</span>
<span id="cb62-812"><a href="#cb62-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-813"><a href="#cb62-813" aria-hidden="true" tabindex="-1"></a>Also note that again this hides the effect of missing $X_3$, just like the previous one.</span>
<span id="cb62-814"><a href="#cb62-814" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>